import{a as $,b as Te,c as zh,d as R,e as y_,f as Yu,g as v_,h as w_,i as __,j as Gh,k as I_,l as zs,m as Wh,n as Zu,o as E_,p as D_,q as Kh,r as Ne,s as Zr,t as hn,u as Ju,v as Gs,w as C_,x as T_,y as ur,z as Pt}from"./chunk-4ZHOUZTK.js";var Yh=null;var Qh=1,b_=Symbol("SIGNAL");function Ee(n){let e=Yh;return Yh=n,e}function S_(){return Yh}var Zh={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function nx(n){if(!(nf(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Qh)){if(!n.producerMustRecompute(n)&&!Xh(n)){n.dirty=!1,n.lastCleanEpoch=Qh;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Qh}}function Jh(n){return n&&(n.nextProducerIndex=0),Ee(n)}function A_(n,e){if(Ee(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(nf(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)tf(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Xh(n){rf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(nx(t),r!==t.version))return!0}return!1}function ef(n){if(rf(n),nf(n))for(let e=0;e<n.producerNode.length;e++)tf(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function tf(n,e){if(rx(n),n.liveConsumerNode.length===1&&ix(n))for(let r=0;r<n.producerNode.length;r++)tf(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];rf(i),i.producerIndexOfThis[r]=e}}function nf(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function rf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function rx(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function ix(n){return n.producerNode!==void 0}function ox(){throw new Error}var sx=ox;function x_(n){sx=n}function te(n){return typeof n=="function"}function Ki(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Xu=Ki(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Jr(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Le=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(te(r))try{r()}catch(o){e=o instanceof Xu?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{R_(o)}catch(s){e=e??[],s instanceof Xu?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Xu(e)}}add(e){var t;if(e&&e!==this)if(this.closed)R_(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Jr(t,e)}remove(e){let{_finalizers:t}=this;t&&Jr(t,e),e instanceof n&&e._removeParent(this)}};Le.EMPTY=(()=>{let n=new Le;return n.closed=!0,n})();var of=Le.EMPTY;function ec(n){return n instanceof Le||n&&"closed"in n&&te(n.remove)&&te(n.add)&&te(n.unsubscribe)}function R_(n){te(n)?n():n.unsubscribe()}var Xt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Qi={setTimeout(n,e,...t){let{delegate:r}=Qi;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Qi;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function tc(n){Qi.setTimeout(()=>{let{onUnhandledError:e}=Xt;if(e)e(n);else throw n})}function Ws(){}var M_=sf("C",void 0,void 0);function N_(n){return sf("E",void 0,n)}function P_(n){return sf("N",n,void 0)}function sf(n,e,t){return{kind:n,value:e,error:t}}var Xr=null;function Yi(n){if(Xt.useDeprecatedSynchronousErrorHandling){let e=!Xr;if(e&&(Xr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Xr;if(Xr=null,t)throw r}}else n()}function k_(n){Xt.useDeprecatedSynchronousErrorHandling&&Xr&&(Xr.errorThrown=!0,Xr.error=n)}var ei=class extends Le{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ec(e)&&e.add(this)):this.destination=cx}static create(e,t,r){return new On(e,t,r)}next(e){this.isStopped?uf(P_(e),this):this._next(e)}error(e){this.isStopped?uf(N_(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?uf(M_,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},ax=Function.prototype.bind;function af(n,e){return ax.call(n,e)}var cf=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){nc(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){nc(r)}else nc(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){nc(t)}}},On=class extends ei{constructor(e,t,r){super();let i;if(te(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Xt.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&af(e.next,o),error:e.error&&af(e.error,o),complete:e.complete&&af(e.complete,o)}):i=e}this.destination=new cf(i)}};function nc(n){Xt.useDeprecatedSynchronousErrorHandling?k_(n):tc(n)}function ux(n){throw n}function uf(n,e){let{onStoppedNotification:t}=Xt;t&&Qi.setTimeout(()=>t(n,e))}var cx={closed:!0,next:Ws,error:ux,complete:Ws};var Zi=typeof Symbol=="function"&&Symbol.observable||"@@observable";function yt(n){return n}function lf(...n){return df(n)}function df(n){return n.length===0?yt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var le=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=dx(t)?t:new On(t,r,i);return Yi(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=O_(r),new r((i,o)=>{let s=new On({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Zi](){return this}pipe(...t){return df(t)(this)}toPromise(t){return t=O_(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function O_(n){var e;return(e=n??Xt.Promise)!==null&&e!==void 0?e:Promise}function lx(n){return n&&te(n.next)&&te(n.error)&&te(n.complete)}function dx(n){return n&&n instanceof ei||lx(n)&&ec(n)}function hf(n){return te(n?.lift)}function se(n){return e=>{if(hf(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ue(n,e,t,r,i){return new ff(n,e,t,r,i)}var ff=class extends ei{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ji(){return se((n,e)=>{let t=null;n._refCount++;let r=ue(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Xi=class extends le{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,hf(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Le;let t=this.getSubject();e.add(this.source.subscribe(ue(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Le.EMPTY)}return e}refCount(){return Ji()(this)}};var F_=Ki(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Be=(()=>{class n extends le{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new rc(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new F_}next(t){Yi(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Yi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Yi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?of:(this.currentObservers=null,o.push(t),new Le(()=>{this.currentObservers=null,Jr(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new le;return t.source=this,t}}return n.create=(e,t)=>new rc(e,t),n})(),rc=class extends Be{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:of}};var it=class extends Be{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Ks={now(){return(Ks.delegate||Date).now()},delegate:void 0};var ic=class extends Be{constructor(e=1/0,t=1/0,r=Ks){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}}};var oc=class extends Le{constructor(e,t){super()}schedule(e,t=0){return this}};var Qs={setInterval(n,e,...t){let{delegate:r}=Qs;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Qs;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var eo=class extends oc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Qs.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Qs.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Jr(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var to=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};to.now=Ks.now;var no=class extends to{constructor(e,t=to.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var Ys=new no(eo);var sc=class extends eo{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var ac=class extends no{};var pf=new ac(sc);var vt=new le(n=>n.complete());function L_(n){return n&&te(n.schedule)}function gf(n){return n[n.length-1]}function V_(n){return te(gf(n))?n.pop():void 0}function fn(n){return L_(gf(n))?n.pop():void 0}function j_(n,e){return typeof gf(n)=="number"?n.pop():e}var uc=n=>n&&typeof n.length=="number"&&typeof n!="function";function cc(n){return te(n?.then)}function lc(n){return te(n[Zi])}function dc(n){return Symbol.asyncIterator&&te(n?.[Symbol.asyncIterator])}function hc(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function hx(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var fc=hx();function pc(n){return te(n?.[fc])}function gc(n){return v_(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Yu(t.read());if(i)return yield Yu(void 0);yield yield Yu(r)}}finally{t.releaseLock()}})}function mc(n){return te(n?.getReader)}function Pe(n){if(n instanceof le)return n;if(n!=null){if(lc(n))return fx(n);if(uc(n))return px(n);if(cc(n))return gx(n);if(dc(n))return B_(n);if(pc(n))return mx(n);if(mc(n))return yx(n)}throw hc(n)}function fx(n){return new le(e=>{let t=n[Zi]();if(te(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function px(n){return new le(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function gx(n){return new le(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,tc)})}function mx(n){return new le(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function B_(n){return new le(e=>{vx(n,e).catch(t=>e.error(t))})}function yx(n){return B_(gc(n))}function vx(n,e){var t,r,i,o;return y_(this,void 0,void 0,function*(){try{for(t=w_(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function St(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function Bt(n,e=0){return se((t,r)=>{t.subscribe(ue(r,i=>St(r,n,()=>r.next(i),e),()=>St(r,n,()=>r.complete(),e),i=>St(r,n,()=>r.error(i),e)))})}function en(n,e=0){return se((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function U_(n,e){return Pe(n).pipe(en(e),Bt(e))}function $_(n,e){return Pe(n).pipe(en(e),Bt(e))}function H_(n,e){return new le(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function q_(n,e){return new le(t=>{let r;return St(t,e,()=>{r=n[fc](),St(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>te(r?.return)&&r.return()})}function yc(n,e){if(!n)throw new Error("Iterable cannot be null");return new le(t=>{St(t,e,()=>{let r=n[Symbol.asyncIterator]();St(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function z_(n,e){return yc(gc(n),e)}function G_(n,e){if(n!=null){if(lc(n))return U_(n,e);if(uc(n))return H_(n,e);if(cc(n))return $_(n,e);if(dc(n))return yc(n,e);if(pc(n))return q_(n,e);if(mc(n))return z_(n,e)}throw hc(n)}function ye(n,e){return e?G_(n,e):Pe(n)}function Z(...n){let e=fn(n);return ye(n,e)}function ro(n,e){let t=te(n)?n:()=>n,r=i=>i.error(t());return new le(e?i=>e.schedule(r,0,i):r)}function mf(n){return!!n&&(n instanceof le||te(n.lift)&&te(n.subscribe))}var Fn=Ki(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function J(n,e){return se((t,r)=>{let i=0;t.subscribe(ue(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:wx}=Array;function _x(n,e){return wx(e)?n(...e):n(e)}function W_(n){return J(e=>_x(n,e))}var{isArray:Ix}=Array,{getPrototypeOf:Ex,prototype:Dx,keys:Cx}=Object;function K_(n){if(n.length===1){let e=n[0];if(Ix(e))return{args:e,keys:null};if(Tx(e)){let t=Cx(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function Tx(n){return n&&typeof n=="object"&&Ex(n)===Dx}function Q_(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Zs(...n){let e=fn(n),t=V_(n),{args:r,keys:i}=K_(n);if(r.length===0)return ye([],e);let o=new le(bx(r,e,i?s=>Q_(i,s):yt));return t?o.pipe(W_(t)):o}function bx(n,e,t=yt){return r=>{Y_(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)Y_(e,()=>{let l=ye(n[c],e),h=!1;l.subscribe(ue(r,p=>{o[c]=p,h||(h=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function Y_(n,e,t){n?St(t,n,e):e()}function Z_(n,e,t,r,i,o,s,a){let c=[],l=0,h=0,p=!1,m=()=>{p&&!c.length&&!l&&e.complete()},v=M=>l<r?b(M):c.push(M),b=M=>{o&&e.next(M),l++;let N=!1;Pe(t(M,h++)).subscribe(ue(e,j=>{i?.(j),o?v(j):e.next(j)},()=>{N=!0},void 0,()=>{if(N)try{for(l--;c.length&&l<r;){let j=c.shift();s?St(e,s,()=>b(j)):b(j)}m()}catch(j){e.error(j)}}))};return n.subscribe(ue(e,v,()=>{p=!0,m()})),()=>{a?.()}}function ze(n,e,t=1/0){return te(e)?ze((r,i)=>J((o,s)=>e(r,o,i,s))(Pe(n(r,i))),t):(typeof e=="number"&&(t=e),se((r,i)=>Z_(r,i,n,t)))}function cr(n=1/0){return ze(yt,n)}function J_(){return cr(1)}function io(...n){return J_()(ye(n,fn(n)))}function vc(n){return new le(e=>{Pe(n()).subscribe(e)})}function yf(...n){let e=fn(n),t=j_(n,1/0),r=n;return r.length?r.length===1?Pe(r[0]):cr(t)(ye(r,e)):vt}function ot(n,e){return se((t,r)=>{let i=0;t.subscribe(ue(r,o=>n.call(e,o,i++)&&r.next(o)))})}function lr(n){return se((e,t)=>{let r=null,i=!1,o;r=e.subscribe(ue(t,void 0,void 0,s=>{o=Pe(n(s,lr(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function X_(n,e,t,r,i){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(ue(s,h=>{let p=l++;c=a?n(c,h,p):(a=!0,h),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function ti(n,e){return te(e)?ze(n,e,1):ze(n,1)}function dr(n){return se((e,t)=>{let r=!1;e.subscribe(ue(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Ln(n){return n<=0?()=>vt:se((e,t)=>{let r=0;e.subscribe(ue(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function vf(n){return J(()=>n)}function wf(n,e=yt){return n=n??Sx,se((t,r)=>{let i,o=!0;t.subscribe(ue(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function Sx(n,e){return n===e}function wc(n=Ax){return se((e,t)=>{let r=!1;e.subscribe(ue(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function Ax(){return new Fn}function Js(n){return se((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Ut(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ot((i,o)=>n(i,o,r)):yt,Ln(1),t?dr(e):wc(()=>new Fn))}function oo(n){return n<=0?()=>vt:se((e,t)=>{let r=[];e.subscribe(ue(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function _f(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ot((i,o)=>n(i,o,r)):yt,oo(1),t?dr(e):wc(()=>new Fn))}function Xs(){return se((n,e)=>{let t,r=!1;n.subscribe(ue(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function ni(n,e){return se(X_(n,e,arguments.length>=2,!0))}function eI(n={}){let{connector:e=()=>new Be,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,c,l=0,h=!1,p=!1,m=()=>{a?.unsubscribe(),a=void 0},v=()=>{m(),s=c=void 0,h=p=!1},b=()=>{let M=s;v(),M?.unsubscribe()};return se((M,N)=>{l++,!p&&!h&&m();let j=c=c??e();N.add(()=>{l--,l===0&&!p&&!h&&(a=If(b,i))}),j.subscribe(N),!s&&l>0&&(s=new On({next:H=>j.next(H),error:H=>{p=!0,m(),a=If(v,t,H),j.error(H)},complete:()=>{h=!0,m(),a=If(v,r),j.complete()}}),Pe(M).subscribe(s))})(o)}}function If(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new On({next:()=>{r.unsubscribe(),n()}});return Pe(e(...t)).subscribe(r)}function _c(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,eI({connector:()=>new ic(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function ri(...n){let e=fn(n);return se((t,r)=>{(e?io(n,t,e):io(n,t)).subscribe(r)})}function Ve(n,e){return se((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(ue(r,c=>{i?.unsubscribe();let l=0,h=o++;Pe(n(c,h)).subscribe(i=ue(r,p=>r.next(e?e(c,p,h,l++):p),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function Ic(n,e){return te(e)?Ve(()=>n,e):Ve(()=>n)}function Ef(n){return se((e,t)=>{Pe(n).subscribe(ue(t,()=>t.complete(),Ws)),!t.closed&&e.subscribe(t)})}function Ye(n,e,t){let r=te(n)||e||t?{next:n,error:e,complete:t}:n;return r?se((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(ue(o,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),o.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):yt}var FI="https://g.co/ng/security#xss",X=class extends Error{constructor(e,t){super(lp(e,t)),this.code=e}};function lp(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function da(n){return{toString:n}.toString()}var Ec="__parameters__";function xx(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function LI(n,e,t){return da(()=>{let r=xx(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,l,h){let p=c.hasOwnProperty(Ec)?c[Ec]:Object.defineProperty(c,Ec,{value:[]})[Ec];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Bn=globalThis;function De(n){for(let e in n)if(n[e]===De)return e;throw Error("Could not find renamed property on target object.")}function kt(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(kt).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function tI(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var Rx=De({__forward_ref__:De});function VI(n){return n.__forward_ref__=VI,n.toString=function(){return kt(this())},n}function Ht(n){return jI(n)?n():n}function jI(n){return typeof n=="function"&&n.hasOwnProperty(Rx)&&n.__forward_ref__===VI}function W(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Et(n){return{providers:n.providers||[],imports:n.imports||[]}}function Jc(n){return nI(n,UI)||nI(n,$I)}function BI(n){return Jc(n)!==null}function nI(n,e){return n.hasOwnProperty(e)?n[e]:null}function Mx(n){let e=n&&(n[UI]||n[$I]);return e||null}function rI(n){return n&&(n.hasOwnProperty(iI)||n.hasOwnProperty(Nx))?n[iI]:null}var UI=De({\u0275prov:De}),iI=De({\u0275inj:De}),$I=De({ngInjectableDef:De}),Nx=De({ngInjectorDef:De}),z=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=W({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function HI(n){return n&&!!n.\u0275providers}var Px=De({\u0275cmp:De}),kx=De({\u0275dir:De}),Ox=De({\u0275pipe:De}),Fx=De({\u0275mod:De}),xc=De({\u0275fac:De}),ta=De({__NG_ELEMENT_ID__:De}),oI=De({__NG_ENV_ID__:De});function dp(n){return typeof n=="string"?n:n==null?"":String(n)}function Lx(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():dp(n)}function Vx(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new X(-200,n)}function hp(n,e){throw new X(-201,!1)}var ae=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ae||{}),Mf;function qI(){return Mf}function $t(n){let e=Mf;return Mf=n,e}function zI(n,e,t){let r=Jc(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ae.Optional)return null;if(e!==void 0)return e;hp(n,"Injector")}var jx={},ra=jx,Nf="__NG_DI_FLAG__",Rc="ngTempTokenPath",Bx="ngTokenPath",Ux=/\n/gm,$x="\u0275",sI="__source",lo;function Hx(){return lo}function hr(n){let e=lo;return lo=n,e}function qx(n,e=ae.Default){if(lo===void 0)throw new X(-203,!1);return lo===null?zI(n,void 0,e):lo.get(n,e&ae.Optional?null:void 0,e)}function O(n,e=ae.Default){return(qI()||qx)(Ht(n),e)}function V(n,e=ae.Default){return O(n,Xc(e))}function Xc(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Pf(n){let e=[];for(let t=0;t<n.length;t++){let r=Ht(n[t]);if(Array.isArray(r)){if(r.length===0)throw new X(900,!1);let i,o=ae.Default;for(let s=0;s<r.length;s++){let a=r[s],c=zx(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(O(i,o))}else e.push(O(r))}return e}function GI(n,e){return n[Nf]=e,n.prototype[Nf]=e,n}function zx(n){return n[Nf]}function Gx(n,e,t,r){let i=n[Rc];throw e[sI]&&i.unshift(e[sI]),n.message=Wx(`
`+n.message,i,t,r),n[Bx]=i,n[Rc]=null,n}function Wx(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==$x?n.slice(2):n;let i=kt(e);if(Array.isArray(e))i=e.map(kt).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):kt(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(Ux,`
  `)}`}var ha=GI(LI("Optional"),8);var WI=GI(LI("SkipSelf"),4);function fo(n,e){let t=n.hasOwnProperty(xc);return t?n[xc]:null}function fp(n,e){n.forEach(t=>Array.isArray(t)?fp(t,e):e(t))}function KI(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Mc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var ia={},pn=[],po=new z(""),QI=new z("",-1),YI=new z(""),Nc=class{get(e,t=ra){if(t===ra){let r=new Error(`NullInjectorError: No provider for ${kt(e)}!`);throw r.name="NullInjectorError",r}return t}},ZI=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(ZI||{}),mn=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(mn||{}),gr=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(gr||{});function Kx(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}function kf(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];Yx(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function Qx(n){return n===3||n===4||n===6}function Yx(n){return n.charCodeAt(0)===64}function pp(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?aI(n,t,i,null,e[++r]):aI(n,t,i,null,null))}}return n}function aI(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var JI="ng-template";function Zx(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&Kx(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(gp(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function gp(n){return n.type===4&&n.value!==JI}function Jx(n,e,t){let r=n.type===4&&!t?JI:n.value;return e===r}function Xx(n,e,t){let r=4,i=n.attrs,o=i!==null?nR(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!tn(r)&&!tn(c))return!1;if(s&&tn(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!Jx(n,c,t)||c===""&&e.length===1){if(tn(r))return!1;s=!0}}else if(r&8){if(i===null||!Zx(n,i,c,t)){if(tn(r))return!1;s=!0}}else{let l=e[++a],h=eR(c,i,gp(n),t);if(h===-1){if(tn(r))return!1;s=!0;continue}if(l!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(tn(r))return!1;s=!0}}}}return tn(r)||s}function tn(n){return(n&1)===0}function eR(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return rR(e,n)}function tR(n,e,t=!1){for(let r=0;r<e.length;r++)if(Xx(n,e[r],t))return!0;return!1}function nR(n){for(let e=0;e<n.length;e++){let t=n[e];if(Qx(t))return e}return n.length}function rR(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function uI(n,e){return n?":not("+e.trim()+")":e}function iR(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!tn(s)&&(e+=uI(o,i),i=""),r=s,o=o||!tn(r);t++}return i!==""&&(e+=uI(o,i)),e}function oR(n){return n.map(iR).join(",")}function sR(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!tn(i))break;i=o}r++}return{attrs:e,classes:t}}function tt(n){return da(()=>{let e=rE(n),t=Te($({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ZI.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||mn.Emulated,styles:n.styles||pn,_:null,schemas:n.schemas||null,tView:null,id:""});iE(t);let r=n.dependencies;return t.directiveDefs=lI(r,!1),t.pipeDefs=lI(r,!0),t.id=cR(t),t})}function aR(n){return mr(n)||XI(n)}function uR(n){return n!==null}function Dt(n){return da(()=>({type:n.type,bootstrap:n.bootstrap||pn,declarations:n.declarations||pn,imports:n.imports||pn,exports:n.exports||pn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function cI(n,e){if(n==null)return ia;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=gr.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==gr.None?[r,a]:r,e[o]=s):t[o]=r}return t}function mp(n){return da(()=>{let e=rE(n);return iE(e),e})}function mr(n){return n[Px]||null}function XI(n){return n[kx]||null}function eE(n){return n[Ox]||null}function tE(n){let e=mr(n)||XI(n)||eE(n);return e!==null?e.standalone:!1}function nE(n,e){let t=n[Fx]||null;if(!t&&e===!0)throw new Error(`Type ${kt(n)} does not have '\u0275mod' property.`);return t}function rE(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||ia,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||pn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:cI(n.inputs,e),outputs:cI(n.outputs),debugInfo:null}}function iE(n){n.features?.forEach(e=>e(n))}function lI(n,e){if(!n)return null;let t=e?eE:aR;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(uR)}function cR(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function lR(...n){return{\u0275providers:oE(!0,n),\u0275fromNgModule:!0}}function oE(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return fp(e,s=>{let a=s;Of(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&sE(i,o),t}function sE(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];yp(i,o=>{e(o,r)})}}function Of(n,e,t,r){if(n=Ht(n),!n)return!1;let i=null,o=rI(n),s=!o&&mr(n);if(!o&&!s){let c=n.ngModule;if(o=rI(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of c)Of(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{fp(o.imports,h=>{Of(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&sE(l,e)}if(!a){let l=fo(i)||(()=>new i);e({provide:i,useFactory:l,deps:pn},i),e({provide:YI,useValue:i,multi:!0},i),e({provide:po,useValue:()=>O(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let l=n;yp(c,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function yp(n,e){for(let t of n)HI(t)&&(t=t.\u0275providers),Array.isArray(t)?yp(t,e):e(t)}var dR=De({provide:String,useValue:De});function aE(n){return n!==null&&typeof n=="object"&&dR in n}function hR(n){return!!(n&&n.useExisting)}function fR(n){return!!(n&&n.useFactory)}function Ff(n){return typeof n=="function"}var el=new z(""),Tc={},pR={},Df;function vp(){return Df===void 0&&(Df=new Nc),Df}var Ot=class{},oa=class extends Ot{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Vf(e,s=>this.processProvider(s)),this.records.set(QI,so(void 0,this)),i.has("environment")&&this.records.set(Ot,so(void 0,this));let o=this.records.get(el);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(YI,pn,ae.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ee(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ee(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=hr(this),r=$t(void 0),i;try{return e()}finally{hr(t),$t(r)}}get(e,t=ra,r=ae.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(oI))return e[oI](this);r=Xc(r);let i,o=hr(this),s=$t(void 0);try{if(!(r&ae.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=_R(e)&&Jc(e);l&&this.injectableDefInScope(l)?c=so(Lf(e),Tc):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ae.Self?vp():this.parent;return t=r&ae.Optional&&t===ra?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Rc]=a[Rc]||[]).unshift(kt(e)),o)throw a;return Gx(a,e,"R3InjectorError",this.source)}else throw a}finally{$t(s),hr(o)}}resolveInjectorInitializers(){let e=Ee(null),t=hr(this),r=$t(void 0),i;try{let o=this.get(po,pn,ae.Self);for(let s of o)s()}finally{hr(t),$t(r),Ee(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(kt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new X(205,!1)}processProvider(e){e=Ht(e);let t=Ff(e)?e:Ht(e&&e.provide),r=mR(e);if(!Ff(e)&&e.multi===!0){let i=this.records.get(t);i||(i=so(void 0,Tc,!0),i.factory=()=>Pf(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Ee(null);try{return t.value===Tc&&(t.value=pR,t.value=t.factory()),typeof t.value=="object"&&t.value&&wR(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ee(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Ht(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Lf(n){let e=Jc(n),t=e!==null?e.factory:fo(n);if(t!==null)return t;if(n instanceof z)throw new X(204,!1);if(n instanceof Function)return gR(n);throw new X(204,!1)}function gR(n){if(n.length>0)throw new X(204,!1);let t=Mx(n);return t!==null?()=>t.factory(n):()=>new n}function mR(n){if(aE(n))return so(void 0,n.useValue);{let e=yR(n);return so(e,Tc)}}function yR(n,e,t){let r;if(Ff(n)){let i=Ht(n);return fo(i)||Lf(i)}else if(aE(n))r=()=>Ht(n.useValue);else if(fR(n))r=()=>n.useFactory(...Pf(n.deps||[]));else if(hR(n))r=()=>O(Ht(n.useExisting));else{let i=Ht(n&&(n.useClass||n.provide));if(vR(n))r=()=>new i(...Pf(n.deps));else return fo(i)||Lf(i)}return r}function so(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function vR(n){return!!n.deps}function wR(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function _R(n){return typeof n=="function"||typeof n=="object"&&n instanceof z}function Vf(n,e){for(let t of n)Array.isArray(t)?Vf(t,e):t&&HI(t)?Vf(t.\u0275providers,e):e(t)}function wn(n,e){n instanceof oa&&n.assertNotDestroyed();let t,r=hr(n),i=$t(void 0);try{return e()}finally{hr(r),$t(i)}}function uE(){return qI()!==void 0||Hx()!=null}function IR(n){if(!uE())throw new X(-203,!1)}function ER(n){let e=Bn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function DR(n){return typeof n=="function"}var Un=0,de=1,ne=2,_t=3,nn=4,rn=5,Pc=6,dI=7,yr=8,go=9,yn=10,Gt=11,sa=12,hI=13,fa=14,vn=15,aa=16,ao=17,tl=18,nl=19,cE=20,pr=21,Cf=22,qt=23,si=25,lE=1;var ai=7,kc=8,Oc=9,zt=10,Fc=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Fc||{});function ii(n){return Array.isArray(n)&&typeof n[lE]=="object"}function $n(n){return Array.isArray(n)&&n[lE]===!0}function dE(n){return(n.flags&4)!==0}function rl(n){return n.componentOffset>-1}function CR(n){return(n.flags&1)===1}function pa(n){return!!n.template}function jf(n){return(n[ne]&512)!==0}var Bf=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function hE(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function il(){return fE}function fE(n){return n.type.prototype.ngOnChanges&&(n.setInput=bR),TR}il.ngInherit=!0;function TR(){let n=gE(this),e=n?.current;if(e){let t=n.previous;if(t===ia)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function bR(n,e,t,r,i){let o=this.declaredInputs[r],s=gE(n)||SR(n,{previous:ia,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new Bf(l&&l.currentValue,t,c===ia),hE(n,e,i,t)}var pE="__ngSimpleChanges__";function gE(n){return n[pE]||null}function SR(n,e){return n[pE]=e}var fI=null;var fr=function(n,e,t){fI?.(n,e,t)},AR="svg",xR="math";function Vn(n){for(;Array.isArray(n);)n=n[Un];return n}function RR(n,e){return Vn(e[n])}function _n(n,e){return Vn(e[n.index])}function mE(n,e){return n.data[e]}function Eo(n,e){let t=e[n];return ii(t)?t:t[Un]}function wp(n){return(n[ne]&128)===128}function MR(n){return $n(n[_t])}function pI(n,e){return e==null?null:n[e]}function yE(n){n[ao]=0}function vE(n){n[ne]&1024||(n[ne]|=1024,wp(n)&&sl(n))}function ol(n){return!!(n[ne]&9216||n[qt]?.dirty)}function Uf(n){n[yn].changeDetectionScheduler?.notify(8),n[ne]&64&&(n[ne]|=1024),ol(n)&&sl(n)}function sl(n){n[yn].changeDetectionScheduler?.notify(0);let e=ui(n);for(;e!==null&&!(e[ne]&8192||(e[ne]|=8192,!wp(e)));)e=ui(e)}function wE(n,e){if((n[ne]&256)===256)throw new X(911,!1);n[pr]===null&&(n[pr]=[]),n[pr].push(e)}function NR(n,e){if(n[pr]===null)return;let t=n[pr].indexOf(e);t!==-1&&n[pr].splice(t,1)}function ui(n){let e=n[_t];return $n(e)?e[_t]:e}var ve={lFrame:xE(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var _E=!1;function PR(){return ve.lFrame.elementDepthCount}function kR(){ve.lFrame.elementDepthCount++}function OR(){ve.lFrame.elementDepthCount--}function IE(){return ve.bindingsEnabled}function FR(){return ve.skipHydrationRootTNode!==null}function LR(n){return ve.skipHydrationRootTNode===n}function VR(){ve.skipHydrationRootTNode=null}function It(){return ve.lFrame.lView}function ga(){return ve.lFrame.tView}function Hn(){let n=EE();for(;n!==null&&n.type===64;)n=n.parent;return n}function EE(){return ve.lFrame.currentTNode}function jR(){let n=ve.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function al(n,e){let t=ve.lFrame;t.currentTNode=n,t.isParent=e}function DE(){return ve.lFrame.isParent}function BR(){ve.lFrame.isParent=!1}function CE(){return _E}function gI(n){_E=n}function UR(n){return ve.lFrame.bindingIndex=n}function TE(){return ve.lFrame.bindingIndex++}function $R(){return ve.lFrame.inI18n}function HR(n,e){let t=ve.lFrame;t.bindingIndex=t.bindingRootIndex=n,$f(e)}function qR(){return ve.lFrame.currentDirectiveIndex}function $f(n){ve.lFrame.currentDirectiveIndex=n}function bE(n){ve.lFrame.currentQueryIndex=n}function zR(n){let e=n[de];return e.type===2?e.declTNode:e.type===1?n[rn]:null}function SE(n,e,t){if(t&ae.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&ae.Host);)if(i=zR(o),i===null||(o=o[fa],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=ve.lFrame=AE();return r.currentTNode=e,r.lView=n,!0}function _p(n){let e=AE(),t=n[de];ve.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function AE(){let n=ve.lFrame,e=n===null?null:n.child;return e===null?xE(n):e}function xE(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function RE(){let n=ve.lFrame;return ve.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var ME=RE;function Ip(){let n=RE();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ep(){return ve.lFrame.selectedIndex}function ci(n){ve.lFrame.selectedIndex=n}function GR(){let n=ve.lFrame;return mE(n.tView,n.selectedIndex)}function WR(){return ve.lFrame.currentNamespace}var NE=!0;function PE(){return NE}function kE(n){NE=n}function KR(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=fE(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function OE(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function bc(n,e,t){FE(n,e,3,t)}function Sc(n,e,t,r){(n[ne]&3)===t&&FE(n,e,t,r)}function Tf(n,e){let t=n[ne];(t&3)===e&&(t&=16383,t+=1,n[ne]=t)}function FE(n,e,t,r){let i=r!==void 0?n[ao]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[ao]+=65536),(a<o||o==-1)&&(QR(n,t,e,c),n[ao]=(n[ao]&4294901760)+c+2),c++}function mI(n,e){fr(4,n,e);let t=Ee(null);try{e.call(n)}finally{Ee(t),fr(5,n,e)}}function QR(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ne]>>14<n[ao]>>16&&(n[ne]&3)===e&&(n[ne]+=16384,mI(a,o)):mI(a,o)}var ho=-1,ua=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function YR(n){return n instanceof ua}function ZR(n){return(n.flags&8)!==0}function JR(n){return(n.flags&16)!==0}var bf={},Hf=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Xc(r);let i=this.injector.get(e,bf,r);return i!==bf||t===bf?i:this.parentInjector.get(e,t,r)}};function LE(n){return n!==ho}function Lc(n){return n&32767}function XR(n){return n>>16}function Vc(n,e){let t=XR(n),r=e;for(;t>0;)r=r[fa],t--;return r}var qf=!0;function yI(n){let e=qf;return qf=n,e}var eM=256,VE=eM-1,jE=5,tM=0,gn={};function nM(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(ta)&&(r=t[ta]),r==null&&(r=t[ta]=tM++);let i=r&VE,o=1<<i;e.data[n+(i>>jE)]|=o}function BE(n,e){let t=UE(n,e);if(t!==-1)return t;let r=e[de];r.firstCreatePass&&(n.injectorIndex=e.length,Sf(r.data,n),Sf(e,null),Sf(r.blueprint,null));let i=Dp(n,e),o=n.injectorIndex;if(LE(i)){let s=Lc(i),a=Vc(i,e),c=a[de].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=i,o}function Sf(n,e){n.push(0,0,0,0,0,0,0,0,e)}function UE(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Dp(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=GE(i),r===null)return ho;if(t++,i=i[fa],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return ho}function rM(n,e,t){nM(n,e,t)}function $E(n,e,t){if(t&ae.Optional||n!==void 0)return n;hp(e,"NodeInjector")}function HE(n,e,t,r){if(t&ae.Optional&&r===void 0&&(r=null),!(t&(ae.Self|ae.Host))){let i=n[go],o=$t(void 0);try{return i?i.get(e,r,t&ae.Optional):zI(e,r,t&ae.Optional)}finally{$t(o)}}return $E(r,e,t)}function qE(n,e,t,r=ae.Default,i){if(n!==null){if(e[ne]&2048&&!(r&ae.Self)){let s=uM(n,e,t,r,gn);if(s!==gn)return s}let o=zE(n,e,t,r,gn);if(o!==gn)return o}return HE(e,t,r,i)}function zE(n,e,t,r,i){let o=sM(t);if(typeof o=="function"){if(!SE(e,n,r))return r&ae.Host?$E(i,t,r):HE(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&ae.Optional))hp(t);else return s}finally{ME()}}else if(typeof o=="number"){let s=null,a=UE(n,e),c=ho,l=r&ae.Host?e[vn][rn]:null;for((a===-1||r&ae.SkipSelf)&&(c=a===-1?Dp(n,e):e[a+8],c===ho||!wI(r,!1)?a=-1:(s=e[de],a=Lc(c),e=Vc(c,e)));a!==-1;){let h=e[de];if(vI(o,a,h.data)){let p=iM(a,e,t,s,r,l);if(p!==gn)return p}c=e[a+8],c!==ho&&wI(r,e[de].data[a+8]===l)&&vI(o,a,e)?(s=h,a=Lc(c),e=Vc(c,e)):a=-1}}return i}function iM(n,e,t,r,i,o){let s=e[de],a=s.data[n+8],c=r==null?rl(a)&&qf:r!=s&&(a.type&3)!==0,l=i&ae.Host&&o===a,h=oM(a,s,t,c,l);return h!==null?ca(e,s,h,a):gn}function oM(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,l=n.directiveEnd,h=o>>20,p=r?a:a+h,m=i?a+h:l;for(let v=p;v<m;v++){let b=s[v];if(v<c&&t===b||v>=c&&b.type===t)return v}if(i){let v=s[c];if(v&&pa(v)&&v.type===t)return c}return null}function ca(n,e,t,r){let i=n[t],o=e.data;if(YR(i)){let s=i;s.resolving&&Vx(Lx(o[t]));let a=yI(s.canSeeViewProviders);s.resolving=!0;let c,l=s.injectImpl?$t(s.injectImpl):null,h=SE(n,r,ae.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&KR(t,o[t],e)}finally{l!==null&&$t(l),yI(a),s.resolving=!1,ME()}}return i}function sM(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ta)?n[ta]:void 0;return typeof e=="number"?e>=0?e&VE:aM:e}function vI(n,e,t){let r=1<<n;return!!(t[e+(n>>jE)]&r)}function wI(n,e){return!(n&ae.Self)&&!(n&ae.Host&&e)}var oi=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return qE(this._tNode,this._lView,e,Xc(r),t)}};function aM(){return new oi(Hn(),It())}function Cp(n){return da(()=>{let e=n.prototype.constructor,t=e[xc]||zf(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[xc]||zf(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function zf(n){return jI(n)?()=>{let e=zf(Ht(n));return e&&e()}:fo(n)}function uM(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ne]&2048&&!(s[ne]&512);){let a=zE(o,s,t,r|ae.Self,gn);if(a!==gn)return a;let c=o.parent;if(!c){let l=s[cE];if(l){let h=l.get(t,gn,r);if(h!==gn)return h}c=GE(s),s=s[fa]}o=c}return i}function GE(n){let e=n[de],t=e.type;return t===2?e.declTNode:t===1?n[rn]:null}function _I(n,e=null,t=null,r){let i=WE(n,e,t,r);return i.resolveInjectorInitializers(),i}function WE(n,e=null,t=null,r,i=new Set){let o=[t||pn,lR(n)];return r=r||(typeof n=="object"?void 0:kt(n)),new oa(o,e||vp(),r||null,i)}var Wt=class n{static{this.THROW_IF_NOT_FOUND=ra}static{this.NULL=new Nc}static create(e,t){if(Array.isArray(e))return _I({name:""},t,e,"");{let r=e.name??"";return _I({name:r},e.parent,e.providers,r)}}static{this.\u0275prov=W({token:n,providedIn:"any",factory:()=>O(QI)})}static{this.__NG_ELEMENT_ID__=-1}};var cM=new z("");cM.__NG_ELEMENT_ID__=n=>{let e=Hn();if(e===null)throw new X(204,!1);if(e.type&2)return e.value;if(n&ae.Optional)return null;throw new X(204,!1)};var lM="ngOriginalError";function Af(n){return n[lM]}var KE=!0,Tp=(()=>{class n{static{this.__NG_ELEMENT_ID__=dM}static{this.__NG_ENV_ID__=t=>t}}return n})(),Gf=class extends Tp{constructor(e){super(),this._lView=e}onDestroy(e){return wE(this._lView,e),()=>NR(this._lView,e)}};function dM(){return new Gf(It())}var Do=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new it(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=W({token:n,providedIn:"root",factory:()=>new n})}}return n})();var Wf=class extends Be{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,uE()&&(this.destroyRef=V(Tp,{optional:!0})??void 0,this.pendingTasks=V(Do,{optional:!0})??void 0)}emit(e){let t=Ee(null);try{super.next(e)}finally{Ee(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Le&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},wt=Wf;function jc(...n){}function QE(n){let e,t;function r(){n=jc;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function II(n){return queueMicrotask(()=>n()),()=>{n=jc}}var bp="isAngularZone",Bc=bp+"_ID",hM=0,he=class n{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new wt(!1),this.onMicrotaskEmpty=new wt(!1),this.onStable=new wt(!1),this.onError=new wt(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=KE}=e;if(typeof Zone>"u")throw new X(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,gM(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(bp)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new X(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new X(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,fM,jc,jc);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},fM={};function Sp(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function pM(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){QE(()=>{n.callbackScheduled=!1,Kf(n),n.isCheckStableRunning=!0,Sp(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Kf(n)}function gM(n){let e=()=>{pM(n)},t=hM++;n._inner=n._inner.fork({name:"angular",properties:{[bp]:!0,[Bc]:t,[Bc+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(mM(c))return r.invokeTask(o,s,a,c);try{return EI(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),DI(n)}},onInvoke:(r,i,o,s,a,c,l)=>{try{return EI(n),r.invoke(o,s,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!yM(c)&&e(),DI(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Kf(n),Sp(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Kf(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function EI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function DI(n){n._nesting--,Sp(n)}var Uc=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new wt,this.onMicrotaskEmpty=new wt,this.onStable=new wt,this.onError=new wt}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function mM(n){return YE(n,"__ignore_ng_zone__")}function yM(n){return YE(n,"__scheduler_tick__")}function YE(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}function vM(n="zone.js",e){return n==="noop"?new Uc:n==="zone.js"?new he(e):n}var jn=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Af(e);for(;t&&Af(t);)t=Af(t);return t||null}},wM=new z("",{providedIn:"root",factory:()=>{let n=V(he),e=V(jn);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function _M(){return Ap(Hn(),It())}function Ap(n,e){return new ul(_n(n,e))}var ul=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=_M}}return n})();function ZE(n){return(n.flags&128)===128}var JE=new Map,IM=0;function EM(){return IM++}function DM(n){JE.set(n[nl],n)}function Qf(n){JE.delete(n[nl])}var CI="__ngContext__";function mo(n,e){ii(e)?(n[CI]=e[nl],DM(e)):n[CI]=e}function XE(n){return tD(n[sa])}function eD(n){return tD(n[nn])}function tD(n){for(;n!==null&&!$n(n);)n=n[nn];return n}var Yf;function nD(n){Yf=n}function CM(){if(Yf!==void 0)return Yf;if(typeof document<"u")return document;throw new X(210,!1)}var cl=new z("",{providedIn:"root",factory:()=>TM}),TM="ng",xp=new z(""),At=new z("",{providedIn:"platform",factory:()=>"unknown"});var Rp=new z("",{providedIn:"root",factory:()=>CM().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var bM="h",SM="b";var AM=()=>null;function Mp(n,e,t=!1){return AM(n,e,t)}var rD=!1,xM=new z("",{providedIn:"root",factory:()=>rD});var $c=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${FI})`}};function Np(n){return n instanceof $c?n.changingThisBreaksApplicationSecurity:n}function iD(n,e){let t=RM(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${FI})`)}return t===e}function RM(n){return n instanceof $c&&n.getTypeName()||null}var MM=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function oD(n){return n=String(n),n.match(MM)?n:"unsafe:"+n}var Pp=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Pp||{});function sD(n){let e=NM();return e?e.sanitize(Pp.URL,n)||"":iD(n,"URL")?Np(n):oD(dp(n))}function NM(){let n=It();return n&&n[yn].sanitizer}function aD(n){return n instanceof Function?n():n}function PM(n){return(n??V(Wt)).get(At)==="browser"}var li=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(li||{}),kM;function kp(n,e){return kM(n,e)}function uo(n,e,t,r,i){if(r!=null){let o,s=!1;$n(r)?o=r:ii(r)&&(s=!0,r=r[Un]);let a=Vn(r);n===0&&t!==null?i==null?hD(e,t,a):Hc(e,t,a,i||null,!0):n===1&&t!==null?Hc(e,t,a,i||null,!0):n===2?QM(e,a,s):n===3&&e.destroyNode(a),o!=null&&ZM(e,n,o,t,i)}}function OM(n,e){return n.createText(e)}function FM(n,e,t){n.setValue(e,t)}function uD(n,e,t){return n.createElement(e,t)}function LM(n,e){cD(n,e),e[Un]=null,e[rn]=null}function VM(n,e,t,r,i,o){r[Un]=i,r[rn]=e,ll(n,r,t,1,i,o)}function cD(n,e){e[yn].changeDetectionScheduler?.notify(9),ll(n,e,e[Gt],2,null,null)}function jM(n){let e=n[sa];if(!e)return xf(n[de],n);for(;e;){let t=null;if(ii(e))t=e[sa];else{let r=e[zt];r&&(t=r)}if(!t){for(;e&&!e[nn]&&e!==n;)ii(e)&&xf(e[de],e),e=e[_t];e===null&&(e=n),ii(e)&&xf(e[de],e),t=e&&e[nn]}e=t}}function BM(n,e,t,r){let i=zt+r,o=t.length;r>0&&(t[i-1][nn]=e),r<o-zt?(e[nn]=t[i],KI(t,zt+r,e)):(t.push(e),e[nn]=null),e[_t]=t;let s=e[aa];s!==null&&t!==s&&lD(s,e);let a=e[tl];a!==null&&a.insertView(n),Uf(e),e[ne]|=128}function lD(n,e){let t=n[Oc],r=e[_t];if(ii(r))n[ne]|=Fc.HasTransplantedViews;else{let i=r[_t][vn];e[vn]!==i&&(n[ne]|=Fc.HasTransplantedViews)}t===null?n[Oc]=[e]:t.push(e)}function Op(n,e){let t=n[Oc],r=t.indexOf(e);t.splice(r,1)}function Zf(n,e){if(n.length<=zt)return;let t=zt+e,r=n[t];if(r){let i=r[aa];i!==null&&i!==n&&Op(i,r),e>0&&(n[t-1][nn]=r[nn]);let o=Mc(n,zt+e);LM(r[de],r);let s=o[tl];s!==null&&s.detachView(o[de]),r[_t]=null,r[nn]=null,r[ne]&=-129}return r}function dD(n,e){if(!(e[ne]&256)){let t=e[Gt];t.destroyNode&&ll(n,e,t,3,null,null),jM(e)}}function xf(n,e){if(e[ne]&256)return;let t=Ee(null);try{e[ne]&=-129,e[ne]|=256,e[qt]&&ef(e[qt]),$M(n,e),UM(n,e),e[de].type===1&&e[Gt].destroy();let r=e[aa];if(r!==null&&$n(e[_t])){r!==e[_t]&&Op(r,e);let i=e[tl];i!==null&&i.detachView(n)}Qf(e)}finally{Ee(t)}}function UM(n,e){let t=n.cleanup,r=e[dI];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let s=t[o+3];s>=0?r[s]():r[-s].unsubscribe(),o+=2}else{let s=r[t[o+1]];t[o].call(s)}r!==null&&(e[dI]=null);let i=e[pr];if(i!==null){e[pr]=null;for(let o=0;o<i.length;o++){let s=i[o];s()}}}function $M(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ua)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];fr(4,a,c);try{c.call(a)}finally{fr(5,a,c)}}else{fr(4,i,o);try{o.call(i)}finally{fr(5,i,o)}}}}}function HM(n,e,t){return qM(n,e.parent,t)}function qM(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Un];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===mn.None||o===mn.Emulated)return null}return _n(r,t)}}function Hc(n,e,t,r,i){n.insertBefore(e,t,r,i)}function hD(n,e,t){n.appendChild(e,t)}function TI(n,e,t,r,i){r!==null?Hc(n,e,t,r,i):hD(n,e,t)}function fD(n,e){return n.parentNode(e)}function zM(n,e){return n.nextSibling(e)}function GM(n,e,t){return KM(n,e,t)}function WM(n,e,t){return n.type&40?_n(n,t):null}var KM=WM,bI;function pD(n,e,t,r){let i=HM(n,r,e),o=e[Gt],s=r.parent||e[rn],a=GM(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)TI(o,i,t[c],a,!1);else TI(o,i,t,a,!1);bI!==void 0&&bI(o,r,e,t,i)}function ea(n,e){if(e!==null){let t=e.type;if(t&3)return _n(e,n);if(t&4)return Jf(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return ea(n,r);{let i=n[e.index];return $n(i)?Jf(-1,i):Vn(i)}}else{if(t&128)return ea(n,e.next);if(t&32)return kp(e,n)()||Vn(n[e.index]);{let r=gD(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=ui(n[vn]);return ea(i,r)}else return ea(n,e.next)}}}return null}function gD(n,e){if(e!==null){let r=n[vn][rn],i=e.projection;return r.projection[i]}return null}function Jf(n,e){let t=zt+n+1;if(t<e.length){let r=e[t],i=r[de].firstChild;if(i!==null)return ea(r,i)}return e[ai]}function QM(n,e,t){n.removeChild(null,e,t)}function Fp(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&e===0&&(a&&mo(Vn(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)Fp(n,e,t.child,r,i,o,!1),uo(e,n,i,a,o);else if(c&32){let l=kp(t,r),h;for(;h=l();)uo(e,n,i,h,o);uo(e,n,i,a,o)}else c&16?YM(n,e,r,t,i,o):uo(e,n,i,a,o);t=s?t.projectionNext:t.next}}function ll(n,e,t,r,i,o){Fp(t,r,n.firstChild,e,i,o,!1)}function YM(n,e,t,r,i,o){let s=t[vn],c=s[rn].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let h=c[l];uo(e,n,i,h,o)}else{let l=c,h=s[_t];ZE(r)&&(l.flags|=128),Fp(n,e,l,h,i,o,!0)}}function ZM(n,e,t,r,i){let o=t[ai],s=Vn(t);o!==s&&uo(e,n,r,o,i);for(let a=zt;a<t.length;a++){let c=t[a];ll(c[de],c,n,e,r,o)}}function JM(n,e,t){n.setAttribute(e,"style",t)}function mD(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function yD(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&kf(n,e,r),i!==null&&mD(n,e,i),o!==null&&JM(n,e,o)}var dl={};function _r(n=1){vD(ga(),It(),Ep()+n,!1)}function vD(n,e,t,r){if(!r)if((e[ne]&3)===3){let o=n.preOrderCheckHooks;o!==null&&bc(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Sc(e,o,0,t)}ci(t)}function Ir(n,e=ae.Default){let t=It();if(t===null)return O(n,e);let r=Hn();return qE(r,t,Ht(n),e)}function wD(){let n="invalid";throw new Error(n)}function _D(n,e,t,r,i,o){let s=Ee(null);try{let a=null;i&gr.SignalBased&&(a=e[r][b_]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&gr.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):hE(e,a,r,o)}finally{Ee(s)}}function XM(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ci(~i);else{let o=i,s=t[++r],a=t[++r];HR(s,o);let c=e[o];a(2,c)}}}finally{ci(-1)}}function Lp(n,e,t,r,i,o,s,a,c,l,h){let p=e.blueprint.slice();return p[Un]=i,p[ne]=r|4|128|8|64,(l!==null||n&&n[ne]&2048)&&(p[ne]|=2048),yE(p),p[_t]=p[fa]=n,p[yr]=t,p[yn]=s||n&&n[yn],p[Gt]=a||n&&n[Gt],p[go]=c||n&&n[go]||null,p[rn]=o,p[nl]=EM(),p[Pc]=h,p[cE]=l,p[vn]=e.type==2?n[vn]:p,p}function Vp(n,e,t,r,i){let o=n.data[e];if(o===null)o=eN(n,e,t,r,i),$R()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=jR();o.injectorIndex=s===null?-1:s.injectorIndex}return al(o,!0),o}function eN(n,e,t,r,i){let o=EE(),s=DE(),a=s?o:o&&o.parent,c=n.data[e]=aN(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),o!==null&&(s?o.child==null&&c.parent!==null&&(o.child=c):o.next===null&&(o.next=c,c.prev=o)),c}function ID(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function ED(n,e,t,r,i){let o=Ep(),s=r&2;try{ci(-1),s&&e.length>si&&vD(n,e,si,!1),fr(s?2:0,i),t(r,i)}finally{ci(o),fr(s?3:1,i)}}function DD(n,e,t){if(dE(e)){let r=Ee(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{Ee(r)}}}function tN(n,e,t){IE()&&(gN(n,e,t,_n(t,e)),(t.flags&64)===64&&SD(n,e,t))}function nN(n,e,t=_n){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function CD(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=TD(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function TD(n,e,t,r,i,o,s,a,c,l,h){let p=si+r,m=p+i,v=rN(p,m),b=typeof l=="function"?l():l;return v[de]={type:n,blueprint:v,template:t,queries:null,viewQuery:a,declTNode:e,data:v.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:b,incompleteFirstPass:!1,ssrId:h}}function rN(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:dl);return t}function iN(n,e,t,r){let o=r.get(xM,rD)||t===mn.ShadowDom,s=n.selectRootElement(e,o);return oN(s),s}function oN(n){sN(n)}var sN=()=>null;function aN(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return FR()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function SI(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,c=gr.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let l=o;if(i!==null){if(!i.hasOwnProperty(o))continue;l=i[o]}n===0?AI(r,t,l,a,c):AI(r,t,l,a)}return r}function AI(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function uN(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],c=null,l=null;for(let h=r;h<i;h++){let p=o[h],m=t?t.get(p):null,v=m?m.inputs:null,b=m?m.outputs:null;c=SI(0,p.inputs,h,c,v),l=SI(1,p.outputs,h,l,b);let M=c!==null&&s!==null&&!gp(e)?CN(c,h,s):null;a.push(M)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function cN(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function lN(n,e,t,r,i,o,s,a){let c=_n(e,t),l=e.inputs,h;!a&&l!=null&&(h=l[r])?(Bp(n,t,h,r,i),rl(e)&&dN(t,e.index)):e.type&3?(r=cN(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(c,r,i)):e.type&12}function dN(n,e){let t=Eo(e,n);t[ne]&16||(t[ne]|=64)}function hN(n,e,t,r){if(IE()){let i=r===null?null:{"":-1},o=yN(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&bD(n,e,t,s,i,a),i&&vN(t,r,i)}t.mergedAttrs=pp(t.mergedAttrs,t.attrs)}function bD(n,e,t,r,i,o){for(let l=0;l<r.length;l++)rM(BE(t,e),n,r[l].type);_N(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let h=r[l];h.providersResolver&&h.providersResolver(h)}let s=!1,a=!1,c=ID(n,e,r.length,null);for(let l=0;l<r.length;l++){let h=r[l];t.mergedAttrs=pp(t.mergedAttrs,h.hostAttrs),IN(n,t,e,c,h),wN(c,h,i),h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let p=h.type.prototype;!s&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}uN(n,t,o)}function fN(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;pN(s)!=a&&s.push(a),s.push(t,r,o)}}function pN(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function gN(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;rl(t)&&EN(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||BE(t,e),mo(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let c=n.data[a],l=ca(e,n,a,t);if(mo(l,e),s!==null&&DN(e,a-i,l,c,t,s),pa(c)){let h=Eo(t.index,e);h[yr]=ca(e,n,a,t)}}}function SD(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=qR();try{ci(o);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];$f(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&mN(c,l)}}finally{ci(-1),$f(s)}}function mN(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function yN(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(tR(e,s.selectors,!1))if(r||(r=[]),pa(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let c=a.length;Xf(n,e,c)}else r.unshift(s),Xf(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function Xf(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function vN(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new X(-301,!1);r.push(e[i],o)}}}function wN(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;pa(e)&&(t[""]=n)}}function _N(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function IN(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=fo(i.type,!0)),s=new ua(o,pa(i),Ir);n.blueprint[r]=s,t[r]=s,fN(n,e,r,ID(n,t,i.hostVars,dl),i)}function EN(n,e,t){let r=_n(e,n),i=CD(t),o=n[yn].rendererFactory,s=16;t.signals?s=4096:t.onPush&&(s=64);let a=jp(n,Lp(n,i,null,s,r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=a}function DN(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let c=s[a++],l=s[a++],h=s[a++],p=s[a++];_D(r,t,c,l,h,p)}}function CN(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function TN(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function AD(n,e){let t=n.contentQueries;if(t!==null){let r=Ee(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];bE(o),a.contentQueries(2,e[s],s)}}}finally{Ee(r)}}}function jp(n,e){return n[sa]?n[hI][nn]=e:n[sa]=e,n[hI]=e,e}function ep(n,e,t){bE(0);let r=Ee(null);try{e(n,t)}finally{Ee(r)}}function bN(n,e){let t=n[go],r=t?t.get(jn,null):null;r&&r.handleError(e)}function Bp(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],c=t[o++],l=e[s],h=n.data[s];_D(h,l,r,a,c,i)}}function SN(n,e,t){let r=RR(e,n);FM(n[Gt],r,t)}function AN(n,e){let t=Eo(e,n),r=t[de];xN(r,t);let i=t[Un];i!==null&&t[Pc]===null&&(t[Pc]=Mp(i,t[go])),xD(r,t,t[yr])}function xN(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function xD(n,e,t){_p(e);try{let r=n.viewQuery;r!==null&&ep(1,r,t);let i=n.template;i!==null&&ED(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[tl]?.finishViewCreation(n),n.staticContentQueries&&AD(n,e),n.staticViewQueries&&ep(2,n.viewQuery,t);let o=n.components;o!==null&&RN(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ne]&=-5,Ip()}}function RN(n,e){for(let t=0;t<e.length;t++)AN(n,e[t])}function xI(n,e){return!e||e.firstChild===null||ZE(n)}function MN(n,e,t,r=!0){let i=e[de];if(BM(i,e,n,t),r){let s=Jf(t,n),a=e[Gt],c=fD(a,n[ai]);c!==null&&VM(i,n[rn],a,e,c,s)}let o=e[Pc];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function qc(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(Vn(o)),$n(o)&&NN(o,r);let s=t.type;if(s&8)qc(n,e,t.child,r);else if(s&32){let a=kp(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=gD(e,t);if(Array.isArray(a))r.push(...a);else{let c=ui(e[vn]);qc(c[de],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function NN(n,e){for(let t=zt;t<n.length;t++){let r=n[t],i=r[de].firstChild;i!==null&&qc(r[de],r,i,e)}n[ai]!==n[Un]&&e.push(n[ai])}var RD=[];function PN(n){return n[qt]??kN(n)}function kN(n){let e=RD.pop()??Object.create(FN);return e.lView=n,e}function ON(n){n.lView[qt]!==n&&(n.lView=null,RD.push(n))}var FN=Te($({},Zh),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{sl(n.lView)},consumerOnSignalRead(){this.lView[qt]=this}});function LN(n){let e=n[qt]??Object.create(VN);return e.lView=n,e}var VN=Te($({},Zh),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=ui(n.lView);for(;e&&!MD(e[de]);)e=ui(e);e&&vE(e)},consumerOnSignalRead(){this.lView[qt]=this}});function MD(n){return n.type!==2}var jN=100;function ND(n,e=!0,t=0){let r=n[yn],i=r.rendererFactory,o=!1;o||i.begin?.();try{BN(n,t)}catch(s){throw e&&bN(n,s),s}finally{o||(i.end?.(),r.inlineEffectRunner?.flush())}}function BN(n,e){let t=CE();try{gI(!0),tp(n,e);let r=0;for(;ol(n);){if(r===jN)throw new X(103,!1);r++,tp(n,1)}}finally{gI(t)}}function UN(n,e,t,r){let i=e[ne];if((i&256)===256)return;let o=!1,s=!1;!o&&e[yn].inlineEffectRunner?.flush(),_p(e);let a=!0,c=null,l=null;o||(MD(n)?(l=PN(e),c=Jh(l)):S_()===null?(a=!1,l=LN(e),c=Jh(l)):e[qt]&&(ef(e[qt]),e[qt]=null));try{yE(e),UR(n.bindingStartIndex),t!==null&&ED(n,e,t,2,r);let h=(i&3)===3;if(!o)if(h){let v=n.preOrderCheckHooks;v!==null&&bc(e,v,null)}else{let v=n.preOrderHooks;v!==null&&Sc(e,v,0,null),Tf(e,0)}if(s||$N(e),PD(e,0),n.contentQueries!==null&&AD(n,e),!o)if(h){let v=n.contentCheckHooks;v!==null&&bc(e,v)}else{let v=n.contentHooks;v!==null&&Sc(e,v,1),Tf(e,1)}XM(n,e);let p=n.components;p!==null&&OD(e,p,0);let m=n.viewQuery;if(m!==null&&ep(2,m,r),!o)if(h){let v=n.viewCheckHooks;v!==null&&bc(e,v)}else{let v=n.viewHooks;v!==null&&Sc(e,v,2),Tf(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Cf]){for(let v of e[Cf])v();e[Cf]=null}o||(e[ne]&=-73)}catch(h){throw o||sl(e),h}finally{l!==null&&(A_(l,c),a&&ON(l)),Ip()}}function PD(n,e){for(let t=XE(n);t!==null;t=eD(t))for(let r=zt;r<t.length;r++){let i=t[r];kD(i,e)}}function $N(n){for(let e=XE(n);e!==null;e=eD(e)){if(!(e[ne]&Fc.HasTransplantedViews))continue;let t=e[Oc];for(let r=0;r<t.length;r++){let i=t[r];vE(i)}}}function HN(n,e,t){let r=Eo(e,n);kD(r,t)}function kD(n,e){wp(n)&&tp(n,e)}function tp(n,e){let r=n[de],i=n[ne],o=n[qt],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Xh(o)),s||=!1,o&&(o.dirty=!1),n[ne]&=-9217,s)UN(r,n,r.template,n[yr]);else if(i&8192){PD(n,1);let a=r.components;a!==null&&OD(n,a,1)}}function OD(n,e,t){for(let r=0;r<e.length;r++)HN(n,e[r],t)}function FD(n,e){let t=CE()?64:1088;for(n[yn].changeDetectionScheduler?.notify(e);n;){n[ne]|=t;let r=ui(n);if(jf(n)&&!r)return n;n=r}return null}var yo=class{get rootNodes(){let e=this._lView,t=e[de];return qc(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[yr]}set context(e){this._lView[yr]=e}get destroyed(){return(this._lView[ne]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[_t];if($n(e)){let t=e[kc],r=t?t.indexOf(this):-1;r>-1&&(Zf(e,r),Mc(t,r))}this._attachedToViewContainer=!1}dD(this._lView[de],this._lView)}onDestroy(e){wE(this._lView,e)}markForCheck(){FD(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ne]&=-129}reattach(){Uf(this._lView),this._lView[ne]|=128}detectChanges(){this._lView[ne]|=1024,ND(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new X(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=jf(this._lView),t=this._lView[aa];t!==null&&!e&&Op(t,this._lView),cD(this._lView[de],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new X(902,!1);this._appRef=e;let t=jf(this._lView),r=this._lView[aa];r!==null&&!t&&lD(r,this._lView),Uf(this._lView)}};var Eq=new RegExp(`^(\\d+)*(${SM}|${bM})*(.*)`);var qN=()=>null;function RI(n,e){return qN(n,e)}var vo=class{},Up=new z("",{providedIn:"root",factory:()=>!1});var LD=new z(""),VD=new z(""),np=class{},zc=class{};function zN(n){let e=Error(`No component factory found for ${kt(n)}.`);return e[GN]=n,e}var GN="ngComponent";var rp=class{resolveComponentFactory(e){throw zN(e)}},wo=class{static{this.NULL=new rp}},_o=class{};var WN=(()=>{class n{static{this.\u0275prov=W({token:n,providedIn:"root",factory:()=>null})}}return n})();function ip(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=tI(i,a);else if(o==2){let c=a,l=e[++s];r=tI(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Gc=class extends wo{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=mr(e);return new Io(t,this.ngModule)}};function MI(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:gr.None;e?t.push({propName:s,templateName:r,isSignal:(a&gr.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function KN(n){let e=n.toLowerCase();return e==="svg"?AR:e==="math"?xR:null}var Io=class extends zc{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=MI(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return MI(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=oR(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=Ee(null);try{i=i||this.ngModule;let s=i instanceof Ot?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new Hf(e,s):e,c=a.get(_o,null);if(c===null)throw new X(407,!1);let l=a.get(WN,null),h=a.get(vo,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:h},m=c.createRenderer(null,this.componentDef),v=this.componentDef.selectors[0][0]||"div",b=r?iN(m,r,this.componentDef.encapsulation,a):uD(m,v,KN(v)),M=512;this.componentDef.signals?M|=4096:this.componentDef.onPush||(M|=16);let N=null;b!==null&&(N=Mp(b,a,!0));let j=TD(0,null,null,1,0,null,null,null,null,null,null),H=Lp(null,j,null,M,null,null,p,m,a,null,N);_p(H);let F,Q,ee=null;try{let Y=this.componentDef,I,y=null;Y.findHostDirectiveDefs?(I=[],y=new Map,Y.findHostDirectiveDefs(Y,I,y),I.push(Y)):I=[Y];let _=QN(H,b);ee=YN(_,b,Y,I,H,p,m),Q=mE(j,si),b&&XN(m,Y,b,r),t!==void 0&&eP(Q,this.ngContentSelectors,t),F=JN(ee,Y,I,y,H,[tP]),xD(j,H,null)}catch(Y){throw ee!==null&&Qf(ee),Qf(H),Y}finally{Ip()}return new op(this.componentType,F,Ap(Q,H),H,Q)}finally{Ee(o)}}},op=class extends np{constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new yo(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;Bp(o[de],o,i,e,t),this.previousInputValues.set(e,t);let s=Eo(this._tNode.index,o);FD(s,1)}}get injector(){return new oi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function QN(n,e){let t=n[de],r=si;return n[r]=e,Vp(t,r,2,"#host",null)}function YN(n,e,t,r,i,o,s){let a=i[de];ZN(r,n,e,s);let c=null;e!==null&&(c=Mp(e,i[go]));let l=o.rendererFactory.createRenderer(e,t),h=16;t.signals?h=4096:t.onPush&&(h=64);let p=Lp(i,CD(t),null,h,i[n.index],n,o,l,null,null,c);return a.firstCreatePass&&Xf(a,n,r.length-1),jp(i,p),i[n.index]=p}function ZN(n,e,t,r){for(let i of n)e.mergedAttrs=pp(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(ip(e,e.mergedAttrs,!0),t!==null&&yD(r,t,e))}function JN(n,e,t,r,i,o){let s=Hn(),a=i[de],c=_n(s,i);bD(a,i,s,t,null,r);for(let h=0;h<t.length;h++){let p=s.directiveStart+h,m=ca(i,a,p,s);mo(m,i)}SD(a,i,s),c&&mo(c,i);let l=ca(i,a,s.directiveStart+s.componentOffset,s);if(n[yr]=i[yr]=l,o!==null)for(let h of o)h(l,e);return DD(a,s,i),l}function XN(n,e,t,r){if(r)kf(n,t,["ng-version","18.2.13"]);else{let{attrs:i,classes:o}=sR(e.selectors[0]);i&&kf(n,t,i),o&&o.length>0&&mD(n,t,o.join(" "))}}function eP(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null?Array.from(o):null)}}function tP(){let n=Hn();OE(It()[de],n)}var hl=(()=>{class n{static{this.__NG_ELEMENT_ID__=nP}}return n})();function nP(){let n=Hn();return iP(n,It())}var rP=hl,jD=class extends rP{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Ap(this._hostTNode,this._hostLView)}get injector(){return new oi(this._hostTNode,this._hostLView)}get parentInjector(){let e=Dp(this._hostTNode,this._hostLView);if(LE(e)){let t=Vc(e,this._hostLView),r=Lc(e),i=t[de].data[r+8];return new oi(i,t)}else return new oi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=NI(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-zt}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=RI(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,xI(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!DR(e),a;if(s)a=t;else{let b=t||{};a=b.index,r=b.injector,i=b.projectableNodes,o=b.environmentInjector||b.ngModuleRef}let c=s?e:new Io(mr(e)),l=r||this.parentInjector;if(!o&&c.ngModule==null){let M=(s?l:this.parentInjector).get(Ot,null);M&&(o=M)}let h=mr(c.componentType??{}),p=RI(this._lContainer,h?.id??null),m=p?.firstChild??null,v=c.create(l,i,m,o);return this.insertImpl(v.hostView,a,xI(this._hostTNode,p)),v}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(MR(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[_t],l=new jD(c,c[rn],c[_t]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return MN(s,i,o,r),e.attachToViewContainerRef(),KI(Rf(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=NI(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Zf(this._lContainer,t);r&&(Mc(Rf(this._lContainer),t),dD(r[de],r))}detach(e){let t=this._adjustIndex(e,-1),r=Zf(this._lContainer,t);return r&&Mc(Rf(this._lContainer),t)!=null?new yo(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function NI(n){return n[kc]}function Rf(n){return n[kc]||(n[kc]=[])}function iP(n,e){let t,r=e[n.index];return $n(r)?t=r:(t=TN(r,e,null,n),e[n.index]=t,jp(e,t)),sP(t,e,n,r),new jD(t,n,e)}function oP(n,e){let t=n[Gt],r=t.createComment(""),i=_n(e,n),o=fD(t,i);return Hc(t,o,r,zM(t,i),!1),r}var sP=aP;function aP(n,e,t,r){if(n[ai])return;let i;t.type&8?i=Vn(r):i=oP(e,t),n[ai]=i}var PI=new Set;function $p(n){PI.has(n)||(PI.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function uP(n){let e=[],t=new Map;function r(i){let o=t.get(i);if(!o){let s=n(i);t.set(i,o=s.then(hP))}return o}return Wc.forEach((i,o)=>{let s=[];i.templateUrl&&s.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,h=i.styleUrls;i.styleUrls.forEach((p,m)=>{a.push(""),s.push(r(p).then(v=>{a[l+m]=v,h.splice(h.indexOf(p),1),h.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&s.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(s).then(()=>fP(o));e.push(c)}),lP(),Promise.all(e).then(()=>{})}var Wc=new Map,cP=new Set;function lP(){let n=Wc;return Wc=new Map,n}function dP(){return Wc.size===0}function hP(n){return typeof n=="string"?n:n.text()}function fP(n){cP.delete(n)}var vr=class{},la=class{};var Kc=class extends vr{constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Gc(this);let o=nE(e);this._bootstrapComponents=aD(o.bootstrap),this._r3Injector=WE(e,t,[{provide:vr,useValue:this},{provide:wo,useValue:this.componentFactoryResolver},...r],kt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Qc=class extends la{constructor(e){super(),this.moduleType=e}create(e){return new Kc(this.moduleType,e,[])}};function pP(n,e,t){return new Kc(n,e,t,!1)}var sp=class extends vr{constructor(e){super(),this.componentFactoryResolver=new Gc(this),this.instance=null;let t=new oa([...e.providers,{provide:vr,useValue:this},{provide:wo,useValue:this.componentFactoryResolver}],e.parent||vp(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function fl(n,e,t=null){return new sp({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function BD(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function gP(n){return(n.flags&32)===32}var co=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(co||{}),UD=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=W({token:n,providedIn:"root",factory:()=>new n})}}return n})(),ap=class n{constructor(){this.ngZone=V(he),this.scheduler=V(vo),this.errorHandler=V(jn,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[co.EarlyRead,co.Write,co.MixedReadWrite,co.Read]}execute(){this.executing=!0;for(let e of n.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=W({token:n,providedIn:"root",factory:()=>new n})}},up=class{constructor(e,t,r,i){this.impl=e,this.hooks=t,this.once=r,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function Hp(n,e){!e?.injector&&IR(Hp);let t=e?.injector??V(Wt);return PM(t)?($p("NgAfterNextRender"),yP(n,t,e,!0)):vP}function mP(n,e){if(n instanceof Function){let t=[void 0,void 0,void 0,void 0];return t[e]=n,t}else return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function yP(n,e,t,r){let i=e.get(UD);i.impl??=e.get(ap);let o=t?.phase??co.MixedReadWrite,s=t?.manualCleanup!==!0?e.get(Tp):null,a=new up(i.impl,mP(n,o),r,s);return i.impl.register(a),a}var vP={destroy(){}};function wP(n,e,t,r){return BD(n,TE(),t)?e+dp(t)+r:dl}function qp(n,e,t){let r=It(),i=TE();if(BD(r,i,e)){let o=ga(),s=GR();lN(o,s,r,n,e,r[Gt],t,!1)}return qp}function kI(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";Bp(n,t,o[s],s,r)}function _P(n,e,t,r,i,o){let s=e.consts,a=pI(s,i),c=Vp(e,n,2,r,a);return hN(e,t,c,pI(s,o)),c.attrs!==null&&ip(c,c.attrs,!1),c.mergedAttrs!==null&&ip(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function be(n,e,t,r){let i=It(),o=ga(),s=si+n,a=i[Gt],c=o.firstCreatePass?_P(s,o,i,e,t,r):o.data[s],l=IP(o,i,c,a,e,n);i[s]=l;let h=CR(c);return al(c,!0),yD(a,l,c),!gP(c)&&PE()&&pD(o,i,l,c),PR()===0&&mo(l,i),kR(),h&&(tN(o,i,c),DD(o,c,i)),r!==null&&nN(i,c),be}function Se(){let n=Hn();DE()?BR():(n=n.parent,al(n,!1));let e=n;LR(e)&&VR(),OR();let t=ga();return t.firstCreatePass&&(OE(t,n),dE(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&ZR(e)&&kI(t,e,It(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&JR(e)&&kI(t,e,It(),e.stylesWithoutHost,!1),Se}function st(n,e,t,r){return be(n,e,t,r),Se(),st}var IP=(n,e,t,r,i,o)=>(kE(!0),uD(r,i,WR()));var Yc="en-US";var EP=Yc;function DP(n){typeof n=="string"&&(EP=n.toLowerCase().replace(/_/g,"-"))}function Ze(n,e=""){let t=It(),r=ga(),i=n+si,o=r.firstCreatePass?Vp(r,i,1,e,null):r.data[i],s=CP(r,t,o,e,n);t[i]=s,PE()&&pD(r,t,s,o),al(o,!1)}var CP=(n,e,t,r,i)=>(kE(!0),OM(e[Gt],r));function Er(n,e,t){let r=It(),i=wP(r,n,e,t);return i!==dl&&SN(r,Ep(),i),Er}var TP=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=oE(!1,t.type),i=r.length>0?fl([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=W({token:n,providedIn:"environment",factory:()=>new n(O(Ot))})}}return n})();function $D(n){$p("NgStandalone"),n.getStandaloneInjector=e=>e.get(TP).getOrCreateStandaloneInjector(n)}var Dc=null;function bP(n){Dc!==null&&(n.defaultEncapsulation!==Dc.defaultEncapsulation||n.preserveWhitespaces!==Dc.preserveWhitespaces)||(Dc=n)}var wr=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},HD=new wr("18.2.13");var pl=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var zp=new z(""),ma=new z(""),gl=(()=>{class n{constructor(t,r,i){this._ngZone=t,this.registry=r,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Gp||(SP(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{he.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(t)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),t()},r)),this._callbacks.push({doneCb:t,timeoutId:o,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static{this.\u0275fac=function(r){return new(r||n)(O(he),O(ml),O(ma))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),ml=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return Gp?.findTestabilityInTree(this,t,r)??null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();function SP(n){Gp=n}var Gp;function ya(n){return!!n&&typeof n.then=="function"}function qD(n){return!!n&&typeof n.subscribe=="function"}var yl=new z(""),zD=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=V(yl,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=i();if(ya(o))t.push(o);else if(qD(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Wp=new z("");function AP(){x_(()=>{throw new X(600,!1)})}function xP(n){return n.isBoundToModule}var RP=10;function MP(n,e,t){try{let r=t();return ya(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function GD(n,e){return Array.isArray(e)?e.reduce(GD,n):$($({},n),e)}var Dr=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=V(wM),this.afterRenderManager=V(UD),this.zonelessEnabled=V(Up),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new Be,this.afterTick=new Be,this.componentTypes=[],this.components=[],this.isStable=V(Do).hasPendingTasks.pipe(J(t=>!t)),this._injector=V(Ot)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof zc;if(!this._injector.get(zD).done){let m=!i&&tE(t),v=!1;throw new X(405,v)}let s;i?s=t:s=this._injector.get(wo).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=xP(s)?void 0:this._injector.get(vr),c=r||s.selector,l=s.create(Wt.NULL,[],c,a),h=l.location.nativeElement,p=l.injector.get(zp,null);return p?.registerApplication(h),l.onDestroy(()=>{this.detachView(l.hostView),Ac(this.components,l),p?.unregisterApplication(h)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new X(101,!1);let t=Ee(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,Ee(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(_o,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<RP;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:o}of this._views)NP(i,o,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>ol(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Ac(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(Wp,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Ac(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new X(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Ac(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function NP(n,e,t,r){if(!t&&!ol(n))return;ND(n,e,t&&!r?0:1)}var cp=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},vl=(()=>{class n{compileModuleSync(t){return new Qc(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=nE(t),o=aD(i.declarations).reduce((s,a)=>{let c=mr(a);return c&&s.push(new Io(c)),s},[]);return new cp(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),PP=new z("");function kP(n,e,t){let r=new Qc(t);return Promise.resolve(r)}function OI(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var OP=(()=>{class n{constructor(){this.zone=V(he),this.changeDetectionScheduler=V(vo),this.applicationRef=V(Dr)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function FP({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new he(Te($({},WD()),{scheduleInRootZone:t})),[{provide:he,useFactory:n},{provide:po,multi:!0,useFactory:()=>{let r=V(OP,{optional:!0});return()=>r.initialize()}},{provide:po,multi:!0,useFactory:()=>{let r=V(LP);return()=>{r.initialize()}}},e===!0?{provide:LD,useValue:!0}:[],{provide:VD,useValue:t??KE}]}function WD(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var LP=(()=>{class n{constructor(){this.subscription=new Le,this.initialized=!1,this.zone=V(he),this.pendingTasks=V(Do)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{he.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{he.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var VP=(()=>{class n{constructor(){this.appRef=V(Dr),this.taskService=V(Do),this.ngZone=V(he),this.zonelessEnabled=V(Up),this.disableScheduling=V(LD,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new Le,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Bc):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(V(VD,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Uc||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?II:QE;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Bc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,II(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function jP(){return typeof $localize<"u"&&$localize.locale||Yc}var Kp=new z("",{providedIn:"root",factory:()=>V(Kp,ae.Optional|ae.SkipSelf)||jP()});var Zc=new z("");function Cc(n){return!n.moduleRef}function BP(n){let e=Cc(n)?n.r3Injector:n.moduleRef.injector,t=e.get(he);return t.run(()=>{Cc(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(jn,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),Cc(n)){let o=()=>e.destroy(),s=n.platformInjector.get(Zc);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Zc);s.add(o),n.moduleRef.onDestroy(()=>{Ac(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return MP(r,t,()=>{let o=e.get(zD);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(Kp,Yc);if(DP(s||Yc),Cc(n)){let a=e.get(Dr);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return UP(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function UP(n,e){let t=n.injector.get(Dr);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new X(-403,!1);e.push(n)}var KD=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){let i=r?.scheduleInRootZone,o=()=>vM(r?.ngZone,Te($({},WD({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing})),{scheduleInRootZone:i})),s=r?.ignoreChangesOutsideZone,a=[FP({ngZoneFactory:o,ignoreChangesOutsideZone:s}),{provide:vo,useExisting:VP}],c=pP(t.moduleType,this.injector,a);return BP({moduleRef:c,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(t,r=[]){let i=GD({},r);return kP(this.injector,i,t).then(o=>this.bootstrapModuleFactory(o,i))}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new X(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());let t=this._injector.get(Zc,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(r){return new(r||n)(O(Wt))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})(),na=null,QD=new z("");function $P(n){if(na&&!na.get(QD,!1))throw new X(400,!1);AP(),na=n;let e=n.get(KD);return zP(n),e}function Qp(n,e,t=[]){let r=`Platform: ${e}`,i=new z(r);return(o=[])=>{let s=YD();if(!s||s.injector.get(QD,!1)){let a=[...t,...o,{provide:i,useValue:!0}];n?n(a):$P(HP(a,r))}return qP(i)}}function HP(n=[],e){return Wt.create({name:e,providers:[{provide:el,useValue:"platform"},{provide:Zc,useValue:new Set([()=>na=null])},...n]})}function qP(n){let e=YD();if(!e)throw new X(401,!1);return e}function YD(){return na?.get(KD)??null}function zP(n){n.get(xp,null)?.forEach(t=>t())}function Yp(){return!1}var va=(()=>{class n{static{this.__NG_ELEMENT_ID__=GP}}return n})();function GP(n){return WP(Hn(),It(),(n&16)===16)}function WP(n,e,t){if(rl(n)&&!t){let r=Eo(n.index,e);return new yo(r,r)}else if(n.type&175){let r=e[vn];return new yo(r,e)}return null}var ZD=Qp(null,"core",[]),JD=(()=>{class n{constructor(t){}static{this.\u0275fac=function(r){return new(r||n)(O(Dr))}}static{this.\u0275mod=Dt({type:n})}static{this.\u0275inj=Et({})}}return n})();function XD(n){let e=mr(n);if(!e)return null;let t=new Io(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var rC=null;function di(){return rC}function iC(n){rC??=n}var wl=class{};var xt=new z(""),Xp=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>V(ZP),providedIn:"platform"})}}return n})(),oC=new z(""),ZP=(()=>{class n extends Xp{constructor(){super(),this._doc=V(xt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return di().getBaseHref(this._doc)}onPopState(t){let r=di().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=di().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function eg(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function eC(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function qn(n){return n&&n[0]!=="?"?"?"+n:n}var hi=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>V(tg),providedIn:"root"})}}return n})(),sC=new z(""),tg=(()=>{class n extends hi{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??V(xt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return eg(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+qn(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+qn(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+qn(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(O(Xp),O(sC,8))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),aC=(()=>{class n extends hi{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=eg(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+qn(o));s.length==0&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+qn(o));s.length==0&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(O(Xp),O(sC,8))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),Co=(()=>{class n{constructor(t){this._subject=new wt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=ek(eC(tC(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+qn(r))}normalize(t){return n.stripTrailingSlash(XP(this._basePath,tC(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+qn(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+qn(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=qn}static{this.joinWithSlash=eg}static{this.stripTrailingSlash=eC}static{this.\u0275fac=function(r){return new(r||n)(O(hi))}}static{this.\u0275prov=W({token:n,factory:()=>JP(),providedIn:"root"})}}return n})();function JP(){return new Co(O(hi))}function XP(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function tC(n){return n.replace(/\/index.html$/,"")}function ek(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function uC(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var cC=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Dt({type:n})}static{this.\u0275inj=Et({})}}return n})(),ng="browser",tk="server";function nk(n){return n===ng}function fi(n){return n===tk}var lC=(()=>{class n{static{this.\u0275prov=W({token:n,providedIn:"root",factory:()=>nk(V(At))?new Zp(V(xt),window):new Jp})}}return n})(),Zp=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=rk(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}};function rk(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let o=i.shadowRoot;if(o){let s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=r.nextNode()}}return null}var Jp=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},_l=class{};var og=class extends wl{constructor(){super(...arguments),this.supportsDOMEvents=!0}},sg=class n extends og{static makeCurrent(){iC(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=ok();return t==null?null:sk(t)}resetBaseElement(){wa=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return uC(document.cookie,e)}},wa=null;function ok(){return wa=wa||document.querySelector("base"),wa?wa.getAttribute("href"):null}function sk(n){return new URL(n,document.baseURI).pathname}var ag=class{addToWindow(e){Bn.getAngularTestability=(r,i=!0)=>{let o=e.findTestabilityInTree(r,i);if(o==null)throw new X(5103,!1);return o},Bn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Bn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=Bn.getAllAngularTestabilities(),o=i.length,s=function(){o--,o==0&&r()};i.forEach(a=>{a.whenStable(s)})};Bn.frameworkStabilizers||(Bn.frameworkStabilizers=[]),Bn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?di().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},ak=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),ug=new z(""),pC=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new X(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(O(ug),O(he))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),Il=class{constructor(e){this._doc=e}},rg="ng-app-id",gC=(()=>{class n{constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=fi(o),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${rg}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let o=i.get(t);return o.usage+=r,o.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,o=i?.get(r);if(o?.parentNode===t)return i.delete(r),o.removeAttribute(rg),o;{let s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=r,this.platformIsServer&&s.setAttribute(rg,this.appId),t.appendChild(s),s}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),o=this.styleRef,s=o.get(r)?.elements;s?s.push(i):o.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(O(xt),O(cl),O(Rp,8),O(At))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),ig={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},lg=/%COMP%/g,mC="%COMP%",uk=`_nghost-${mC}`,ck=`_ngcontent-${mC}`,lk=!0,dk=new z("",{providedIn:"root",factory:()=>lk});function hk(n){return ck.replace(lg,n)}function fk(n){return uk.replace(lg,n)}function yC(n,e){return e.map(t=>t.replace(lg,n))}var dC=(()=>{class n{constructor(t,r,i,o,s,a,c,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=fi(a),this.defaultRenderer=new _a(t,s,c,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===mn.ShadowDom&&(r=Te($({},r),{encapsulation:mn.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof El?i.applyToHost(t):i instanceof Ia&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case mn.Emulated:o=new El(c,l,r,this.appId,h,s,a,p);break;case mn.ShadowDom:return new cg(c,l,t,r,s,a,this.nonce,p);default:o=new Ia(c,l,r,h,s,a,p);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(O(pC),O(gC),O(cl),O(dk),O(xt),O(At),O(he),O(Rp))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),_a=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(ig[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(hC(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(hC(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new X(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=ig[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=ig[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(li.DashCase|li.Important)?e.style.setProperty(t,r,i&li.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&li.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=di().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function hC(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var cg=class extends _a{constructor(e,t,r,i,o,s,a,c){super(e,o,s,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=yC(i.id,i.styles);for(let h of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ia=class extends _a{constructor(e,t,r,i,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?yC(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},El=class extends Ia{constructor(e,t,r,i,o,s,a,c){let l=i+"-"+r.id;super(e,t,r,o,s,a,c,l),this.contentAttr=hk(l),this.hostAttr=fk(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},pk=(()=>{class n extends Il{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(O(xt))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),fC=["alt","control","meta","shift"],gk={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},mk={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},yk=(()=>{class n extends Il{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let o=n.parseEventName(r),s=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>di().onAndCancel(t,o.domEventName,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),fC.forEach(l=>{let h=r.indexOf(l);h>-1&&(r.splice(h,1),s+=l+".")}),s+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,r){let i=gk[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),fC.forEach(s=>{if(s!==i){let a=mk[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(O(xt))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})();function vk(){sg.makeCurrent()}function wk(){return new jn}function _k(){return nD(document),document}var Ik=[{provide:At,useValue:ng},{provide:xp,useValue:vk,multi:!0},{provide:xt,useFactory:_k,deps:[]}],vC=Qp(ZD,"browser",Ik),Ek=new z(""),Dk=[{provide:ma,useClass:ag,deps:[]},{provide:zp,useClass:gl,deps:[he,ml,ma]},{provide:gl,useClass:gl,deps:[he,ml,ma]}],Ck=[{provide:el,useValue:"root"},{provide:jn,useFactory:wk,deps:[]},{provide:ug,useClass:pk,multi:!0,deps:[xt,he,At]},{provide:ug,useClass:yk,multi:!0,deps:[xt]},dC,gC,pC,{provide:_o,useExisting:dC},{provide:_l,useClass:ak,deps:[]},[]],wC=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:cl,useValue:t.appId}]}}static{this.\u0275fac=function(r){return new(r||n)(O(Ek,12))}}static{this.\u0275mod=Dt({type:n})}static{this.\u0275inj=Et({providers:[...Ck,...Dk],imports:[cC,JD]})}}return n})();var _C=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(O(xt))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var oe="primary",Fa=Symbol("RouteTitle"),gg=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Ro(n){return new gg(n)}function Tk(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function bk(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!In(n[t],e[t]))return!1;return!0}function In(n,e){let t=n?mg(n):void 0,r=e?mg(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!NC(n[i],e[i]))return!1;return!0}function mg(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function NC(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function PC(n){return n.length>0?n[n.length-1]:null}function Tr(n){return mf(n)?n:ya(n)?ye(Promise.resolve(n)):Z(n)}var Sk={exact:OC,subset:FC},kC={exact:Ak,subset:xk,ignored:()=>!0};function EC(n,e,t){return Sk[t.paths](n.root,e.root,t.matrixParams)&&kC[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Ak(n,e){return In(n,e)}function OC(n,e,t){if(!gi(n.segments,e.segments)||!Tl(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!OC(n.children[r],e.children[r],t))return!1;return!0}function xk(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>NC(n[t],e[t]))}function FC(n,e,t){return LC(n,e,e.segments,t)}function LC(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!gi(i,t)||e.hasChildren()||!Tl(i,t,r))}else if(n.segments.length===t.length){if(!gi(n.segments,t)||!Tl(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!FC(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!gi(n.segments,i)||!Tl(n.segments,i,r)||!n.children[oe]?!1:LC(n.children[oe],e,o,r)}}function Tl(n,e,t){return e.every((r,i)=>kC[t](n[i].parameters,r.parameters))}var Gn=class{constructor(e=new we([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Ro(this.queryParams),this._queryParamMap}toString(){return Nk.serialize(this)}},we=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return bl(this)}},pi=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Ro(this.parameters),this._parameterMap}toString(){return jC(this)}};function Rk(n,e){return gi(n,e)&&n.every((t,r)=>In(t.parameters,e[r].parameters))}function gi(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Mk(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===oe&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==oe&&(t=t.concat(e(i,r)))}),t}var La=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>new Mo,providedIn:"root"})}}return n})(),Mo=class{parse(e){let t=new vg(e);return new Gn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Ea(e.root,!0)}`,r=Ok(e.queryParams),i=typeof e.fragment=="string"?`#${Pk(e.fragment)}`:"";return`${t}${r}${i}`}},Nk=new Mo;function bl(n){return n.segments.map(e=>jC(e)).join("/")}function Ea(n,e){if(!n.hasChildren())return bl(n);if(e){let t=n.children[oe]?Ea(n.children[oe],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==oe&&r.push(`${i}:${Ea(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Mk(n,(r,i)=>i===oe?[Ea(n.children[oe],!1)]:[`${i}:${Ea(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[oe]!=null?`${bl(n)}/${t[0]}`:`${bl(n)}/(${t.join("//")})`}}function VC(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Dl(n){return VC(n).replace(/%3B/gi,";")}function Pk(n){return encodeURI(n)}function yg(n){return VC(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Sl(n){return decodeURIComponent(n)}function DC(n){return Sl(n.replace(/\+/g,"%20"))}function jC(n){return`${yg(n.path)}${kk(n.parameters)}`}function kk(n){return Object.entries(n).map(([e,t])=>`;${yg(e)}=${yg(t)}`).join("")}function Ok(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Dl(t)}=${Dl(i)}`).join("&"):`${Dl(t)}=${Dl(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Fk=/^[^\/()?;#]+/;function dg(n){let e=n.match(Fk);return e?e[0]:""}var Lk=/^[^\/()?;=#]+/;function Vk(n){let e=n.match(Lk);return e?e[0]:""}var jk=/^[^=?&#]+/;function Bk(n){let e=n.match(jk);return e?e[0]:""}var Uk=/^[^&#]+/;function $k(n){let e=n.match(Uk);return e?e[0]:""}var vg=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new we([],{}):new we([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[oe]=new we(e,t)),r}parseSegment(){let e=dg(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new X(4009,!1);return this.capture(e),new pi(Sl(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Vk(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=dg(this.remaining);i&&(r=i,this.capture(r))}e[Sl(t)]=Sl(r)}parseQueryParam(e){let t=Bk(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=$k(this.remaining);s&&(r=s,this.capture(r))}let i=DC(t),o=DC(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=dg(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new X(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=oe);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[oe]:new we([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new X(4011,!1)}};function BC(n){return n.segments.length>0?new we([],{[oe]:n}):n}function UC(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=UC(i);if(r===oe&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new we(n.segments,e);return Hk(t)}function Hk(n){if(n.numberOfChildren===1&&n.children[oe]){let e=n.children[oe];return new we(n.segments.concat(e.segments),e.children)}return n}function Aa(n){return n instanceof Gn}function qk(n,e,t=null,r=null){let i=$C(n);return HC(i,e,t,r)}function $C(n){let e;function t(o){let s={};for(let c of o.children){let l=t(c);s[c.outlet]=l}let a=new we(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=BC(r);return e??i}function HC(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return hg(i,i,i,t,r);let o=zk(e);if(o.toRoot())return hg(i,i,new we([],{}),t,r);let s=Gk(o,i,n),a=s.processChildren?Ta(s.segmentGroup,s.index,o.commands):zC(s.segmentGroup,s.index,o.commands);return hg(i,s.segmentGroup,a,t,r)}function Al(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function xa(n){return typeof n=="object"&&n!=null&&n.outlets}function hg(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let s;n===e?s=t:s=qC(n,e,t);let a=BC(UC(s));return new Gn(a,o,i)}function qC(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=qC(o,e,t)}),new we(n.segments,r)}var xl=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Al(r[0]))throw new X(4003,!1);let i=r.find(xa);if(i&&i!==PC(r))throw new X(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function zk(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new xl(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new xl(t,e,r)}var So=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function Gk(n,e,t){if(n.isAbsolute)return new So(e,!0,0);if(!t)return new So(e,!1,NaN);if(t.parent===null)return new So(t,!0,0);let r=Al(n.commands[0])?0:1,i=t.segments.length-1+r;return Wk(t,i,n.numberOfDoubleDots)}function Wk(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new X(4005,!1);i=r.segments.length}return new So(r,!1,i-o)}function Kk(n){return xa(n[0])?n[0].outlets:{[oe]:n}}function zC(n,e,t){if(n??=new we([],{}),n.segments.length===0&&n.hasChildren())return Ta(n,e,t);let r=Qk(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new we(n.segments.slice(0,r.pathIndex),{});return o.children[oe]=new we(n.segments.slice(r.pathIndex),n.children),Ta(o,0,i)}else return r.match&&i.length===0?new we(n.segments,{}):r.match&&!n.hasChildren()?wg(n,e,t):r.match?Ta(n,0,i):wg(n,e,t)}function Ta(n,e,t){if(t.length===0)return new we(n.segments,{});{let r=Kk(t),i={};if(Object.keys(r).some(o=>o!==oe)&&n.children[oe]&&n.numberOfChildren===1&&n.children[oe].segments.length===0){let o=Ta(n.children[oe],e,t);return new we(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=zC(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new we(n.segments,i)}}function Qk(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(xa(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!TC(c,l,s))return o;r+=2}else{if(!TC(c,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function wg(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(xa(o)){let c=Yk(o.outlets);return new we(r,c)}if(i===0&&Al(t[0])){let c=n.segments[e];r.push(new pi(c.path,CC(t[0]))),i++;continue}let s=xa(o)?o.outlets[oe]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&Al(a)?(r.push(new pi(s,CC(a))),i+=2):(r.push(new pi(s,{})),i++)}return new we(r,{})}function Yk(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=wg(new we([],{}),0,r))}),e}function CC(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function TC(n,e,t){return n==t.path&&In(e,t.parameters)}var ba="imperative",nt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(nt||{}),Kt=class{constructor(e,t){this.id=e,this.url=t}},No=class extends Kt{constructor(e,t,r="imperative",i=null){super(e,t),this.type=nt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Wn=class extends Kt{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=nt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Lt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Lt||{}),Rl=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Rl||{}),zn=class extends Kt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=nt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Cr=class extends Kt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=nt.NavigationSkipped}},Ra=class extends Kt{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=nt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ml=class extends Kt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=nt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_g=class extends Kt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=nt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ig=class extends Kt{constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=nt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Eg=class extends Kt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=nt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Dg=class extends Kt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=nt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Cg=class{constructor(e){this.route=e,this.type=nt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Tg=class{constructor(e){this.route=e,this.type=nt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},bg=class{constructor(e){this.snapshot=e,this.type=nt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Sg=class{constructor(e){this.snapshot=e,this.type=nt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ag=class{constructor(e){this.snapshot=e,this.type=nt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xg=class{constructor(e){this.snapshot=e,this.type=nt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Nl=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=nt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Ma=class{},Po=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function Zk(n,e){return n.providers&&!n._injector&&(n._injector=fl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function on(n){return n.outlet||oe}function Jk(n,e){let t=n.filter(r=>on(r)===e);return t.push(...n.filter(r=>on(r)!==e)),t}function Va(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Rg=class{get injector(){return Va(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new ja(this.rootInjector),this.attachRef=null}},ja=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Rg(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)(O(Ot))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Pl=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Mg(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Mg(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Ng(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Ng(e,this._root).map(t=>t.value)}};function Mg(n,e){if(n===e.value)return e;for(let t of e.children){let r=Mg(n,t);if(r)return r}return null}function Ng(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Ng(n,t);if(r.length)return r.unshift(e),r}return[]}var Ft=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function bo(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var kl=class extends Pl{constructor(e,t){super(e),this.snapshot=t,Ug(this,e)}toString(){return this.snapshot.toString()}};function GC(n){let e=Xk(n),t=new it([new pi("",{})]),r=new it({}),i=new it({}),o=new it({}),s=new it(""),a=new ko(t,r,o,s,i,oe,n,e.root);return a.snapshot=e.root,new kl(new Ft(a,[]),e)}function Xk(n){let e={},t={},r={},i="",o=new Ao([],e,r,i,t,oe,n,null,{});return new Fl("",new Ft(o,[]))}var ko=class{constructor(e,t,r,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(J(l=>l[Fa]))??Z(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(J(e=>Ro(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(J(e=>Ro(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ol(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:$($({},e.params),n.params),data:$($({},e.data),n.data),resolve:$($($($({},n.data),e.data),i?.data),n._resolvedData)}:r={params:$({},n.params),data:$({},n.data),resolve:$($({},n.data),n._resolvedData??{})},i&&KC(i)&&(r.resolve[Fa]=i.title),r}var Ao=class{get title(){return this.data?.[Fa]}constructor(e,t,r,i,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ro(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ro(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Fl=class extends Pl{constructor(e,t){super(t),this.url=e,Ug(this,t)}toString(){return WC(this._root)}};function Ug(n,e){e.value._routerState=n,e.children.forEach(t=>Ug(n,t))}function WC(n){let e=n.children.length>0?` { ${n.children.map(WC).join(", ")} } `:"";return`${n.value}${e}`}function fg(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,In(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),In(e.params,t.params)||n.paramsSubject.next(t.params),bk(e.url,t.url)||n.urlSubject.next(t.url),In(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Pg(n,e){let t=In(n.params,e.params)&&Rk(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Pg(n.parent,e.parent))}function KC(n){return typeof n.title=="string"||n.title===null}var e1=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=oe,this.activateEvents=new wt,this.deactivateEvents=new wt,this.attachEvents=new wt,this.detachEvents=new wt,this.parentContexts=V(ja),this.location=V(hl),this.changeDetector=V(va),this.inputBinder=V(Ul,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new X(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new X(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new X(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new X(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new kg(t,a,i.injector);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=mp({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[il]})}}return n})(),kg=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===ko?this.route:e===ja?this.childContexts:this.parent.get(e,t)}},Ul=new z(""),bC=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Zs([r.queryParams,r.params,r.data]).pipe(Ve(([o,s,a],c)=>(a=$($($({},o),s),a),c===0?Z(a):Promise.resolve(a)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let s=XD(r.component);if(!s){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of s.inputs)t.activatedComponentRef.setInput(a,o[a])});this.outletDataSubscriptions.set(t,i)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})();function t1(n,e,t){let r=Na(n,e._root,t?t._root:void 0);return new kl(r,e)}function Na(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=n1(n,e,t);return new Ft(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Na(n,a)),s}}let r=r1(e.value),i=e.children.map(o=>Na(n,o));return new Ft(r,i)}}function n1(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Na(n,r,i);return Na(n,r)})}function r1(n){return new ko(new it(n.url),new it(n.params),new it(n.queryParams),new it(n.fragment),new it(n.data),n.outlet,n.component,n)}var Pa=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},QC="ngNavigationCancelingError";function Ll(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Aa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=YC(!1,Lt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function YC(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[QC]=!0,t.cancellationCode=e,t}function i1(n){return ZC(n)&&Aa(n.url)}function ZC(n){return!!n&&n[QC]}var o1=(n,e,t,r)=>J(i=>(new Og(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Og=class{constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),fg(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=bo(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=bo(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=bo(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=bo(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new xg(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Sg(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(fg(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),fg(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},Vl=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},xo=class{constructor(e,t){this.component=e,this.route=t}};function s1(n,e,t){let r=n._root,i=e?e._root:null;return Da(r,i,t,[r.value])}function a1(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Fo(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!BI(n)?n:e.get(n):r}function Da(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=bo(e);return n.children.forEach(s=>{u1(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Sa(a,t.getContext(s),i)),i}function u1(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=c1(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Vl(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Da(n,e,a?a.children:null,r,i):Da(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new xo(a.outlet.component,s))}else s&&Sa(e,a,i),i.canActivateChecks.push(new Vl(r)),o.component?Da(n,null,a?a.children:null,r,i):Da(n,null,t,r,i);return i}function c1(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!gi(n.url,e.url);case"pathParamsOrQueryParamsChange":return!gi(n.url,e.url)||!In(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Pg(n,e)||!In(n.queryParams,e.queryParams);case"paramsChange":default:return!Pg(n,e)}}function Sa(n,e,t){let r=bo(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Sa(s,e.children.getContext(o),t):Sa(s,null,t):Sa(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new xo(e.outlet.component,i)):t.canDeactivateChecks.push(new xo(null,i)):t.canDeactivateChecks.push(new xo(null,i))}function Ba(n){return typeof n=="function"}function l1(n){return typeof n=="boolean"}function d1(n){return n&&Ba(n.canLoad)}function h1(n){return n&&Ba(n.canActivate)}function f1(n){return n&&Ba(n.canActivateChild)}function p1(n){return n&&Ba(n.canDeactivate)}function g1(n){return n&&Ba(n.canMatch)}function JC(n){return n instanceof Fn||n?.name==="EmptyError"}var Cl=Symbol("INITIAL_VALUE");function Oo(){return Ve(n=>Zs(n.map(e=>e.pipe(Ln(1),ri(Cl)))).pipe(J(e=>{for(let t of e)if(t!==!0){if(t===Cl)return Cl;if(t===!1||m1(t))return t}return!0}),ot(e=>e!==Cl),Ln(1)))}function m1(n){return Aa(n)||n instanceof Pa}function y1(n,e){return ze(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?Z(Te($({},t),{guardsResult:!0})):v1(s,r,i,n).pipe(ze(a=>a&&l1(a)?w1(r,o,n,e):Z(a)),J(a=>Te($({},t),{guardsResult:a})))})}function v1(n,e,t,r){return ye(n).pipe(ze(i=>C1(i.component,i.route,t,e,r)),Ut(i=>i!==!0,!0))}function w1(n,e,t,r){return ye(e).pipe(ti(i=>io(I1(i.route.parent,r),_1(i.route,r),D1(n,i.path,t),E1(n,i.route,t))),Ut(i=>i!==!0,!0))}function _1(n,e){return n!==null&&e&&e(new Ag(n)),Z(!0)}function I1(n,e){return n!==null&&e&&e(new bg(n)),Z(!0)}function E1(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Z(!0);let i=r.map(o=>vc(()=>{let s=Va(e)??t,a=Fo(o,s),c=h1(a)?a.canActivate(e,n):wn(s,()=>a(e,n));return Tr(c).pipe(Ut())}));return Z(i).pipe(Oo())}function D1(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>a1(s)).filter(s=>s!==null).map(s=>vc(()=>{let a=s.guards.map(c=>{let l=Va(s.node)??t,h=Fo(c,l),p=f1(h)?h.canActivateChild(r,n):wn(l,()=>h(r,n));return Tr(p).pipe(Ut())});return Z(a).pipe(Oo())}));return Z(o).pipe(Oo())}function C1(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return Z(!0);let s=o.map(a=>{let c=Va(e)??i,l=Fo(a,c),h=p1(l)?l.canDeactivate(n,e,t,r):wn(c,()=>l(n,e,t,r));return Tr(h).pipe(Ut())});return Z(s).pipe(Oo())}function T1(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return Z(!0);let o=i.map(s=>{let a=Fo(s,n),c=d1(a)?a.canLoad(e,t):wn(n,()=>a(e,t));return Tr(c)});return Z(o).pipe(Oo(),XC(r))}function XC(n){return lf(Ye(e=>{if(typeof e!="boolean")throw Ll(n,e)}),J(e=>e===!0))}function b1(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return Z(!0);let o=i.map(s=>{let a=Fo(s,n),c=g1(a)?a.canMatch(e,t):wn(n,()=>a(e,t));return Tr(c)});return Z(o).pipe(Oo(),XC(r))}var ka=class{constructor(e){this.segmentGroup=e||null}},Oa=class extends Error{constructor(e){super(),this.urlTree=e}};function To(n){return ro(new ka(n))}function S1(n){return ro(new X(4e3,!1))}function A1(n){return ro(YC(!1,Lt.GuardRejected))}var Fg=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Z(r);if(i.numberOfChildren>1||!i.children[oe])return S1(`${e.redirectTo}`);i=i.children[oe]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:c,fragment:l,routeConfig:h,url:p,outlet:m,params:v,data:b,title:M}=i,N=wn(o,()=>a({params:v,data:b,queryParams:c,fragment:l,routeConfig:h,url:p,outlet:m,title:M}));if(N instanceof Gn)throw new Oa(N);t=N}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Oa(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new Gn(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,r,i)}),new we(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new X(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Lg={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function x1(n,e,t,r,i){let o=eT(n,e,t);return o.matched?(r=Zk(e,r),b1(r,e,t,i).pipe(J(s=>s===!0?o:$({},Lg)))):Z(o)}function eT(n,e,t){if(e.path==="**")return R1(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?$({},Lg):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Tk)(t,n,e);if(!i)return $({},Lg);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?$($({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function R1(n){return{matched:!0,parameters:n.length>0?PC(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function SC(n,e,t,r){return t.length>0&&P1(n,t,r)?{segmentGroup:new we(e,N1(r,new we(t,n.children))),slicedSegments:[]}:t.length===0&&k1(n,t,r)?{segmentGroup:new we(n.segments,M1(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new we(n.segments,n.children),slicedSegments:t}}function M1(n,e,t,r){let i={};for(let o of t)if($l(n,e,o)&&!r[on(o)]){let s=new we([],{});i[on(o)]=s}return $($({},r),i)}function N1(n,e){let t={};t[oe]=e;for(let r of n)if(r.path===""&&on(r)!==oe){let i=new we([],{});t[on(r)]=i}return t}function P1(n,e,t){return t.some(r=>$l(n,e,r)&&on(r)!==oe)}function k1(n,e,t){return t.some(r=>$l(n,e,r))}function $l(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function O1(n,e,t){return e.length===0&&!n.children[t]}var Vg=class{};function F1(n,e,t,r,i,o,s="emptyOnly"){return new jg(n,e,t,r,i,s,o).recognize()}var L1=31,jg=class{constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Fg(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new X(4002,`'${e.segmentGroup}'`)}recognize(){let e=SC(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(J(({children:t,rootSnapshot:r})=>{let i=new Ft(r,t),o=new Fl("",i),s=qk(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new Ao([],Object.freeze({}),Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),oe,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,oe,t).pipe(J(r=>({children:r,rootSnapshot:t})),lr(r=>{if(r instanceof Oa)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ka?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(J(s=>s instanceof Ft?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return ye(o).pipe(ti(s=>{let a=r.children[s],c=Jk(t,s);return this.processSegmentGroup(e,c,a,s,i)}),ni((s,a)=>(s.push(...a),s)),dr(null),_f(),ze(s=>{if(s===null)return To(r);let a=tT(s);return V1(a),Z(a)}))}processSegment(e,t,r,i,o,s,a){return ye(t).pipe(ti(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,o,s,a).pipe(lr(l=>{if(l instanceof ka)return Z(null);throw l}))),Ut(c=>!!c),lr(c=>{if(JC(c))return O1(r,i,o)?Z(new Vg):To(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,c){return on(r)!==s&&(s===oe||!$l(i,o,r))?To(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,c):To(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:c,parameters:l,consumedSegments:h,positionalParamSegments:p,remainingSegments:m}=eT(t,i,o);if(!c)return To(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>L1&&(this.allowRedirects=!1));let v=new Ao(o,l,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,AC(i),on(i),i.component??i._loadedComponent??null,i,xC(i)),b=Ol(v,a,this.paramsInheritanceStrategy);v.params=Object.freeze(b.params),v.data=Object.freeze(b.data);let M=this.applyRedirects.applyRedirectCommands(h,i.redirectTo,p,v,e);return this.applyRedirects.lineralizeSegments(i,M).pipe(ze(N=>this.processSegment(e,r,t,N.concat(m),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=x1(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Ve(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ve(({routes:l})=>{let h=r._loadedInjector??e,{parameters:p,consumedSegments:m,remainingSegments:v}=c,b=new Ao(m,p,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,AC(r),on(r),r.component??r._loadedComponent??null,r,xC(r)),M=Ol(b,s,this.paramsInheritanceStrategy);b.params=Object.freeze(M.params),b.data=Object.freeze(M.data);let{segmentGroup:N,slicedSegments:j}=SC(t,m,v,l);if(j.length===0&&N.hasChildren())return this.processChildren(h,l,N,b).pipe(J(F=>new Ft(b,F)));if(l.length===0&&j.length===0)return Z(new Ft(b,[]));let H=on(r)===o;return this.processSegment(h,l,N,j,H?oe:o,!0,b).pipe(J(F=>new Ft(b,F instanceof Ft?[F]:[])))}))):To(t)))}getChildConfig(e,t,r){return t.children?Z({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Z({routes:t._loadedRoutes,injector:t._loadedInjector}):T1(e,t,r,this.urlSerializer).pipe(ze(i=>i?this.configLoader.loadChildren(e,t).pipe(Ye(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):A1(t))):Z({routes:[],injector:e})}};function V1(n){n.sort((e,t)=>e.value.outlet===oe?-1:t.value.outlet===oe?1:e.value.outlet.localeCompare(t.value.outlet))}function j1(n){let e=n.value.routeConfig;return e&&e.path===""}function tT(n){let e=[],t=new Set;for(let r of n){if(!j1(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=tT(r.children);e.push(new Ft(r.value,i))}return e.filter(r=>!t.has(r))}function AC(n){return n.data||{}}function xC(n){return n.resolve||{}}function B1(n,e,t,r,i,o){return ze(s=>F1(n,e,t,r,s.extractedUrl,i,o).pipe(J(({state:a,tree:c})=>Te($({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function U1(n,e){return ze(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Z(t);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let l of nT(c))s.add(l);let a=0;return ye(s).pipe(ti(c=>o.has(c)?$1(c,r,n,e):(c.data=Ol(c,c.parent,n).resolve,Z(void 0))),Ye(()=>a++),oo(1),ze(c=>a===s.size?Z(t):vt))})}function nT(n){let e=n.children.map(t=>nT(t)).flat();return[n,...e]}function $1(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!KC(i)&&(o[Fa]=i.title),H1(o,n,e,r).pipe(J(s=>(n._resolvedData=s,n.data=Ol(n,n.parent,t).resolve,null)))}function H1(n,e,t,r){let i=mg(n);if(i.length===0)return Z({});let o={};return ye(i).pipe(ze(s=>q1(n[s],e,t,r).pipe(Ut(),Ye(a=>{if(a instanceof Pa)throw Ll(new Mo,a);o[s]=a}))),oo(1),vf(o),lr(s=>JC(s)?vt:ro(s)))}function q1(n,e,t,r){let i=Va(e)??r,o=Fo(n,i),s=o.resolve?o.resolve(e,t):wn(i,()=>o(e,t));return Tr(s)}function pg(n){return Ve(e=>{let t=n(e);return t?ye(t).pipe(J(()=>e)):Z(e)})}var rT=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===oe);return r}getResolvedTitleForRoute(t){return t.data[Fa]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>V(z1),providedIn:"root"})}}return n})(),z1=(()=>{class n extends rT{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(O(_C))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ua=new z("",{providedIn:"root",factory:()=>({})}),G1=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=tt({type:n,selectors:[["ng-component"]],standalone:!0,features:[$D],decls:1,vars:0,template:function(r,i){r&1&&st(0,"router-outlet")},dependencies:[e1],encapsulation:2})}}return n})();function $g(n){let e=n.children&&n.children.map($g),t=e?Te($({},n),{children:e}):$({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==oe&&(t.component=G1),t}var jl=new z(""),Hg=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=V(vl)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Z(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Tr(t.loadComponent()).pipe(J(iT),Ye(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),Js(()=>{this.componentLoaders.delete(t)})),i=new Xi(r,()=>new Be).pipe(Ji());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Z({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=W1(r,this.compiler,t,this.onLoadEndListener).pipe(Js(()=>{this.childrenLoaders.delete(r)})),s=new Xi(o,()=>new Be).pipe(Ji());return this.childrenLoaders.set(r,s),s}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function W1(n,e,t,r){return Tr(n.loadChildren()).pipe(J(iT),ze(i=>i instanceof la||Array.isArray(i)?Z(i):ye(e.compileModuleAsync(i))),J(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(jl,[],{optional:!0,self:!0}).flat()),{routes:s.map($g),injector:o}}))}function K1(n){return n&&typeof n=="object"&&"default"in n}function iT(n){return K1(n)?n.default:n}var qg=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>V(Q1),providedIn:"root"})}}return n})(),Q1=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),oT=new z(""),sT=new z("");function Y1(n,e,t){let r=n.get(sT),i=n.get(xt);return n.get(he).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let o,s=new Promise(l=>{o=l}),a=i.startViewTransition(()=>(o(),Z1(n))),{onViewTransitionCreated:c}=r;return c&&wn(n,()=>c({transition:a,from:e,to:t})),s})}function Z1(n){return new Promise(e=>{Hp({read:()=>setTimeout(e)},{injector:n})})}var J1=new z(""),zg=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Be,this.transitionAbortSubject=new Be,this.configLoader=V(Hg),this.environmentInjector=V(Ot),this.urlSerializer=V(La),this.rootContexts=V(ja),this.location=V(Co),this.inputBindingEnabled=V(Ul,{optional:!0})!==null,this.titleStrategy=V(rT),this.options=V(Ua,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=V(qg),this.createViewTransition=V(oT,{optional:!0}),this.navigationErrorHandler=V(J1,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Z(void 0),this.rootComponentType=null;let t=i=>this.events.next(new Cg(i)),r=i=>this.events.next(new Tg(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Te($($({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new it({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:ba,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ot(o=>o.id!==0),J(o=>Te($({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ve(o=>{let s=!1,a=!1;return Z(o).pipe(Ve(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Lt.SupersededByNewNavigation),vt;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Te($({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&h!=="reload"){let p="";return this.events.next(new Cr(c.id,this.urlSerializer.serialize(c.rawUrl),p,Rl.IgnoredSameUrlNavigation)),c.resolve(!1),vt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Z(c).pipe(Ve(p=>{let m=this.transitions?.getValue();return this.events.next(new No(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),m!==this.transitions?.getValue()?vt:Promise.resolve(p)}),B1(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Ye(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=Te($({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let m=new Ml(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:p,extractedUrl:m,source:v,restoredState:b,extras:M}=c,N=new No(p,this.urlSerializer.serialize(m),v,b);this.events.next(N);let j=GC(this.rootComponentType).snapshot;return this.currentTransition=o=Te($({},c),{targetSnapshot:j,urlAfterRedirects:m,extras:Te($({},M),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=m,Z(o)}else{let p="";return this.events.next(new Cr(c.id,this.urlSerializer.serialize(c.extractedUrl),p,Rl.IgnoredByUrlHandlingStrategy)),c.resolve(!1),vt}}),Ye(c=>{let l=new _g(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),J(c=>(this.currentTransition=o=Te($({},c),{guards:s1(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),y1(this.environmentInjector,c=>this.events.next(c)),Ye(c=>{if(o.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw Ll(this.urlSerializer,c.guardsResult);let l=new Ig(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),ot(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Lt.GuardRejected),!1)),pg(c=>{if(c.guards.canActivateChecks.length)return Z(c).pipe(Ye(l=>{let h=new Eg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),Ve(l=>{let h=!1;return Z(l).pipe(U1(this.paramsInheritanceStrategy,this.environmentInjector),Ye({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(l,"",Lt.NoDataFromResolver)}}))}),Ye(l=>{let h=new Dg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}))}),pg(c=>{let l=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(Ye(m=>{h.component=m}),J(()=>{})));for(let m of h.children)p.push(...l(m));return p};return Zs(l(c.targetSnapshot.root)).pipe(dr(null),Ln(1))}),pg(()=>this.afterPreactivation()),Ve(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,h=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return h?ye(h).pipe(J(()=>o)):Z(o)}),J(c=>{let l=t1(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=Te($({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),Ye(()=>{this.events.next(new Ma)}),o1(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Ln(1),Ye({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Wn(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),Ef(this.transitionAbortSubject.pipe(Ye(c=>{throw c}))),Js(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",Lt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),lr(c=>{if(a=!0,ZC(c))this.events.next(new zn(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),i1(c)?this.events.next(new Po(c.url,c.navigationBehaviorOptions)):o.resolve(!1);else{let l=new Ra(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0);try{let h=wn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(h instanceof Pa){let{message:p,cancellationCode:m}=Ll(this.urlSerializer,h);this.events.next(new zn(o.id,this.urlSerializer.serialize(o.extractedUrl),p,m)),this.events.next(new Po(h.redirectTo,h.navigationBehaviorOptions))}else{this.events.next(l);let p=t.errorHandler(c);o.resolve(!!p)}}catch(h){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(h)}}return vt}))}))}cancelNavigationTransition(t,r,i){let o=new zn(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function X1(n){return n!==ba}var eO=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>V(tO),providedIn:"root"})}}return n})(),Bg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},tO=(()=>{class n extends Bg{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Cp(n)))(i||n)}})()}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),aT=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>V(nO),providedIn:"root"})}}return n})(),nO=(()=>{class n extends aT{constructor(){super(...arguments),this.location=V(Co),this.urlSerializer=V(La),this.options=V(Ua,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=V(qg),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Gn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=GC(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof No)this.stateMemento=this.createStateMemento();else if(t instanceof Cr)this.rawUrlTree=r.initialUrl;else if(t instanceof Ml){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Ma?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof zn&&(t.code===Lt.GuardRejected||t.code===Lt.NoDataFromResolver)?this.restoreHistory(r):t instanceof Ra?this.restoreHistory(r,!0):t instanceof Wn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof Gn?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,s=$($({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",s)}else{let o=$($({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Cp(n)))(i||n)}})()}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ca=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Ca||{});function uT(n,e){n.events.pipe(ot(t=>t instanceof Wn||t instanceof zn||t instanceof Ra||t instanceof Cr),J(t=>t instanceof Wn||t instanceof Cr?Ca.COMPLETE:(t instanceof zn?t.code===Lt.Redirect||t.code===Lt.SupersededByNewNavigation:!1)?Ca.REDIRECTING:Ca.FAILED),ot(t=>t!==Ca.REDIRECTING),Ln(1)).subscribe(()=>{e()})}function rO(n){throw n}var iO={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},oO={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},mi=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=V(pl),this.stateManager=V(aT),this.options=V(Ua,{optional:!0})||{},this.pendingTasks=V(Do),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=V(zg),this.urlSerializer=V(La),this.location=V(Co),this.urlHandlingStrategy=V(qg),this._events=new Be,this.errorHandler=this.options.errorHandler||rO,this.navigated=!1,this.routeReuseStrategy=V(eO),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=V(jl,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!V(Ul,{optional:!0}),this.eventsSubscription=new Le,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof zn&&r.code!==Lt.Redirect&&r.code!==Lt.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Wn)this.navigated=!0;else if(r instanceof Po){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=$({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||X1(i.source)},s);this.scheduleNavigation(a,ba,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}aO(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ba,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let c=$({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map($g),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:s,h=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":h=$($({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let m=i?i.snapshot:this.routerState.snapshot.root;p=$C(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return HC(p,t,h,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Aa(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,ba,null,r)}navigate(t,r={skipLocationChange:!1}){return sO(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=$({},iO):r===!1?i=$({},oO):i=r,Aa(t))return EC(this.currentUrlTree,t,i);let o=this.parseUrl(t);return EC(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,l;s?(a=s.resolve,c=s.reject,l=s.promise):l=new Promise((p,m)=>{a=p,c=m});let h=this.pendingTasks.add();return uT(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function sO(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new X(4008,!1)}function aO(n){return!(n instanceof Ma)&&!(n instanceof Po)}var Bl=class{};var uO=(()=>{class n{constructor(t,r,i,o,s){this.router=t,this.injector=i,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(ot(t=>t instanceof Wn),ti(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let o of r){o.providers&&!o._injector&&(o._injector=fl(o.providers,t,`Route: ${o.path}`));let s=o._injector??t,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(a,o.children??o._loadedRoutes))}return ye(i).pipe(cr())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=Z(null);let o=i.pipe(ze(s=>s===null?Z(void 0):(r._loadedRoutes=s.routes,r._loadedInjector=s.injector,this.processRoutes(s.injector??t,s.routes))));if(r.loadComponent&&!r._loadedComponent){let s=this.loader.loadComponent(r);return ye([o,s]).pipe(cr())}else return o})}static{this.\u0275fac=function(r){return new(r||n)(O(mi),O(vl),O(Ot),O(Bl),O(Hg))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),cT=new z(""),cO=(()=>{class n{constructor(t,r,i,o,s={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=o,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof No?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Wn?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Cr&&t.code===Rl.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Nl&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Nl(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){wD()}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})();function lO(n){return n.routerState.root}function $a(n,e){return{\u0275kind:n,\u0275providers:e}}function dO(){let n=V(Wt);return e=>{let t=n.get(Dr);if(e!==t.components[0])return;let r=n.get(mi),i=n.get(lT);n.get(Gg)===1&&r.initialNavigation(),n.get(dT,null,ae.Optional)?.setUpPreloading(),n.get(cT,null,ae.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var lT=new z("",{factory:()=>new Be}),Gg=new z("",{providedIn:"root",factory:()=>1});function hO(){return $a(2,[{provide:Gg,useValue:0},{provide:yl,multi:!0,deps:[Wt],useFactory:e=>{let t=e.get(oC,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(mi),o=e.get(lT);uT(i,()=>{r(!0)}),e.get(zg).afterPreactivation=()=>(r(!0),o.closed?Z(void 0):o),i.initialNavigation()}))}}])}function fO(){return $a(3,[{provide:yl,multi:!0,useFactory:()=>{let e=V(mi);return()=>{e.setUpLocationChangeListener()}}},{provide:Gg,useValue:2}])}var dT=new z("");function pO(n){return $a(0,[{provide:dT,useExisting:uO},{provide:Bl,useExisting:n}])}function gO(){return $a(8,[bC,{provide:Ul,useExisting:bC}])}function mO(n){let e=[{provide:oT,useValue:Y1},{provide:sT,useValue:$({skipNextTransition:!!n?.skipInitialTransition},n)}];return $a(9,e)}var RC=new z("ROUTER_FORROOT_GUARD"),yO=[Co,{provide:La,useClass:Mo},mi,ja,{provide:ko,useFactory:lO,deps:[mi]},Hg,[]],Wg=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[yO,[],{provide:jl,multi:!0,useValue:t},{provide:RC,useFactory:IO,deps:[[mi,new ha,new WI]]},{provide:Ua,useValue:r||{}},r?.useHash?wO():_O(),vO(),r?.preloadingStrategy?pO(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?EO(r):[],r?.bindToComponentInputs?gO().\u0275providers:[],r?.enableViewTransitions?mO().\u0275providers:[],DO()]}}static forChild(t){return{ngModule:n,providers:[{provide:jl,multi:!0,useValue:t}]}}static{this.\u0275fac=function(r){return new(r||n)(O(RC,8))}}static{this.\u0275mod=Dt({type:n})}static{this.\u0275inj=Et({})}}return n})();function vO(){return{provide:cT,useFactory:()=>{let n=V(lC),e=V(he),t=V(Ua),r=V(zg),i=V(La);return t.scrollOffset&&n.setOffset(t.scrollOffset),new cO(i,r,n,e,t)}}}function wO(){return{provide:hi,useClass:aC}}function _O(){return{provide:hi,useClass:tg}}function IO(n){return"guarded"}function EO(n){return[n.initialNavigation==="disabled"?fO().\u0275providers:[],n.initialNavigation==="enabledBlocking"?hO().\u0275providers:[]]}var MC=new z("");function DO(){return[{provide:MC,useFactory:dO},{provide:Wp,multi:!0,useExisting:MC}]}var CO=[],hT=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Dt({type:n})}static{this.\u0275inj=Et({imports:[Wg.forRoot(CO),Wg]})}}return n})();var TO="firebase",bO="10.14.1";ur(TO,bO,"app");var Ha=new wr("ANGULARFIRE2_VERSION");var SO=(n,e)=>{let t=e?[e]:T_(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},yi=class{constructor(){return SO(AO)}},AO="app-check";function Kg(){}var Hl=class{zone;delegate;constructor(e,t=pf){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i.runGuarded(()=>{e.apply(this,[s])})};return this.delegate.schedule(o,t,r)}},Qg=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Kg,{},Kg,Kg)),t.pipe(Ye({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ql=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Hl(Zone.current)),this.insideAngular=t.run(()=>new Hl(Zone.current,Ys)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(O(he))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xO(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Rt(n){return RO(xO())(n)}function RO(n){return function(t){return t=t.lift(new Qg(n.ngZone)),t.pipe(en(n.outsideAngular),Bt(n.insideAngular))}}var PO=new Map,kO={activated:!1,tokenObservers:[]},OO={initialized:!1,enabled:!1};function sn(n){return PO.get(n)||Object.assign({},kO)}function vT(){return OO}var FO="https://content-firebaseappcheck.googleapis.com/v1";var LO="exchangeDebugToken",pT={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},uz=24*60*60*1e3;var Zg=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return R(this,null,function*(){this.stop();try{this.pending=new Gh,this.pending.promise.catch(t=>{}),yield VO(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Gh,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function VO(n){return new Promise(e=>{setTimeout(e,n)})}var jO={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},br=new D_("appCheck","AppCheck",jO);function wT(n){if(!sn(n).activated)throw br.create("use-before-activation",{appName:n.name})}function _T(r,i){return R(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let v=yield s.getHeartbeatsHeader();v&&(o["X-Firebase-Client"]=v)}let a={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,a)}catch(v){throw br.create("fetch-network-error",{originalErrorMessage:v?.message})}if(c.status!==200)throw br.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(v){throw br.create("fetch-parse-error",{originalErrorMessage:v?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw br.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let p=Number(h[1])*1e3,m=Date.now();return{token:l.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function IT(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${FO}/projects/${t}/apps/${r}:${LO}?key=${i}`,body:{debug_token:e}}}var BO="firebase-app-check-database",UO=1,Jg="firebase-app-check-store";var zl=null;function $O(){return zl||(zl=new Promise((n,e)=>{try{let t=indexedDB.open(BO,UO);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(br.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Jg,{keyPath:"compositeKey"})}}}catch(t){e(br.create("storage-open",{originalErrorMessage:t?.message}))}}),zl)}function HO(n,e){return qO(zO(n),e)}function qO(n,e){return R(this,null,function*(){let r=(yield $O()).transaction(Jg,"readwrite"),o=r.objectStore(Jg).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var l;a(br.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function zO(n){return`${n.options.appId}-${n.name}`}var Xg=new Ju("@firebase/app-check");function Yg(n,e){return Zu()?HO(n,e).catch(t=>{Xg.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function ET(){return vT().enabled}function DT(){return R(this,null,function*(){let n=vT();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var GO={error:"UNKNOWN_ERROR"};function WO(n){return __.encodeString(JSON.stringify(n),!1)}function em(n,e=!1){return R(this,null,function*(){let t=n.app;wT(t);let r=sn(t),i=r.token,o;if(i&&!qa(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(qa(c)?i=c:yield Yg(t,void 0))}if(!e&&i&&qa(i))return{token:i.token};let s=!1;if(ET()){r.exchangeTokenPromise||(r.exchangeTokenPromise=_T(IT(t,yield DT()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let c=yield r.exchangeTokenPromise;return yield Yg(t,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield sn(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Xg.warn(c.message):Xg.error(c),o=c}let a;return i?o?qa(i)?a={token:i.token,internalError:o}:a=mT(o):(a={token:i.token},r.token=i,yield Yg(t,i)):a=mT(o),s&&ZO(t,a),a})}function KO(n){return R(this,null,function*(){let e=n.app;wT(e);let{provider:t}=sn(e);if(ET()){let r=yield DT(),{token:i}=yield _T(IT(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function QO(n,e,t,r){let{app:i}=n,o=sn(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&qa(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),gT(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>gT(n))}function CT(n,e){let t=sn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function gT(n){let{app:e}=n,t=sn(e),r=t.tokenRefresher;r||(r=YO(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function YO(n){let{app:e}=n;return new Zg(()=>R(this,null,function*(){let t=sn(e),r;if(t.token?r=yield em(n,!0):r=yield em(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=sn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},pT.RETRIAL_MIN_WAIT,pT.RETRIAL_MAX_WAIT)}function ZO(n,e){let t=sn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function qa(n){return n.expireTimeMillis-Date.now()>0}function mT(n){return{token:WO(GO),error:n}}var tm=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=sn(this.app);for(let t of e)CT(this.app,t.next);return Promise.resolve()}};function JO(n,e){return new tm(n,e)}function XO(n){return{getToken:e=>em(n,e),getLimitedUseToken:()=>KO(n),addTokenListener:e=>QO(n,"INTERNAL",e),removeTokenListener:e=>CT(n.app,e)}}var eF="@firebase/app-check",tF="0.8.8";var nF="app-check",yT="app-check-internal";function rF(){Gs(new Zr(nF,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return JO(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(yT).initialize()})),Gs(new Zr(yT,n=>{let e=n.getProvider("app-check").getImmediate();return XO(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),ur(eF,tF)}rF();var iF=["localhost","0.0.0.0","127.0.0.1"],_z=typeof window<"u"&&iF.includes(window.location.hostname);var oF="firebase",sF="10.14.1";Pt.registerVersion(oF,sF,"app-compat");var aF=["ngOnDestroy"],ST=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(aF.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(a=>{let c=a?.[o];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>s[c],apply:(a,c,l)=>s.then(h=>{let p=h?.(...l);return r?.spy?.apply&&r.spy.apply(o,l,p),p})})})});var Gl=class{constructor(e){return e}},Lo=new z("angularfire2.app.options"),Vo=new z("angularfire2.app.name");function za(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=Pt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Pt.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let a=!!module.hot;uF("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Gl(s)}var uF=(n,...e)=>{Yp()&&typeof console<"u"&&console[n](...e)},cF={provide:Gl,useFactory:za,deps:[Lo,he,[new ha,Vo]]},AT=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:Lo,useValue:t},{provide:Vo,useValue:r}]}}constructor(t){Pt.registerVersion("angularfire",Ha.full,"core"),Pt.registerVersion("angularfire",Ha.full,"app-compat"),Pt.registerVersion("angular",HD.full,t.toString())}static \u0275fac=function(r){return new(r||n)(O(At))};static \u0275mod=Dt({type:n});static \u0275inj=Et({providers:[cF]})}return n})();function Wl(n,e,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(o)return lF(i,s)||(bT("error",`${e} was already initialized on the ${t} Firebase App with different settings.${dF?" You may need to reload as Firebase is not HMR aware.":""}`),bT("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function lF(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var dF=typeof module<"u"&&!!module.hot,bT=(n,...e)=>{Yp()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var nm=new z("angularfire2.auth.use-emulator"),rm=new z("angularfire2.auth.settings"),im=new z("angularfire2.auth.tenant-id"),om=new z("angularfire2.auth.langugage-code"),sm=new z("angularfire2.auth.use-device-language"),am=new z("angularfire.auth.persistence"),um=(n,e,t,r,i,o,s,a)=>Wl(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),r&&(c.tenantId=r),c.languageCode=i,o&&c.useDeviceLanguage(),s)for(let[l,h]of Object.entries(s))c.settings[l]=h;return a&&c.setPersistence(a),c},[t,r,i,o,s,a]),xT=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,c,l,h,p,m,v){let b=new Be,M=Z(void 0).pipe(Bt(s.outsideAngular),Ve(()=>o.runOutsideAngular(()=>import("./chunk-DT56ZVVI.js"))),J(()=>za(t,o,r)),J(N=>um(N,o,a,l,h,p,c,m)),_c({bufferSize:1,refCount:!1}));if(fi(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Z(null);else{M.pipe(Ut()).subscribe();let N=M.pipe(Ve(F=>F.getRedirectResult().then(Q=>Q,()=>null)),Rt,_c({bufferSize:1,refCount:!1})),j=M.pipe(Ve(F=>new le(Q=>({unsubscribe:o.runOutsideAngular(()=>F.onAuthStateChanged(ee=>Q.next(ee),ee=>Q.error(ee),()=>Q.complete()))})))),H=M.pipe(Ve(F=>new le(Q=>({unsubscribe:o.runOutsideAngular(()=>F.onIdTokenChanged(ee=>Q.next(ee),ee=>Q.error(ee),()=>Q.complete()))}))));this.authState=N.pipe(Ic(j),en(s.outsideAngular),Bt(s.insideAngular)),this.user=N.pipe(Ic(H),en(s.outsideAngular),Bt(s.insideAngular)),this.idToken=this.user.pipe(Ve(F=>F?ye(F.getIdToken()):Z(null))),this.idTokenResult=this.user.pipe(Ve(F=>F?ye(F.getIdTokenResult()):Z(null))),this.credential=yf(N,b,this.authState.pipe(ot(F=>!F))).pipe(J(F=>F?.user?F:null),en(s.outsideAngular),Bt(s.insideAngular))}return ST(this,M,o,{spy:{apply:(N,j,H)=>{(N.startsWith("signIn")||N.startsWith("createUser"))&&H.then(F=>b.next(F))}}})}static \u0275fac=function(r){return new(r||n)(O(Lo),O(Vo,8),O(At),O(he),O(ql),O(nm,8),O(rm,8),O(im,8),O(om,8),O(sm,8),O(am,8),O(yi,8))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var RT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},MT={};var Sr,cm;(function(){var n;function e(I,y){function _(){}_.prototype=y.prototype,I.D=y.prototype,I.prototype=new _,I.prototype.constructor=I,I.C=function(E,D,T){for(var w=Array(arguments.length-2),Nn=2;Nn<arguments.length;Nn++)w[Nn-2]=arguments[Nn];return y.prototype[D].apply(E,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,y,_){_||(_=0);var E=Array(16);if(typeof y=="string")for(var D=0;16>D;++D)E[D]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(D=0;16>D;++D)E[D]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=I.g[0],_=I.g[1],D=I.g[2];var T=I.g[3],w=y+(T^_&(D^T))+E[0]+3614090360&4294967295;y=_+(w<<7&4294967295|w>>>25),w=T+(D^y&(_^D))+E[1]+3905402710&4294967295,T=y+(w<<12&4294967295|w>>>20),w=D+(_^T&(y^_))+E[2]+606105819&4294967295,D=T+(w<<17&4294967295|w>>>15),w=_+(y^D&(T^y))+E[3]+3250441966&4294967295,_=D+(w<<22&4294967295|w>>>10),w=y+(T^_&(D^T))+E[4]+4118548399&4294967295,y=_+(w<<7&4294967295|w>>>25),w=T+(D^y&(_^D))+E[5]+1200080426&4294967295,T=y+(w<<12&4294967295|w>>>20),w=D+(_^T&(y^_))+E[6]+2821735955&4294967295,D=T+(w<<17&4294967295|w>>>15),w=_+(y^D&(T^y))+E[7]+4249261313&4294967295,_=D+(w<<22&4294967295|w>>>10),w=y+(T^_&(D^T))+E[8]+1770035416&4294967295,y=_+(w<<7&4294967295|w>>>25),w=T+(D^y&(_^D))+E[9]+2336552879&4294967295,T=y+(w<<12&4294967295|w>>>20),w=D+(_^T&(y^_))+E[10]+4294925233&4294967295,D=T+(w<<17&4294967295|w>>>15),w=_+(y^D&(T^y))+E[11]+2304563134&4294967295,_=D+(w<<22&4294967295|w>>>10),w=y+(T^_&(D^T))+E[12]+1804603682&4294967295,y=_+(w<<7&4294967295|w>>>25),w=T+(D^y&(_^D))+E[13]+4254626195&4294967295,T=y+(w<<12&4294967295|w>>>20),w=D+(_^T&(y^_))+E[14]+2792965006&4294967295,D=T+(w<<17&4294967295|w>>>15),w=_+(y^D&(T^y))+E[15]+1236535329&4294967295,_=D+(w<<22&4294967295|w>>>10),w=y+(D^T&(_^D))+E[1]+4129170786&4294967295,y=_+(w<<5&4294967295|w>>>27),w=T+(_^D&(y^_))+E[6]+3225465664&4294967295,T=y+(w<<9&4294967295|w>>>23),w=D+(y^_&(T^y))+E[11]+643717713&4294967295,D=T+(w<<14&4294967295|w>>>18),w=_+(T^y&(D^T))+E[0]+3921069994&4294967295,_=D+(w<<20&4294967295|w>>>12),w=y+(D^T&(_^D))+E[5]+3593408605&4294967295,y=_+(w<<5&4294967295|w>>>27),w=T+(_^D&(y^_))+E[10]+38016083&4294967295,T=y+(w<<9&4294967295|w>>>23),w=D+(y^_&(T^y))+E[15]+3634488961&4294967295,D=T+(w<<14&4294967295|w>>>18),w=_+(T^y&(D^T))+E[4]+3889429448&4294967295,_=D+(w<<20&4294967295|w>>>12),w=y+(D^T&(_^D))+E[9]+568446438&4294967295,y=_+(w<<5&4294967295|w>>>27),w=T+(_^D&(y^_))+E[14]+3275163606&4294967295,T=y+(w<<9&4294967295|w>>>23),w=D+(y^_&(T^y))+E[3]+4107603335&4294967295,D=T+(w<<14&4294967295|w>>>18),w=_+(T^y&(D^T))+E[8]+1163531501&4294967295,_=D+(w<<20&4294967295|w>>>12),w=y+(D^T&(_^D))+E[13]+2850285829&4294967295,y=_+(w<<5&4294967295|w>>>27),w=T+(_^D&(y^_))+E[2]+4243563512&4294967295,T=y+(w<<9&4294967295|w>>>23),w=D+(y^_&(T^y))+E[7]+1735328473&4294967295,D=T+(w<<14&4294967295|w>>>18),w=_+(T^y&(D^T))+E[12]+2368359562&4294967295,_=D+(w<<20&4294967295|w>>>12),w=y+(_^D^T)+E[5]+4294588738&4294967295,y=_+(w<<4&4294967295|w>>>28),w=T+(y^_^D)+E[8]+2272392833&4294967295,T=y+(w<<11&4294967295|w>>>21),w=D+(T^y^_)+E[11]+1839030562&4294967295,D=T+(w<<16&4294967295|w>>>16),w=_+(D^T^y)+E[14]+4259657740&4294967295,_=D+(w<<23&4294967295|w>>>9),w=y+(_^D^T)+E[1]+2763975236&4294967295,y=_+(w<<4&4294967295|w>>>28),w=T+(y^_^D)+E[4]+1272893353&4294967295,T=y+(w<<11&4294967295|w>>>21),w=D+(T^y^_)+E[7]+4139469664&4294967295,D=T+(w<<16&4294967295|w>>>16),w=_+(D^T^y)+E[10]+3200236656&4294967295,_=D+(w<<23&4294967295|w>>>9),w=y+(_^D^T)+E[13]+681279174&4294967295,y=_+(w<<4&4294967295|w>>>28),w=T+(y^_^D)+E[0]+3936430074&4294967295,T=y+(w<<11&4294967295|w>>>21),w=D+(T^y^_)+E[3]+3572445317&4294967295,D=T+(w<<16&4294967295|w>>>16),w=_+(D^T^y)+E[6]+76029189&4294967295,_=D+(w<<23&4294967295|w>>>9),w=y+(_^D^T)+E[9]+3654602809&4294967295,y=_+(w<<4&4294967295|w>>>28),w=T+(y^_^D)+E[12]+3873151461&4294967295,T=y+(w<<11&4294967295|w>>>21),w=D+(T^y^_)+E[15]+530742520&4294967295,D=T+(w<<16&4294967295|w>>>16),w=_+(D^T^y)+E[2]+3299628645&4294967295,_=D+(w<<23&4294967295|w>>>9),w=y+(D^(_|~T))+E[0]+4096336452&4294967295,y=_+(w<<6&4294967295|w>>>26),w=T+(_^(y|~D))+E[7]+1126891415&4294967295,T=y+(w<<10&4294967295|w>>>22),w=D+(y^(T|~_))+E[14]+2878612391&4294967295,D=T+(w<<15&4294967295|w>>>17),w=_+(T^(D|~y))+E[5]+4237533241&4294967295,_=D+(w<<21&4294967295|w>>>11),w=y+(D^(_|~T))+E[12]+1700485571&4294967295,y=_+(w<<6&4294967295|w>>>26),w=T+(_^(y|~D))+E[3]+2399980690&4294967295,T=y+(w<<10&4294967295|w>>>22),w=D+(y^(T|~_))+E[10]+4293915773&4294967295,D=T+(w<<15&4294967295|w>>>17),w=_+(T^(D|~y))+E[1]+2240044497&4294967295,_=D+(w<<21&4294967295|w>>>11),w=y+(D^(_|~T))+E[8]+1873313359&4294967295,y=_+(w<<6&4294967295|w>>>26),w=T+(_^(y|~D))+E[15]+4264355552&4294967295,T=y+(w<<10&4294967295|w>>>22),w=D+(y^(T|~_))+E[6]+2734768916&4294967295,D=T+(w<<15&4294967295|w>>>17),w=_+(T^(D|~y))+E[13]+1309151649&4294967295,_=D+(w<<21&4294967295|w>>>11),w=y+(D^(_|~T))+E[4]+4149444226&4294967295,y=_+(w<<6&4294967295|w>>>26),w=T+(_^(y|~D))+E[11]+3174756917&4294967295,T=y+(w<<10&4294967295|w>>>22),w=D+(y^(T|~_))+E[2]+718787259&4294967295,D=T+(w<<15&4294967295|w>>>17),w=_+(T^(D|~y))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+y&4294967295,I.g[1]=I.g[1]+(D+(w<<21&4294967295|w>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+T&4294967295}r.prototype.u=function(I,y){y===void 0&&(y=I.length);for(var _=y-this.blockSize,E=this.B,D=this.h,T=0;T<y;){if(D==0)for(;T<=_;)i(this,I,T),T+=this.blockSize;if(typeof I=="string"){for(;T<y;)if(E[D++]=I.charCodeAt(T++),D==this.blockSize){i(this,E),D=0;break}}else for(;T<y;)if(E[D++]=I[T++],D==this.blockSize){i(this,E),D=0;break}}this.h=D,this.o+=y},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var y=1;y<I.length-8;++y)I[y]=0;var _=8*this.o;for(y=I.length-8;y<I.length;++y)I[y]=_&255,_/=256;for(this.u(I),I=Array(16),y=_=0;4>y;++y)for(var E=0;32>E;E+=8)I[_++]=this.g[y]>>>E&255;return I};function o(I,y){var _=a;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=y(I)}function s(I,y){this.h=y;for(var _=[],E=!0,D=I.length-1;0<=D;D--){var T=I[D]|0;E&&T==y||(_[D]=T,E=!1)}this.g=_}var a={};function c(I){return-128<=I&&128>I?o(I,function(y){return new s([y|0],0>y?-1:0)}):new s([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return N(l(-I));for(var y=[],_=1,E=0;I>=_;E++)y[E]=I/_|0,_*=4294967296;return new s(y,0)}function h(I,y){if(I.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(I.charAt(0)=="-")return N(h(I.substring(1),y));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=l(Math.pow(y,8)),E=p,D=0;D<I.length;D+=8){var T=Math.min(8,I.length-D),w=parseInt(I.substring(D,D+T),y);8>T?(T=l(Math.pow(y,T)),E=E.j(T).add(l(w))):(E=E.j(_),E=E.add(l(w)))}return E}var p=c(0),m=c(1),v=c(16777216);n=s.prototype,n.m=function(){if(M(this))return-N(this).m();for(var I=0,y=1,_=0;_<this.g.length;_++){var E=this.i(_);I+=(0<=E?E:4294967296+E)*y,y*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(b(this))return"0";if(M(this))return"-"+N(this).toString(I);for(var y=l(Math.pow(I,6)),_=this,E="";;){var D=Q(_,y).g;_=j(_,D.j(y));var T=((0<_.g.length?_.g[0]:_.h)>>>0).toString(I);if(_=D,b(_))return T+E;for(;6>T.length;)T="0"+T;E=T+E}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function b(I){if(I.h!=0)return!1;for(var y=0;y<I.g.length;y++)if(I.g[y]!=0)return!1;return!0}function M(I){return I.h==-1}n.l=function(I){return I=j(this,I),M(I)?-1:b(I)?0:1};function N(I){for(var y=I.g.length,_=[],E=0;E<y;E++)_[E]=~I.g[E];return new s(_,~I.h).add(m)}n.abs=function(){return M(this)?N(this):this},n.add=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],E=0,D=0;D<=y;D++){var T=E+(this.i(D)&65535)+(I.i(D)&65535),w=(T>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);E=w>>>16,T&=65535,w&=65535,_[D]=w<<16|T}return new s(_,_[_.length-1]&-2147483648?-1:0)};function j(I,y){return I.add(N(y))}n.j=function(I){if(b(this)||b(I))return p;if(M(this))return M(I)?N(this).j(N(I)):N(N(this).j(I));if(M(I))return N(this.j(N(I)));if(0>this.l(v)&&0>I.l(v))return l(this.m()*I.m());for(var y=this.g.length+I.g.length,_=[],E=0;E<2*y;E++)_[E]=0;for(E=0;E<this.g.length;E++)for(var D=0;D<I.g.length;D++){var T=this.i(E)>>>16,w=this.i(E)&65535,Nn=I.i(D)>>>16,bs=I.i(D)&65535;_[2*E+2*D]+=w*bs,H(_,2*E+2*D),_[2*E+2*D+1]+=T*bs,H(_,2*E+2*D+1),_[2*E+2*D+1]+=w*Nn,H(_,2*E+2*D+1),_[2*E+2*D+2]+=T*Nn,H(_,2*E+2*D+2)}for(E=0;E<y;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=y;E<2*y;E++)_[E]=0;return new s(_,0)};function H(I,y){for(;(I[y]&65535)!=I[y];)I[y+1]+=I[y]>>>16,I[y]&=65535,y++}function F(I,y){this.g=I,this.h=y}function Q(I,y){if(b(y))throw Error("division by zero");if(b(I))return new F(p,p);if(M(I))return y=Q(N(I),y),new F(N(y.g),N(y.h));if(M(y))return y=Q(I,N(y)),new F(N(y.g),y.h);if(30<I.g.length){if(M(I)||M(y))throw Error("slowDivide_ only works with positive integers.");for(var _=m,E=y;0>=E.l(I);)_=ee(_),E=ee(E);var D=Y(_,1),T=Y(E,1);for(E=Y(E,2),_=Y(_,2);!b(E);){var w=T.add(E);0>=w.l(I)&&(D=D.add(_),T=w),E=Y(E,1),_=Y(_,1)}return y=j(I,D.j(y)),new F(D,y)}for(D=p;0<=I.l(y);){for(_=Math.max(1,Math.floor(I.m()/y.m())),E=Math.ceil(Math.log(_)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),T=l(_),w=T.j(y);M(w)||0<w.l(I);)_-=E,T=l(_),w=T.j(y);b(T)&&(T=m),D=D.add(T),I=j(I,w)}return new F(D,I)}n.A=function(I){return Q(this,I).h},n.and=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],E=0;E<y;E++)_[E]=this.i(E)&I.i(E);return new s(_,this.h&I.h)},n.or=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],E=0;E<y;E++)_[E]=this.i(E)|I.i(E);return new s(_,this.h|I.h)},n.xor=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],E=0;E<y;E++)_[E]=this.i(E)^I.i(E);return new s(_,this.h^I.h)};function ee(I){for(var y=I.g.length+1,_=[],E=0;E<y;E++)_[E]=I.i(E)<<1|I.i(E-1)>>>31;return new s(_,I.h)}function Y(I,y){var _=y>>5;y%=32;for(var E=I.g.length-_,D=[],T=0;T<E;T++)D[T]=0<y?I.i(T+_)>>>y|I.i(T+_+1)<<32-y:I.i(T+_);return new s(D,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,cm=MT.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,Sr=MT.Integer=s}).apply(typeof RT<"u"?RT:typeof self<"u"?self:typeof window<"u"?window:{});var Kl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Kn={};var lm,fF,jo,dm,Ga,Ql,hm,fm,pm;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,d,f){return u==Array.prototype||u==Object.prototype||(u[d]=f.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kl=="object"&&Kl];for(var d=0;d<u.length;++d){var f=u[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(u,d){if(d)e:{var f=r;u=u.split(".");for(var g=0;g<u.length-1;g++){var C=u[g];if(!(C in f))break e;f=f[C]}u=u[u.length-1],g=f[u],d=d(g),d!=g&&d!=null&&e(f,u,{configurable:!0,writable:!0,value:d})}}function o(u,d){u instanceof String&&(u+="");var f=0,g=!1,C={next:function(){if(!g&&f<u.length){var A=f++;return{value:d(A,u[A]),done:!1}}return g=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(u){return u||function(){return o(this,function(d,f){return f})}});var s=s||{},a=this||self;function c(u){var d=typeof u;return d=d!="object"?d:u?Array.isArray(u)?"array":d:"null",d=="array"||d=="object"&&typeof u.length=="number"}function l(u){var d=typeof u;return d=="object"&&u!=null||d=="function"}function h(u,d,f){return u.call.apply(u.bind,arguments)}function p(u,d,f){if(!u)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,g),u.apply(d,C)}}return function(){return u.apply(d,arguments)}}function m(u,d,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function v(u,d){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),u.apply(this,g)}}function b(u,d){function f(){}f.prototype=d.prototype,u.aa=d.prototype,u.prototype=new f,u.prototype.constructor=u,u.Qb=function(g,C,A){for(var L=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)L[Ie-2]=arguments[Ie];return d.prototype[C].apply(g,L)}}function M(u){let d=u.length;if(0<d){let f=Array(d);for(let g=0;g<d;g++)f[g]=u[g];return f}return[]}function N(u,d){for(let f=1;f<arguments.length;f++){let g=arguments[f];if(c(g)){let C=u.length||0,A=g.length||0;u.length=C+A;for(let L=0;L<A;L++)u[C+L]=g[L]}else u.push(g)}}class j{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function H(u){return/^[\s\xa0]*$/.test(u)}function F(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function Q(u){return Q[" "](u),u}Q[" "]=function(){};var ee=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function Y(u,d,f){for(let g in u)d.call(f,u[g],g,u)}function I(u,d){for(let f in u)d.call(void 0,u[f],f,u)}function y(u){let d={};for(let f in u)d[f]=u[f];return d}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(u,d){let f,g;for(let C=1;C<arguments.length;C++){g=arguments[C];for(f in g)u[f]=g[f];for(let A=0;A<_.length;A++)f=_[A],Object.prototype.hasOwnProperty.call(g,f)&&(u[f]=g[f])}}function D(u){var d=1;u=u.split(":");let f=[];for(;0<d&&u.length;)f.push(u.shift()),d--;return u.length&&f.push(u.join(":")),f}function T(u){a.setTimeout(()=>{throw u},0)}function w(){var u=_h;let d=null;return u.g&&(d=u.g,u.g=u.g.next,u.g||(u.h=null),d.next=null),d}class Nn{constructor(){this.h=this.g=null}add(d,f){let g=bs.get();g.set(d,f),this.h?this.h.next=g:this.g=g,this.h=g}}var bs=new j(()=>new EA,u=>u.reset());class EA{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Ss,As=!1,_h=new Nn,mw=()=>{let u=a.Promise.resolve(void 0);Ss=()=>{u.then(DA)}};var DA=()=>{for(var u;u=w();){try{u.h.call(u.g)}catch(f){T(f)}var d=bs;d.j(u),100>d.h&&(d.h++,u.next=d.g,d.g=u)}As=!1};function ir(){this.s=this.s,this.C=this.C}ir.prototype.s=!1,ir.prototype.ma=function(){this.s||(this.s=!0,this.N())},ir.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ct(u,d){this.type=u,this.g=this.target=d,this.defaultPrevented=!1}ct.prototype.h=function(){this.defaultPrevented=!0};var CA=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,d=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let f=()=>{};a.addEventListener("test",f,d),a.removeEventListener("test",f,d)}catch{}return u}();function xs(u,d){if(ct.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var f=this.type=u.type,g=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=d,d=u.relatedTarget){if(ee){e:{try{Q(d.nodeName);var C=!0;break e}catch{}C=!1}C||(d=null)}}else f=="mouseover"?d=u.fromElement:f=="mouseout"&&(d=u.toElement);this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:TA[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&xs.aa.h.call(this)}}b(xs,ct);var TA={2:"touch",3:"pen",4:"mouse"};xs.prototype.h=function(){xs.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Rs="closure_listenable_"+(1e6*Math.random()|0),bA=0;function SA(u,d,f,g,C){this.listener=u,this.proxy=null,this.src=d,this.type=f,this.capture=!!g,this.ha=C,this.key=++bA,this.da=this.fa=!1}function Pu(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ku(u){this.src=u,this.g={},this.h=0}ku.prototype.add=function(u,d,f,g,C){var A=u.toString();u=this.g[A],u||(u=this.g[A]=[],this.h++);var L=Eh(u,d,g,C);return-1<L?(d=u[L],f||(d.fa=!1)):(d=new SA(d,this.src,A,!!g,C),d.fa=f,u.push(d)),d};function Ih(u,d){var f=d.type;if(f in u.g){var g=u.g[f],C=Array.prototype.indexOf.call(g,d,void 0),A;(A=0<=C)&&Array.prototype.splice.call(g,C,1),A&&(Pu(d),u.g[f].length==0&&(delete u.g[f],u.h--))}}function Eh(u,d,f,g){for(var C=0;C<u.length;++C){var A=u[C];if(!A.da&&A.listener==d&&A.capture==!!f&&A.ha==g)return C}return-1}var Dh="closure_lm_"+(1e6*Math.random()|0),Ch={};function yw(u,d,f,g,C){if(g&&g.once)return ww(u,d,f,g,C);if(Array.isArray(d)){for(var A=0;A<d.length;A++)yw(u,d[A],f,g,C);return null}return f=Ah(f),u&&u[Rs]?u.K(d,f,l(g)?!!g.capture:!!g,C):vw(u,d,f,!1,g,C)}function vw(u,d,f,g,C,A){if(!d)throw Error("Invalid event type");var L=l(C)?!!C.capture:!!C,Ie=bh(u);if(Ie||(u[Dh]=Ie=new ku(u)),f=Ie.add(d,f,g,L,A),f.proxy)return f;if(g=AA(),f.proxy=g,g.src=u,g.listener=f,u.addEventListener)CA||(C=L),C===void 0&&(C=!1),u.addEventListener(d.toString(),g,C);else if(u.attachEvent)u.attachEvent(Iw(d.toString()),g);else if(u.addListener&&u.removeListener)u.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function AA(){function u(f){return d.call(u.src,u.listener,f)}let d=xA;return u}function ww(u,d,f,g,C){if(Array.isArray(d)){for(var A=0;A<d.length;A++)ww(u,d[A],f,g,C);return null}return f=Ah(f),u&&u[Rs]?u.L(d,f,l(g)?!!g.capture:!!g,C):vw(u,d,f,!0,g,C)}function _w(u,d,f,g,C){if(Array.isArray(d))for(var A=0;A<d.length;A++)_w(u,d[A],f,g,C);else g=l(g)?!!g.capture:!!g,f=Ah(f),u&&u[Rs]?(u=u.i,d=String(d).toString(),d in u.g&&(A=u.g[d],f=Eh(A,f,g,C),-1<f&&(Pu(A[f]),Array.prototype.splice.call(A,f,1),A.length==0&&(delete u.g[d],u.h--)))):u&&(u=bh(u))&&(d=u.g[d.toString()],u=-1,d&&(u=Eh(d,f,g,C)),(f=-1<u?d[u]:null)&&Th(f))}function Th(u){if(typeof u!="number"&&u&&!u.da){var d=u.src;if(d&&d[Rs])Ih(d.i,u);else{var f=u.type,g=u.proxy;d.removeEventListener?d.removeEventListener(f,g,u.capture):d.detachEvent?d.detachEvent(Iw(f),g):d.addListener&&d.removeListener&&d.removeListener(g),(f=bh(d))?(Ih(f,u),f.h==0&&(f.src=null,d[Dh]=null)):Pu(u)}}}function Iw(u){return u in Ch?Ch[u]:Ch[u]="on"+u}function xA(u,d){if(u.da)u=!0;else{d=new xs(d,this);var f=u.listener,g=u.ha||u.src;u.fa&&Th(u),u=f.call(g,d)}return u}function bh(u){return u=u[Dh],u instanceof ku?u:null}var Sh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ah(u){return typeof u=="function"?u:(u[Sh]||(u[Sh]=function(d){return u.handleEvent(d)}),u[Sh])}function lt(){ir.call(this),this.i=new ku(this),this.M=this,this.F=null}b(lt,ir),lt.prototype[Rs]=!0,lt.prototype.removeEventListener=function(u,d,f,g){_w(this,u,d,f,g)};function gt(u,d){var f,g=u.F;if(g)for(f=[];g;g=g.F)f.push(g);if(u=u.M,g=d.type||d,typeof d=="string")d=new ct(d,u);else if(d instanceof ct)d.target=d.target||u;else{var C=d;d=new ct(g,u),E(d,C)}if(C=!0,f)for(var A=f.length-1;0<=A;A--){var L=d.g=f[A];C=Ou(L,g,!0,d)&&C}if(L=d.g=u,C=Ou(L,g,!0,d)&&C,C=Ou(L,g,!1,d)&&C,f)for(A=0;A<f.length;A++)L=d.g=f[A],C=Ou(L,g,!1,d)&&C}lt.prototype.N=function(){if(lt.aa.N.call(this),this.i){var u=this.i,d;for(d in u.g){for(var f=u.g[d],g=0;g<f.length;g++)Pu(f[g]);delete u.g[d],u.h--}}this.F=null},lt.prototype.K=function(u,d,f,g){return this.i.add(String(u),d,!1,f,g)},lt.prototype.L=function(u,d,f,g){return this.i.add(String(u),d,!0,f,g)};function Ou(u,d,f,g){if(d=u.i.g[String(d)],!d)return!0;d=d.concat();for(var C=!0,A=0;A<d.length;++A){var L=d[A];if(L&&!L.da&&L.capture==f){var Ie=L.listener,rt=L.ha||L.src;L.fa&&Ih(u.i,L),C=Ie.call(rt,g)!==!1&&C}}return C&&!g.defaultPrevented}function Ew(u,d,f){if(typeof u=="function")f&&(u=m(u,f));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(u,d||0)}function Dw(u){u.g=Ew(()=>{u.g=null,u.i&&(u.i=!1,Dw(u))},u.l);let d=u.h;u.h=null,u.m.apply(null,d)}class RA extends ir{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Dw(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ms(u){ir.call(this),this.h=u,this.g={}}b(Ms,ir);var Cw=[];function Tw(u){Y(u.g,function(d,f){this.g.hasOwnProperty(f)&&Th(d)},u),u.g={}}Ms.prototype.N=function(){Ms.aa.N.call(this),Tw(this)},Ms.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xh=a.JSON.stringify,MA=a.JSON.parse,NA=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Rh(){}Rh.prototype.h=null;function bw(u){return u.h||(u.h=u.i())}function Sw(){}var Ns={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Mh(){ct.call(this,"d")}b(Mh,ct);function Nh(){ct.call(this,"c")}b(Nh,ct);var Wr={},Aw=null;function Fu(){return Aw=Aw||new lt}Wr.La="serverreachability";function xw(u){ct.call(this,Wr.La,u)}b(xw,ct);function Ps(u){let d=Fu();gt(d,new xw(d))}Wr.STAT_EVENT="statevent";function Rw(u,d){ct.call(this,Wr.STAT_EVENT,u),this.stat=d}b(Rw,ct);function mt(u){let d=Fu();gt(d,new Rw(d,u))}Wr.Ma="timingevent";function Mw(u,d){ct.call(this,Wr.Ma,u),this.size=d}b(Mw,ct);function ks(u,d){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},d)}function Os(){this.g=!0}Os.prototype.xa=function(){this.g=!1};function PA(u,d,f,g,C,A){u.info(function(){if(u.g)if(A)for(var L="",Ie=A.split("&"),rt=0;rt<Ie.length;rt++){var me=Ie[rt].split("=");if(1<me.length){var dt=me[0];me=me[1];var ht=dt.split("_");L=2<=ht.length&&ht[1]=="type"?L+(dt+"="+me+"&"):L+(dt+"=redacted&")}}else L=null;else L=A;return"XMLHTTP REQ ("+g+") [attempt "+C+"]: "+d+`
`+f+`
`+L})}function kA(u,d,f,g,C,A,L){u.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+C+"]: "+d+`
`+f+`
`+A+" "+L})}function qi(u,d,f,g){u.info(function(){return"XMLHTTP TEXT ("+d+"): "+FA(u,f)+(g?" "+g:"")})}function OA(u,d){u.info(function(){return"TIMEOUT: "+d})}Os.prototype.info=function(){};function FA(u,d){if(!u.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(u=0;u<f.length;u++)if(Array.isArray(f[u])){var g=f[u];if(!(2>g.length)){var C=g[1];if(Array.isArray(C)&&!(1>C.length)){var A=C[0];if(A!="noop"&&A!="stop"&&A!="close")for(var L=1;L<C.length;L++)C[L]=""}}}}return xh(f)}catch{return d}}var Lu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Nw={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ph;function Vu(){}b(Vu,Rh),Vu.prototype.g=function(){return new XMLHttpRequest},Vu.prototype.i=function(){return{}},Ph=new Vu;function or(u,d,f,g){this.j=u,this.i=d,this.l=f,this.R=g||1,this.U=new Ms(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Pw}function Pw(){this.i=null,this.g="",this.h=!1}var kw={},kh={};function Oh(u,d,f){u.L=1,u.v=$u(Pn(d)),u.m=f,u.P=!0,Ow(u,null)}function Ow(u,d){u.F=Date.now(),ju(u),u.A=Pn(u.v);var f=u.A,g=u.R;Array.isArray(g)||(g=[String(g)]),Qw(f.i,"t",g),u.C=0,f=u.j.J,u.h=new Pw,u.g=f_(u.j,f?d:null,!u.m),0<u.O&&(u.M=new RA(m(u.Y,u,u.g),u.O)),d=u.U,f=u.g,g=u.ca;var C="readystatechange";Array.isArray(C)||(C&&(Cw[0]=C.toString()),C=Cw);for(var A=0;A<C.length;A++){var L=yw(f,C[A],g||d.handleEvent,!1,d.h||d);if(!L)break;d.g[L.key]=L}d=u.H?y(u.H):{},u.m?(u.u||(u.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,d)):(u.u="GET",u.g.ea(u.A,u.u,null,d)),Ps(),PA(u.i,u.u,u.A,u.l,u.R,u.m)}or.prototype.ca=function(u){u=u.target;let d=this.M;d&&kn(u)==3?d.j():this.Y(u)},or.prototype.Y=function(u){try{if(u==this.g)e:{let ht=kn(this.g);var d=this.g.Ba();let Wi=this.g.Z();if(!(3>ht)&&(ht!=3||this.g&&(this.h.h||this.g.oa()||n_(this.g)))){this.J||ht!=4||d==7||(d==8||0>=Wi?Ps(3):Ps(2)),Fh(this);var f=this.g.Z();this.X=f;t:if(Fw(this)){var g=n_(this.g);u="";var C=g.length,A=kn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Kr(this),Fs(this);var L="";break t}this.h.i=new a.TextDecoder}for(d=0;d<C;d++)this.h.h=!0,u+=this.h.i.decode(g[d],{stream:!(A&&d==C-1)});g.length=0,this.h.g+=u,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=f==200,kA(this.i,this.u,this.A,this.l,this.R,ht,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ie,rt=this.g;if((Ie=rt.g?rt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Ie)){var me=Ie;break t}}me=null}if(f=me)qi(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Lh(this,f);else{this.o=!1,this.s=3,mt(12),Kr(this),Fs(this);break e}}if(this.P){f=!0;let Jt;for(;!this.J&&this.C<L.length;)if(Jt=LA(this,L),Jt==kh){ht==4&&(this.s=4,mt(14),f=!1),qi(this.i,this.l,null,"[Incomplete Response]");break}else if(Jt==kw){this.s=4,mt(15),qi(this.i,this.l,L,"[Invalid Chunk]"),f=!1;break}else qi(this.i,this.l,Jt,null),Lh(this,Jt);if(Fw(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ht!=4||L.length!=0||this.h.h||(this.s=1,mt(16),f=!1),this.o=this.o&&f,!f)qi(this.i,this.l,L,"[Invalid Chunked Response]"),Kr(this),Fs(this);else if(0<L.length&&!this.W){this.W=!0;var dt=this.j;dt.g==this&&dt.ba&&!dt.M&&(dt.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),Hh(dt),dt.M=!0,mt(11))}}else qi(this.i,this.l,L,null),Lh(this,L);ht==4&&Kr(this),this.o&&!this.J&&(ht==4?c_(this.j,this):(this.o=!1,ju(this)))}else ex(this.g),f==400&&0<L.indexOf("Unknown SID")?(this.s=3,mt(12)):(this.s=0,mt(13)),Kr(this),Fs(this)}}}catch{}finally{}};function Fw(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function LA(u,d){var f=u.C,g=d.indexOf(`
`,f);return g==-1?kh:(f=Number(d.substring(f,g)),isNaN(f)?kw:(g+=1,g+f>d.length?kh:(d=d.slice(g,g+f),u.C=g+f,d)))}or.prototype.cancel=function(){this.J=!0,Kr(this)};function ju(u){u.S=Date.now()+u.I,Lw(u,u.I)}function Lw(u,d){if(u.B!=null)throw Error("WatchDog timer not null");u.B=ks(m(u.ba,u),d)}function Fh(u){u.B&&(a.clearTimeout(u.B),u.B=null)}or.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(OA(this.i,this.A),this.L!=2&&(Ps(),mt(17)),Kr(this),this.s=2,Fs(this)):Lw(this,this.S-u)};function Fs(u){u.j.G==0||u.J||c_(u.j,u)}function Kr(u){Fh(u);var d=u.M;d&&typeof d.ma=="function"&&d.ma(),u.M=null,Tw(u.U),u.g&&(d=u.g,u.g=null,d.abort(),d.ma())}function Lh(u,d){try{var f=u.j;if(f.G!=0&&(f.g==u||Vh(f.h,u))){if(!u.K&&Vh(f.h,u)&&f.G==3){try{var g=f.Da.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var C=g;if(C[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<u.F)Wu(f),zu(f);else break e;$h(f),mt(18)}}else f.za=C[1],0<f.za-f.T&&37500>C[2]&&f.F&&f.v==0&&!f.C&&(f.C=ks(m(f.Za,f),6e3));if(1>=Bw(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Yr(f,11)}else if((u.K||f.g==u)&&Wu(f),!H(d))for(C=f.Da.g.parse(d),d=0;d<C.length;d++){let me=C[d];if(f.T=me[0],me=me[1],f.G==2)if(me[0]=="c"){f.K=me[1],f.ia=me[2];let dt=me[3];dt!=null&&(f.la=dt,f.j.info("VER="+f.la));let ht=me[4];ht!=null&&(f.Aa=ht,f.j.info("SVER="+f.Aa));let Wi=me[5];Wi!=null&&typeof Wi=="number"&&0<Wi&&(g=1.5*Wi,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let Jt=u.g;if(Jt){let Qu=Jt.g?Jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qu){var A=g.h;A.g||Qu.indexOf("spdy")==-1&&Qu.indexOf("quic")==-1&&Qu.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(jh(A,A.h),A.h=null))}if(g.D){let qh=Jt.g?Jt.g.getResponseHeader("X-HTTP-Session-Id"):null;qh&&(g.ya=qh,xe(g.I,g.D,qh))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-u.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var L=u;if(g.qa=h_(g,g.J?g.ia:null,g.W),L.K){Uw(g.h,L);var Ie=L,rt=g.L;rt&&(Ie.I=rt),Ie.B&&(Fh(Ie),ju(Ie)),g.g=L}else a_(g);0<f.i.length&&Gu(f)}else me[0]!="stop"&&me[0]!="close"||Yr(f,7);else f.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?Yr(f,7):Uh(f):me[0]!="noop"&&f.l&&f.l.ta(me),f.v=0)}}Ps(4)}catch{}}var VA=class{constructor(u,d){this.g=u,this.map=d}};function Vw(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function jw(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Bw(u){return u.h?1:u.g?u.g.size:0}function Vh(u,d){return u.h?u.h==d:u.g?u.g.has(d):!1}function jh(u,d){u.g?u.g.add(d):u.h=d}function Uw(u,d){u.h&&u.h==d?u.h=null:u.g&&u.g.has(d)&&u.g.delete(d)}Vw.prototype.cancel=function(){if(this.i=$w(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function $w(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let d=u.i;for(let f of u.g.values())d=d.concat(f.D);return d}return M(u.i)}function jA(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var d=[],f=u.length,g=0;g<f;g++)d.push(u[g]);return d}d=[],f=0;for(g in u)d[f++]=u[g];return d}function BA(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var d=[];u=u.length;for(var f=0;f<u;f++)d.push(f);return d}d=[],f=0;for(let g in u)d[f++]=g;return d}}}function Hw(u,d){if(u.forEach&&typeof u.forEach=="function")u.forEach(d,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,d,void 0);else for(var f=BA(u),g=jA(u),C=g.length,A=0;A<C;A++)d.call(void 0,g[A],f&&f[A],u)}var qw=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function UA(u,d){if(u){u=u.split("&");for(var f=0;f<u.length;f++){var g=u[f].indexOf("="),C=null;if(0<=g){var A=u[f].substring(0,g);C=u[f].substring(g+1)}else A=u[f];d(A,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function Qr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Qr){this.h=u.h,Bu(this,u.j),this.o=u.o,this.g=u.g,Uu(this,u.s),this.l=u.l;var d=u.i,f=new js;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),zw(this,f),this.m=u.m}else u&&(d=String(u).match(qw))?(this.h=!1,Bu(this,d[1]||"",!0),this.o=Ls(d[2]||""),this.g=Ls(d[3]||"",!0),Uu(this,d[4]),this.l=Ls(d[5]||"",!0),zw(this,d[6]||"",!0),this.m=Ls(d[7]||"")):(this.h=!1,this.i=new js(null,this.h))}Qr.prototype.toString=function(){var u=[],d=this.j;d&&u.push(Vs(d,Gw,!0),":");var f=this.g;return(f||d=="file")&&(u.push("//"),(d=this.o)&&u.push(Vs(d,Gw,!0),"@"),u.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&u.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&u.push("/"),u.push(Vs(f,f.charAt(0)=="/"?qA:HA,!0))),(f=this.i.toString())&&u.push("?",f),(f=this.m)&&u.push("#",Vs(f,GA)),u.join("")};function Pn(u){return new Qr(u)}function Bu(u,d,f){u.j=f?Ls(d,!0):d,u.j&&(u.j=u.j.replace(/:$/,""))}function Uu(u,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);u.s=d}else u.s=null}function zw(u,d,f){d instanceof js?(u.i=d,WA(u.i,u.h)):(f||(d=Vs(d,zA)),u.i=new js(d,u.h))}function xe(u,d,f){u.i.set(d,f)}function $u(u){return xe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Ls(u,d){return u?d?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Vs(u,d,f){return typeof u=="string"?(u=encodeURI(u).replace(d,$A),f&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function $A(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Gw=/[#\/\?@]/g,HA=/[#\?:]/g,qA=/[#\?]/g,zA=/[#\?@]/g,GA=/#/g;function js(u,d){this.h=this.g=null,this.i=u||null,this.j=!!d}function sr(u){u.g||(u.g=new Map,u.h=0,u.i&&UA(u.i,function(d,f){u.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=js.prototype,n.add=function(u,d){sr(this),this.i=null,u=zi(this,u);var f=this.g.get(u);return f||this.g.set(u,f=[]),f.push(d),this.h+=1,this};function Ww(u,d){sr(u),d=zi(u,d),u.g.has(d)&&(u.i=null,u.h-=u.g.get(d).length,u.g.delete(d))}function Kw(u,d){return sr(u),d=zi(u,d),u.g.has(d)}n.forEach=function(u,d){sr(this),this.g.forEach(function(f,g){f.forEach(function(C){u.call(d,C,g,this)},this)},this)},n.na=function(){sr(this);let u=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let g=0;g<d.length;g++){let C=u[g];for(let A=0;A<C.length;A++)f.push(d[g])}return f},n.V=function(u){sr(this);let d=[];if(typeof u=="string")Kw(this,u)&&(d=d.concat(this.g.get(zi(this,u))));else{u=Array.from(this.g.values());for(let f=0;f<u.length;f++)d=d.concat(u[f])}return d},n.set=function(u,d){return sr(this),this.i=null,u=zi(this,u),Kw(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[d]),this.h+=1,this},n.get=function(u,d){return u?(u=this.V(u),0<u.length?String(u[0]):d):d};function Qw(u,d,f){Ww(u,d),0<f.length&&(u.i=null,u.g.set(zi(u,d),M(f)),u.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var g=d[f];let A=encodeURIComponent(String(g)),L=this.V(g);for(g=0;g<L.length;g++){var C=A;L[g]!==""&&(C+="="+encodeURIComponent(String(L[g]))),u.push(C)}}return this.i=u.join("&")};function zi(u,d){return d=String(d),u.j&&(d=d.toLowerCase()),d}function WA(u,d){d&&!u.j&&(sr(u),u.i=null,u.g.forEach(function(f,g){var C=g.toLowerCase();g!=C&&(Ww(this,g),Qw(this,C,f))},u)),u.j=d}function KA(u,d){let f=new Os;if(a.Image){let g=new Image;g.onload=v(ar,f,"TestLoadImage: loaded",!0,d,g),g.onerror=v(ar,f,"TestLoadImage: error",!1,d,g),g.onabort=v(ar,f,"TestLoadImage: abort",!1,d,g),g.ontimeout=v(ar,f,"TestLoadImage: timeout",!1,d,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=u}else d(!1)}function QA(u,d){let f=new Os,g=new AbortController,C=setTimeout(()=>{g.abort(),ar(f,"TestPingServer: timeout",!1,d)},1e4);fetch(u,{signal:g.signal}).then(A=>{clearTimeout(C),A.ok?ar(f,"TestPingServer: ok",!0,d):ar(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(C),ar(f,"TestPingServer: error",!1,d)})}function ar(u,d,f,g,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),g(f)}catch{}}function YA(){this.g=new NA}function ZA(u,d,f){let g=f||"";try{Hw(u,function(C,A){let L=C;l(C)&&(L=xh(C)),d.push(g+A+"="+encodeURIComponent(L))})}catch(C){throw d.push(g+"type="+encodeURIComponent("_badmap")),C}}function Bs(u){this.l=u.Ub||null,this.j=u.eb||!1}b(Bs,Rh),Bs.prototype.g=function(){return new Hu(this.l,this.j)},Bs.prototype.i=function(u){return function(){return u}}({});function Hu(u,d){lt.call(this),this.D=u,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(Hu,lt),n=Hu.prototype,n.open=function(u,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=d,this.readyState=1,$s(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(d.body=u),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Us(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,$s(this)),this.g&&(this.readyState=3,$s(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Yw(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Yw(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var d=u.value?u.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!u.done}))&&(this.response=this.responseText+=d)}u.done?Us(this):$s(this),this.readyState==3&&Yw(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Us(this))},n.Qa=function(u){this.g&&(this.response=u,Us(this))},n.ga=function(){this.g&&Us(this)};function Us(u){u.readyState=4,u.l=null,u.j=null,u.v=null,$s(u)}n.setRequestHeader=function(u,d){this.u.append(u,d)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,u.push(f[0]+": "+f[1]),f=d.next();return u.join(`\r
`)};function $s(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Hu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Zw(u){let d="";return Y(u,function(f,g){d+=g,d+=":",d+=f,d+=`\r
`}),d}function Bh(u,d,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=Zw(f),typeof u=="string"?f!=null&&encodeURIComponent(String(f)):xe(u,d,f))}function Fe(u){lt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Fe,lt);var JA=/^https?$/i,XA=["POST","PUT"];n=Fe.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,d,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);d=d?d.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ph.g(),this.v=this.o?bw(this.o):bw(Ph),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(u),!0),this.B=!1}catch(A){Jw(this,A);return}if(u=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var C in g)f.set(C,g[C]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let A of g.keys())f.set(A,g.get(A));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(A=>A.toLowerCase()=="content-type"),C=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(XA,d,void 0))||g||C||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,L]of f)this.g.setRequestHeader(A,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{t_(this),this.u=!0,this.g.send(u),this.u=!1}catch(A){Jw(this,A)}};function Jw(u,d){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=d,u.m=5,Xw(u),qu(u)}function Xw(u){u.A||(u.A=!0,gt(u,"complete"),gt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,gt(this,"complete"),gt(this,"abort"),qu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qu(this,!0)),Fe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?e_(this):this.bb())},n.bb=function(){e_(this)};function e_(u){if(u.h&&typeof s<"u"&&(!u.v[1]||kn(u)!=4||u.Z()!=2)){if(u.u&&kn(u)==4)Ew(u.Ea,0,u);else if(gt(u,"readystatechange"),kn(u)==4){u.h=!1;try{let L=u.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var g;if(g=L===0){var C=String(u.D).match(qw)[1]||null;!C&&a.self&&a.self.location&&(C=a.self.location.protocol.slice(0,-1)),g=!JA.test(C?C.toLowerCase():"")}f=g}if(f)gt(u,"complete"),gt(u,"success");else{u.m=6;try{var A=2<kn(u)?u.g.statusText:""}catch{A=""}u.l=A+" ["+u.Z()+"]",Xw(u)}}finally{qu(u)}}}}function qu(u,d){if(u.g){t_(u);let f=u.g,g=u.v[0]?()=>{}:null;u.g=null,u.v=null,d||gt(u,"ready");try{f.onreadystatechange=g}catch{}}}function t_(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function kn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<kn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var d=this.g.responseText;return u&&d.indexOf(u)==0&&(d=d.substring(u.length)),MA(d)}};function n_(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function ex(u){let d={};u=(u.g&&2<=kn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<u.length;g++){if(H(u[g]))continue;var f=D(u[g]);let C=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let A=d[C]||[];d[C]=A,A.push(f)}I(d,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hs(u,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[u]||d}function r_(u){this.Aa=0,this.i=[],this.j=new Os,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Hs("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Hs("baseRetryDelayMs",5e3,u),this.cb=Hs("retryDelaySeedMs",1e4,u),this.Wa=Hs("forwardChannelMaxRetries",2,u),this.wa=Hs("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Vw(u&&u.concurrentRequestLimit),this.Da=new YA,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=r_.prototype,n.la=8,n.G=1,n.connect=function(u,d,f,g){mt(0),this.W=u,this.H=d||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=h_(this,null,this.W),Gu(this)};function Uh(u){if(i_(u),u.G==3){var d=u.U++,f=Pn(u.I);if(xe(f,"SID",u.K),xe(f,"RID",d),xe(f,"TYPE","terminate"),qs(u,f),d=new or(u,u.j,d),d.L=2,d.v=$u(Pn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=d.v,f=!0),f||(d.g=f_(d.j,null),d.g.ea(d.v)),d.F=Date.now(),ju(d)}d_(u)}function zu(u){u.g&&(Hh(u),u.g.cancel(),u.g=null)}function i_(u){zu(u),u.u&&(a.clearTimeout(u.u),u.u=null),Wu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Gu(u){if(!jw(u.h)&&!u.s){u.s=!0;var d=u.Ga;Ss||mw(),As||(Ss(),As=!0),_h.add(d,u),u.B=0}}function tx(u,d){return Bw(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=d.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=ks(m(u.Ga,u,d),l_(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let C=new or(this,this.j,u),A=this.o;if(this.S&&(A?(A=y(A),E(A,this.S)):A=this.S),this.m!==null||this.O||(C.H=A,A=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=s_(this,C,d),f=Pn(this.I),xe(f,"RID",u),xe(f,"CVER",22),this.D&&xe(f,"X-HTTP-Session-Id",this.D),qs(this,f),A&&(this.O?d="headers="+encodeURIComponent(String(Zw(A)))+"&"+d:this.m&&Bh(f,this.m,A)),jh(this.h,C),this.Ua&&xe(f,"TYPE","init"),this.P?(xe(f,"$req",d),xe(f,"SID","null"),C.T=!0,Oh(C,f,null)):Oh(C,f,d),this.G=2}}else this.G==3&&(u?o_(this,u):this.i.length==0||jw(this.h)||o_(this))};function o_(u,d){var f;d?f=d.l:f=u.U++;let g=Pn(u.I);xe(g,"SID",u.K),xe(g,"RID",f),xe(g,"AID",u.T),qs(u,g),u.m&&u.o&&Bh(g,u.m,u.o),f=new or(u,u.j,f,u.B+1),u.m===null&&(f.H=u.o),d&&(u.i=d.D.concat(u.i)),d=s_(u,f,1e3),f.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),jh(u.h,f),Oh(f,g,d)}function qs(u,d){u.H&&Y(u.H,function(f,g){xe(d,g,f)}),u.l&&Hw({},function(f,g){xe(d,g,f)})}function s_(u,d,f){f=Math.min(u.i.length,f);var g=u.l?m(u.l.Na,u.l,u):null;e:{var C=u.i;let A=-1;for(;;){let L=["count="+f];A==-1?0<f?(A=C[0].g,L.push("ofs="+A)):A=0:L.push("ofs="+A);let Ie=!0;for(let rt=0;rt<f;rt++){let me=C[rt].g,dt=C[rt].map;if(me-=A,0>me)A=Math.max(0,C[rt].g-100),Ie=!1;else try{ZA(dt,L,"req"+me+"_")}catch{g&&g(dt)}}if(Ie){g=L.join("&");break e}}}return u=u.i.splice(0,f),d.D=u,g}function a_(u){if(!u.g&&!u.u){u.Y=1;var d=u.Fa;Ss||mw(),As||(Ss(),As=!0),_h.add(d,u),u.v=0}}function $h(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=ks(m(u.Fa,u),l_(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,u_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=ks(m(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mt(10),zu(this),u_(this))};function Hh(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function u_(u){u.g=new or(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var d=Pn(u.qa);xe(d,"RID","rpc"),xe(d,"SID",u.K),xe(d,"AID",u.T),xe(d,"CI",u.F?"0":"1"),!u.F&&u.ja&&xe(d,"TO",u.ja),xe(d,"TYPE","xmlhttp"),qs(u,d),u.m&&u.o&&Bh(d,u.m,u.o),u.L&&(u.g.I=u.L);var f=u.g;u=u.ia,f.L=1,f.v=$u(Pn(d)),f.m=null,f.P=!0,Ow(f,u)}n.Za=function(){this.C!=null&&(this.C=null,zu(this),$h(this),mt(19))};function Wu(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function c_(u,d){var f=null;if(u.g==d){Wu(u),Hh(u),u.g=null;var g=2}else if(Vh(u.h,d))f=d.D,Uw(u.h,d),g=1;else return;if(u.G!=0){if(d.o)if(g==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var C=u.B;g=Fu(),gt(g,new Mw(g,f)),Gu(u)}else a_(u);else if(C=d.s,C==3||C==0&&0<d.X||!(g==1&&tx(u,d)||g==2&&$h(u)))switch(f&&0<f.length&&(d=u.h,d.i=d.i.concat(f)),C){case 1:Yr(u,5);break;case 4:Yr(u,10);break;case 3:Yr(u,6);break;default:Yr(u,2)}}}function l_(u,d){let f=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(f*=2),f*d}function Yr(u,d){if(u.j.info("Error code "+d),d==2){var f=m(u.fb,u),g=u.Xa;let C=!g;g=new Qr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Bu(g,"https"),$u(g),C?KA(g.toString(),f):QA(g.toString(),f)}else mt(2);u.G=0,u.l&&u.l.sa(d),d_(u),i_(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),mt(2)):(this.j.info("Failed to ping google.com"),mt(1))};function d_(u){if(u.G=0,u.ka=[],u.l){let d=$w(u.h);(d.length!=0||u.i.length!=0)&&(N(u.ka,d),N(u.ka,u.i),u.h.i.length=0,M(u.i),u.i.length=0),u.l.ra()}}function h_(u,d,f){var g=f instanceof Qr?Pn(f):new Qr(f);if(g.g!="")d&&(g.g=d+"."+g.g),Uu(g,g.s);else{var C=a.location;g=C.protocol,d=d?d+"."+C.hostname:C.hostname,C=+C.port;var A=new Qr(null);g&&Bu(A,g),d&&(A.g=d),C&&Uu(A,C),f&&(A.l=f),g=A}return f=u.D,d=u.ya,f&&d&&xe(g,f,d),xe(g,"VER",u.la),qs(u,g),g}function f_(u,d,f){if(d&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=u.Ca&&!u.pa?new Fe(new Bs({eb:f})):new Fe(u.pa),d.Ha(u.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function p_(){}n=p_.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ku(){}Ku.prototype.g=function(u,d){return new Nt(u,d)};function Nt(u,d){lt.call(this),this.g=new r_(d),this.l=u,this.h=d&&d.messageUrlParams||null,u=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(u?u["X-WebChannel-Content-Type"]=d.messageContentType:u={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(u?u["X-WebChannel-Client-Profile"]=d.va:u={"X-WebChannel-Client-Profile":d.va}),this.g.S=u,(u=d&&d.Sb)&&!H(u)&&(this.g.m=u),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!H(d)&&(this.g.D=d,u=this.h,u!==null&&d in u&&(u=this.h,d in u&&delete u[d])),this.j=new Gi(this)}b(Nt,lt),Nt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nt.prototype.close=function(){Uh(this.g)},Nt.prototype.o=function(u){var d=this.g;if(typeof u=="string"){var f={};f.__data__=u,u=f}else this.u&&(f={},f.__data__=xh(u),u=f);d.i.push(new VA(d.Ya++,u)),d.G==3&&Gu(d)},Nt.prototype.N=function(){this.g.l=null,delete this.j,Uh(this.g),delete this.g,Nt.aa.N.call(this)};function g_(u){Mh.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var d=u.__sm__;if(d){e:{for(let f in d){u=f;break e}u=void 0}(this.i=u)&&(u=this.i,d=d!==null&&u in d?d[u]:void 0),this.data=d}else this.data=u}b(g_,Mh);function m_(){Nh.call(this),this.status=1}b(m_,Nh);function Gi(u){this.g=u}b(Gi,p_),Gi.prototype.ua=function(){gt(this.g,"a")},Gi.prototype.ta=function(u){gt(this.g,new g_(u))},Gi.prototype.sa=function(u){gt(this.g,new m_)},Gi.prototype.ra=function(){gt(this.g,"b")},Ku.prototype.createWebChannel=Ku.prototype.g,Nt.prototype.send=Nt.prototype.o,Nt.prototype.open=Nt.prototype.m,Nt.prototype.close=Nt.prototype.close,pm=Kn.createWebChannelTransport=function(){return new Ku},fm=Kn.getStatEventTarget=function(){return Fu()},hm=Kn.Event=Wr,Ql=Kn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Lu.NO_ERROR=0,Lu.TIMEOUT=8,Lu.HTTP_ERROR=6,Ga=Kn.ErrorCode=Lu,Nw.COMPLETE="complete",dm=Kn.EventType=Nw,Sw.EventType=Ns,Ns.OPEN="a",Ns.CLOSE="b",Ns.ERROR="c",Ns.MESSAGE="d",lt.prototype.listen=lt.prototype.K,jo=Kn.WebChannel=Sw,fF=Kn.FetchXmlHttpFactory=Bs,Fe.prototype.listenOnce=Fe.prototype.L,Fe.prototype.getLastError=Fe.prototype.Ka,Fe.prototype.getLastErrorCode=Fe.prototype.Ba,Fe.prototype.getStatus=Fe.prototype.Z,Fe.prototype.getResponseJson=Fe.prototype.Oa,Fe.prototype.getResponseText=Fe.prototype.oa,Fe.prototype.send=Fe.prototype.ea,Fe.prototype.setWithCredentials=Fe.prototype.Ha,lm=Kn.XhrIo=Fe}).apply(typeof Kl<"u"?Kl:typeof self<"u"?self:typeof window<"u"?window:{});var NT="@firebase/firestore";var Ke=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ke.UNAUTHENTICATED=new Ke(null),Ke.GOOGLE_CREDENTIALS=new Ke("google-credentials-uid"),Ke.FIRST_PARTY=new Ke("first-party-uid"),Ke.MOCK_USER=new Ke("mock-user");var ms="10.14.0";var kr=new Ju("@firebase/firestore");function qo(){return kr.logLevel}function O0(n){kr.setLogLevel(n)}function k(n,...e){if(kr.logLevel<=hn.DEBUG){let t=e.map(wv);kr.debug(`Firestore (${ms}): ${n}`,...t)}}function Ue(n,...e){if(kr.logLevel<=hn.ERROR){let t=e.map(wv);kr.error(`Firestore (${ms}): ${n}`,...t)}}function an(n,...e){if(kr.logLevel<=hn.WARN){let t=e.map(wv);kr.warn(`Firestore (${ms}): ${n}`,...t)}}function wv(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function q(n="Unexpected state"){let e=`FIRESTORE (${ms}) INTERNAL ASSERTION FAILED: `+n;throw Ue(e),new Error(e)}function G(n,e){n||q()}function F0(n,e){n||q()}function B(n,e){return n}var x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends E_{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Xe=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var od=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},_m=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ke.UNAUTHENTICATED))}shutdown(){}},Im=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Em=class{constructor(e){this.t=e,this.currentUser=Ke.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){G(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new Xe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Xe,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>R(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Xe)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(G(typeof r.accessToken=="string"),new od(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return G(e===null||typeof e=="string"),new Ke(e)}},Dm=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ke.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Cm=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Dm(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ke.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Tm=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},bm=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){G(this.o===void 0);let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(G(typeof t.token=="string"),this.R=t.token,new Tm(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function pF(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var sd=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=pF(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function re(n,e){return n<e?-1:n>e?1:0}function Xo(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function L0(n){return n+"\0"}var ke=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?re(this.nanoseconds,e.nanoseconds):re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var K=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ke(0,0))}static max(){return new n(new ke(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ad=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&q(),r===void 0?r=e.length-t:r>e.length-t&&q(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},pe=class n extends ad{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(x.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},gF=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$e=class n extends ad{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return gF.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new P(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new P(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new P(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var U=class n{constructor(e){this.path=e}static fromPath(e){return new n(pe.fromString(e))}static fromName(e){return new n(pe.fromString(e).popFirst(5))}static empty(){return new n(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new pe(e.slice()))}};var es=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function Sm(n){return n.fields.find(e=>e.kind===2)}function wi(n){return n.fields.filter(e=>e.kind!==2)}es.UNKNOWN_ID=-1;var Yo=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var iu=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Yt.min())}};function V0(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new ke(t+1,0):new ke(t,r));return new Yt(i,U.empty(),e)}function j0(n){return new Yt(n.readTime,n.key,-1)}var Yt=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(K.min(),U.empty(),-1)}static max(){return new n(K.max(),U.empty(),-1)}};function _v(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=U.comparator(n.documentKey,e.documentKey),t!==0?t:re(n.largestBatchId,e.largestBatchId))}var B0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ud=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function qr(n){return R(this,null,function*(){if(n.code!==x.FAILED_PRECONDITION||n.message!==B0)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var S=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let l=c;t(e[l]).next(h=>{s[l]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var cd=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Xe,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ti(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=Iv(r.target.error);this.V.reject(new Ti(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new Ti(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new xm(t)}},Or=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(zs())===12.2&&Ue("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return k("SimpleDb","Removing database:",e),_i(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Zu())return!1;if(n.v())return!0;let e=zs(),t=n.S(e),r=0<t&&t<10,i=U0(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return R(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new Ti(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new P(x.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new P(x.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new Ti(e,s))},i.onupgradeneeded=o=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return R(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let a=cd.open(this.db,e,o?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),S.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&s<3;if(k("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function U0(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var Am=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return _i(this.B.delete())}},Ti=class extends P{constructor(e,t){super(x.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function zr(n){return n.name==="IndexedDbTransactionError"}var xm=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),_i(r)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),_i(this.store.add(e))}get(e){return _i(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),_i(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),_i(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new S((s,a)=>{o.onerror=c=>{a(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{let o=this.cursor(r),s=[];return this.W(o,(a,c)=>{s.push(c)}).next(()=>s)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new S((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new S((r,i)=>{t.onerror=o=>{let s=Iv(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){let r=[];return new S((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let c=new Am(a),l=t(a.primaryKey,a.value,c);if(l instanceof S){let h=l.catch(p=>(c.done(),S.reject(p)));r.push(h)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>S.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function _i(n){return new S((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=Iv(r.target.error);t(i)}})}var PT=!1;function Iv(n){let e=Or.S(zs());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return PT||(PT=!0,setTimeout(()=>{throw r},0)),r}}return n}var Rm=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>R(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){zr(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield qr(t)}yield this.X(6e4)}))}},Mm=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return R(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,o=!0;return S.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return k("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(k("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=j0(o);_v(s,r)>0&&(r=s)}),new Yt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Vt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Tu(n){return n==null}function ou(n){return n===0&&1/n==-1/0}function $0(n){return typeof n=="number"&&Number.isInteger(n)&&!ou(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Ct(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=kT(e)),e=mF(n.get(t),e);return kT(e)}function mF(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function kT(n){return n+""}function En(n){let e=n.length;if(G(e>=2),e===2)return G(n.charAt(0)===""&&n.charAt(1)===""),pe.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&q(),n.charAt(s+1)){case"":let a=n.substring(o,s),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:q()}o=s+2}return new pe(r)}var OT=["userId","batchId"];function ed(n,e){return[n,Ct(e)]}function H0(n,e,t){return[n,Ct(e),t]}var yF={},vF=["prefixPath","collectionGroup","readTime","documentId"],wF=["prefixPath","collectionGroup","documentId"],_F=["collectionGroup","readTime","prefixPath","documentId"],IF=["canonicalId","targetId"],EF=["targetId","path"],DF=["path","targetId"],CF=["collectionId","parent"],TF=["indexId","uid"],bF=["uid","sequenceNumber"],SF=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],AF=["indexId","uid","orderedDocumentKey"],xF=["userId","collectionPath","documentId"],RF=["userId","collectionPath","largestBatchId"],MF=["userId","collectionGroup","largestBatchId"],q0=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],NF=[...q0,"documentOverlays"],z0=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],G0=z0,Ev=[...G0,"indexConfiguration","indexState","indexEntries"],PF=Ev,kF=[...Ev,"globals"];var su=class extends ud{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function et(n,e){let t=B(n);return Or.F(t._e,e)}function FT(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Li(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function W0(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Re=class n{constructor(e,t){this.comparator=e,this.root=t||Cn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Cn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qo(this.root,e,this.comparator,!0)}},Qo=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Cn=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();let e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}};Cn.EMPTY=null,Cn.RED=!0,Cn.BLACK=!1;Cn.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Cn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ce=class n{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ld(this.data.getIterator())}getIteratorFrom(e){return new ld(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},ld=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Bo(n){return n.hasNext()?n.getNext():void 0}var jt=class n{constructor(e){this.fields=e,e.sort($e.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ce($e.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xo(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var dd=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function K0(){return typeof atob<"u"}var qe=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new dd("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};qe.EMPTY_BYTE_STRING=new qe("");var OF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zn(n){if(G(!!n),typeof n=="string"){let e=0,t=OF.exec(n);if(G(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Me(n.seconds),nanos:Me(n.nanos)}}function Me(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Fr(n){return typeof n=="string"?qe.fromBase64String(n):qe.fromUint8Array(n)}function nh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Dv(n){let e=n.mapValue.fields.__previous_value__;return nh(e)?Dv(e):e}function au(n){let e=Zn(n.mapValue.fields.__local_write_time__.timestampValue);return new ke(e.seconds,e.nanos)}var Nm=class{constructor(e,t,r,i,o,s,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Lr=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Nr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},td={nullValue:"NULL_VALUE"};function bi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?nh(n)?4:Q0(n)?9007199254740991:rh(n)?10:11:q()}function Sn(n,e){if(n===e)return!0;let t=bi(n);if(t!==bi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return au(n).isEqual(au(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Zn(i.timestampValue),a=Zn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Fr(i.bytesValue).isEqual(Fr(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Me(i.geoPointValue.latitude)===Me(o.geoPointValue.latitude)&&Me(i.geoPointValue.longitude)===Me(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Me(i.integerValue)===Me(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Me(i.doubleValue),a=Me(o.doubleValue);return s===a?ou(s)===ou(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return Xo(n.arrayValue.values||[],e.arrayValue.values||[],Sn);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(FT(s)!==FT(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!Sn(s[c],a[c])))return!1;return!0}(n,e);default:return q()}}function uu(n,e){return(n.values||[]).find(t=>Sn(t,e))!==void 0}function Vr(n,e){if(n===e)return 0;let t=bi(n),r=bi(e);if(t!==r)return re(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return re(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=Me(o.integerValue||o.doubleValue),c=Me(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return LT(n.timestampValue,e.timestampValue);case 4:return LT(au(n),au(e));case 5:return re(n.stringValue,e.stringValue);case 6:return function(o,s){let a=Fr(o),c=Fr(s);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),c=s.split("/");for(let l=0;l<a.length&&l<c.length;l++){let h=re(a[l],c[l]);if(h!==0)return h}return re(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=re(Me(o.latitude),Me(s.latitude));return a!==0?a:re(Me(o.longitude),Me(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return VT(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,c,l,h;let p=o.fields||{},m=s.fields||{},v=(a=p.value)===null||a===void 0?void 0:a.arrayValue,b=(c=m.value)===null||c===void 0?void 0:c.arrayValue,M=re(((l=v?.values)===null||l===void 0?void 0:l.length)||0,((h=b?.values)===null||h===void 0?void 0:h.length)||0);return M!==0?M:VT(v,b)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Nr.mapValue&&s===Nr.mapValue)return 0;if(o===Nr.mapValue)return 1;if(s===Nr.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),l=s.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){let m=re(c[p],h[p]);if(m!==0)return m;let v=Vr(a[c[p]],l[h[p]]);if(v!==0)return v}return re(c.length,h.length)}(n.mapValue,e.mapValue);default:throw q()}}function LT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return re(n,e);let t=Zn(n),r=Zn(e),i=re(t.seconds,r.seconds);return i!==0?i:re(t.nanos,r.nanos)}function VT(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Vr(t[i],r[i]);if(o)return o}return re(t.length,r.length)}function ts(n){return Pm(n)}function Pm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Zn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Fr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return U.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Pm(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${Pm(t.fields[s])}`;return i+"}"}(n.mapValue):q()}function Si(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function km(n){return!!n&&"integerValue"in n}function cu(n){return!!n&&"arrayValue"in n}function jT(n){return!!n&&"nullValue"in n}function BT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function nd(n){return!!n&&"mapValue"in n}function rh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Xa(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Li(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Xa(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Xa(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Q0(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Y0={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function FF(n){return"nullValue"in n?td:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Si(Lr.empty(),U.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?rh(n)?Y0:{mapValue:{}}:q()}function LF(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Si(Lr.empty(),U.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Y0:"mapValue"in n?rh(n)?{mapValue:{}}:Nr:q()}function UT(n,e){let t=Vr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function $T(n,e){let t=Vr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var pt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!nd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xa(t)}setAll(e){let t=$e.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=Xa(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());nd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Sn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];nd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Li(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Xa(this.value))}};function Z0(n){let e=[];return Li(n.fields,(t,r)=>{let i=new $e([t]);if(nd(r)){let o=Z0(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new jt(e)}var Qe=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,K.min(),K.min(),K.min(),pt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,K.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,K.min(),K.min(),pt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,K.min(),K.min(),pt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var An=class{constructor(e,t){this.position=e,this.inclusive=t}};function HT(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=U.comparator(U.fromName(s.referenceValue),t.key):r=Vr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function qT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Sn(n.position[t],e.position[t]))return!1;return!0}var Ai=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function VF(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var hd=class{},ce=class n extends hd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Lm(e,t,r):t==="array-contains"?new Bm(e,r):t==="in"?new fd(e,r):t==="not-in"?new Um(e,r):t==="array-contains-any"?new $m(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Vm(e,r):new jm(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Vr(t,this.value)):t!==null&&bi(this.value)===bi(t)&&this.matchesComparison(Vr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},_e=class n extends hd{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return ns(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function ns(n){return n.op==="and"}function Om(n){return n.op==="or"}function Cv(n){return J0(n)&&ns(n)}function J0(n){for(let e of n.filters)if(e instanceof _e)return!1;return!0}function Fm(n){if(n instanceof ce)return n.field.canonicalString()+n.op.toString()+ts(n.value);if(Cv(n))return n.filters.map(e=>Fm(e)).join(",");{let e=n.filters.map(t=>Fm(t)).join(",");return`${n.op}(${e})`}}function X0(n,e){return n instanceof ce?function(r,i){return i instanceof ce&&r.op===i.op&&r.field.isEqual(i.field)&&Sn(r.value,i.value)}(n,e):n instanceof _e?function(r,i){return i instanceof _e&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&X0(s,i.filters[a]),!0):!1}(n,e):void q()}function eb(n,e){let t=n.filters.concat(e);return _e.create(t,n.op)}function tb(n){return n instanceof ce?function(t){return`${t.field.canonicalString()} ${t.op} ${ts(t.value)}`}(n):n instanceof _e?function(t){return t.op.toString()+" {"+t.getFilters().map(tb).join(" ,")+"}"}(n):"Filter"}var Lm=class extends ce{constructor(e,t,r){super(e,t,r),this.key=U.fromName(r.referenceValue)}matches(e){let t=U.comparator(e.key,this.key);return this.matchesComparison(t)}},Vm=class extends ce{constructor(e,t){super(e,"in",t),this.keys=nb("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},jm=class extends ce{constructor(e,t){super(e,"not-in",t),this.keys=nb("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function nb(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>U.fromName(r.referenceValue))}var Bm=class extends ce{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return cu(t)&&uu(t.arrayValue,this.value)}},fd=class extends ce{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&uu(this.value.arrayValue,t)}},Um=class extends ce{constructor(e,t){super(e,"not-in",t)}matches(e){if(uu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!uu(this.value.arrayValue,t)}},$m=class extends ce{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!cu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>uu(this.value.arrayValue,r))}};var Hm=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function qm(n,e=null,t=[],r=[],i=null,o=null,s=null){return new Hm(n,e,t,r,i,o,s)}function xi(n){let e=B(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Fm(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Tu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ts(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ts(r)).join(",")),e.ue=t}return e.ue}function bu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!VF(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!X0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!qT(n.startAt,e.startAt)&&qT(n.endAt,e.endAt)}function pd(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function gd(n,e){return n.filters.filter(t=>t instanceof ce&&t.field.isEqual(e))}function zT(n,e,t){let r=td,i=!0;for(let o of gd(n,e)){let s=td,a=!0;switch(o.op){case"<":case"<=":s=FF(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=td}UT({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];UT({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function GT(n,e,t){let r=Nr,i=!0;for(let o of gd(n,e)){let s=Nr,a=!0;switch(o.op){case">=":case">":s=LF(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Nr}$T({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];$T({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var un=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function rb(n,e,t,r,i,o,s,a){return new un(n,e,t,r,i,o,s,a)}function ys(n){return new un(n)}function WT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Tv(n){return n.collectionGroup!==null}function Zo(n){let e=B(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Ce($e.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Ai(o,r))}),t.has($e.keyField().canonicalString())||e.ce.push(new Ai($e.keyField(),r))}return e.ce}function Tt(n){let e=B(n);return e.le||(e.le=jF(e,Zo(n))),e.le}function jF(n,e){if(n.limitType==="F")return qm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Ai(i.field,o)});let t=n.endAt?new An(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new An(n.startAt.position,n.startAt.inclusive):null;return qm(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function zm(n,e){let t=n.filters.concat([e]);return new un(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function md(n,e,t){return new un(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Su(n,e){return bu(Tt(n),Tt(e))&&n.limitType===e.limitType}function ib(n){return`${xi(Tt(n))}|lt:${n.limitType}`}function zo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>tb(i)).join(", ")}]`),Tu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ts(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ts(i)).join(",")),`Target(${r})`}(Tt(n))}; limitType=${n.limitType})`}function Au(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):U.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of Zo(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,c){let l=HT(s,a,c);return s.inclusive?l<=0:l<0}(r.startAt,Zo(r),i)||r.endAt&&!function(s,a,c){let l=HT(s,a,c);return s.inclusive?l>=0:l>0}(r.endAt,Zo(r),i))}(n,e)}function ob(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function sb(n){return(e,t)=>{let r=!1;for(let i of Zo(n)){let o=BF(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function BF(n,e,t){let r=n.field.isKeyField()?U.comparator(e.key,t.key):function(o,s,a){let c=s.data.field(o),l=a.data.field(o);return c!==null&&l!==null?Vr(c,l):q()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return q()}}var xn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Li(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return W0(this.inner)}size(){return this.innerSize}};var UF=new Re(U.comparator);function Mt(){return UF}var ab=new Re(U.comparator);function Za(...n){let e=ab;for(let t of n)e=e.insert(t.key,t);return e}function ub(n){let e=ab;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Dn(){return eu()}function cb(){return eu()}function eu(){return new xn(n=>n.toString(),(n,e)=>n.isEqual(e))}var $F=new Re(U.comparator),HF=new Ce(U.comparator);function ie(...n){let e=HF;for(let t of n)e=e.add(t);return e}var qF=new Ce(re);function bv(){return qF}function Sv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ou(e)?"-0":e}}function lb(n){return{integerValue:""+n}}function db(n,e){return $0(e)?lb(e):Sv(n,e)}var rs=class{constructor(){this._=void 0}};function zF(n,e,t){return n instanceof jr?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&nh(o)&&(o=Dv(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof Jn?fb(n,e):n instanceof Xn?pb(n,e):function(i,o){let s=hb(i,o),a=KT(s)+KT(i.Pe);return km(s)&&km(i.Pe)?lb(a):Sv(i.serializer,a)}(n,e)}function GF(n,e,t){return n instanceof Jn?fb(n,e):n instanceof Xn?pb(n,e):t}function hb(n,e){return n instanceof Br?function(r){return km(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var jr=class extends rs{},Jn=class extends rs{constructor(e){super(),this.elements=e}};function fb(n,e){let t=gb(e);for(let r of n.elements)t.some(i=>Sn(i,r))||t.push(r);return{arrayValue:{values:t}}}var Xn=class extends rs{constructor(e){super(),this.elements=e}};function pb(n,e){let t=gb(e);for(let r of n.elements)t=t.filter(i=>!Sn(i,r));return{arrayValue:{values:t}}}var Br=class extends rs{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function KT(n){return Me(n.integerValue||n.doubleValue)}function gb(n){return cu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Ri=class{constructor(e,t){this.field=e,this.transform=t}};function WF(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Jn&&i instanceof Jn||r instanceof Xn&&i instanceof Xn?Xo(r.elements,i.elements,Sn):r instanceof Br&&i instanceof Br?Sn(r.Pe,i.Pe):r instanceof jr&&i instanceof jr}(n.transform,e.transform)}var Gm=class{constructor(e,t){this.version=e,this.transformResults=t}},je=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function rd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var is=class{};function mb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new $r(n.key,je.none()):new Ur(n.key,n.data,je.none());{let t=n.data,r=pt.empty(),i=new Ce($e.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new cn(n.key,r,new jt(i.toArray()),je.none())}}function KF(n,e,t){n instanceof Ur?function(i,o,s){let a=i.value.clone(),c=YT(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof cn?function(i,o,s){if(!rd(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=YT(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(yb(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function tu(n,e,t,r){return n instanceof Ur?function(o,s,a,c){if(!rd(o.precondition,s))return a;let l=o.value.clone(),h=ZT(o.fieldTransforms,c,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof cn?function(o,s,a,c){if(!rd(o.precondition,s))return a;let l=ZT(o.fieldTransforms,c,s),h=s.data;return h.setAll(yb(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(o,s,a){return rd(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function QF(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=hb(r.transform,i||null);o!=null&&(t===null&&(t=pt.empty()),t.set(r.field,o))}return t||null}function QT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Xo(r,i,(o,s)=>WF(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ur=class extends is{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},cn=class extends is{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function yb(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function YT(n,e,t){let r=new Map;G(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,GF(s,a,t[i]))}return r}function ZT(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,zF(o,s,e))}return r}var $r=class extends is{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},lu=class extends is{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var du=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&KF(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=tu(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=tu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=cb();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=mb(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ie())}isEqual(e){return this.batchId===e.batchId&&Xo(this.mutations,e.mutations,(t,r)=>QT(t,r))&&Xo(this.baseMutations,e.baseMutations,(t,r)=>QT(t,r))}},Wm=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){G(e.mutations.length===r.length);let i=function(){return $F}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var hu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Km=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ge,fe;function vb(n){switch(n){default:return q();case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0}}function wb(n){if(n===void 0)return Ue("GRPC error has no .code"),x.UNKNOWN;switch(n){case Ge.OK:return x.OK;case Ge.CANCELLED:return x.CANCELLED;case Ge.UNKNOWN:return x.UNKNOWN;case Ge.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case Ge.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case Ge.INTERNAL:return x.INTERNAL;case Ge.UNAVAILABLE:return x.UNAVAILABLE;case Ge.UNAUTHENTICATED:return x.UNAUTHENTICATED;case Ge.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case Ge.NOT_FOUND:return x.NOT_FOUND;case Ge.ALREADY_EXISTS:return x.ALREADY_EXISTS;case Ge.PERMISSION_DENIED:return x.PERMISSION_DENIED;case Ge.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case Ge.ABORTED:return x.ABORTED;case Ge.OUT_OF_RANGE:return x.OUT_OF_RANGE;case Ge.UNIMPLEMENTED:return x.UNIMPLEMENTED;case Ge.DATA_LOSS:return x.DATA_LOSS;default:return q()}}(fe=Ge||(Ge={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";var JT=null;function _b(){return new TextEncoder}var YF=new Sr([4294967295,4294967295],0);function XT(n){let e=_b().encode(n),t=new cm;return t.update(e),new Uint8Array(t.digest())}function e0(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Sr([t,r],0),new Sr([i,o],0)]}var Qm=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ci(`Invalid padding: ${t}`);if(r<0)throw new Ci(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ci(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ci(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Sr.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Sr.fromNumber(r)));return i.compare(YF)===1&&(i=new Sr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=XT(e),[r,i]=e0(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Ie===0)return;let t=XT(e),[r,i]=e0(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ci=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var fu=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,pu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(K.min(),i,new Re(re),Mt(),ie())}},pu=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ie(),ie(),ie())}};var Jo=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},yd=class{constructor(e,t){this.targetId=e,this.me=t}},vd=class{constructor(e,t,r=qe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},wd=class{constructor(){this.fe=0,this.ge=n0(),this.pe=qe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ie(),t=ie(),r=ie();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:q()}}),new pu(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=n0()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,G(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Ym=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Mt(),this.qe=t0(),this.Qe=new Re(re)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(pd(o))if(r===0){let s=new U(o.path);this.Ue(t,s,Qe.newNoDocument(s,K.min()))}else G(r===1);else{let s=this.Ye(t);if(s!==r){let a=this.Ze(e),c=a?this.Xe(a,e,s):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}JT?.et(function(h,p,m,v,b){var M,N,j,H,F,Q;let ee={localCacheCount:h,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},Y=p.unchangedNames;return Y&&(ee.bloomFilter={applied:b===0,hashCount:(M=Y?.hashCount)!==null&&M!==void 0?M:0,bitmapLength:(H=(j=(N=Y?.bits)===null||N===void 0?void 0:N.bitmap)===null||j===void 0?void 0:j.length)!==null&&H!==void 0?H:0,padding:(Q=(F=Y?.bits)===null||F===void 0?void 0:F.padding)!==null&&Q!==void 0?Q:0,mightContain:I=>{var y;return(y=v?.mightContain(I))!==null&&y!==void 0&&y}}),ee}(s,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=Fr(r).toUint8Array()}catch(c){if(c instanceof dd)return an("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Qm(s,i,o)}catch(c){return an(c instanceof Ci?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Le.tt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,s)=>{let a=this.Je(s);if(a){if(o.current&&pd(a.target)){let c=new U(a.target.path);this.ke.get(c)!==null||this.it(s,c)||this.Ue(s,c,Qe.newNoDocument(c,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=ie();this.qe.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new fu(e,t,this.Qe,this.ke,r);return this.ke=Mt(),this.qe=t0(),this.Qe=new Re(re),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new wd,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ce(re),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new wd),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function t0(){return new Re(U.comparator)}function n0(){return new Re(U.comparator)}var ZF={asc:"ASCENDING",desc:"DESCENDING"},JF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XF={and:"AND",or:"OR"},Zm=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Jm(n,e){return n.useProto3Json||Tu(e)?e:{value:e}}function os(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ib(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function eL(n,e){return os(n,e.toTimestamp())}function He(n){return G(!!n),K.fromTimestamp(function(t){let r=Zn(t);return new ke(r.seconds,r.nanos)}(n))}function Av(n,e){return Xm(n,e).canonicalString()}function Xm(n,e){let t=function(i){return new pe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Eb(n){let e=pe.fromString(n);return G(Nb(e)),e}function gu(n,e){return Av(n.databaseId,e.path)}function Tn(n,e){let t=Eb(e);if(t.get(1)!==n.databaseId.projectId)throw new P(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new U(Tb(t))}function Db(n,e){return Av(n.databaseId,e)}function Cb(n){let e=Eb(n);return e.length===4?pe.emptyPath():Tb(e)}function ey(n){return new pe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Tb(n){return G(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function r0(n,e,t){return{name:gu(n,e),fields:t.value.mapValue.fields}}function bb(n,e,t){let r=Tn(n,e.name),i=He(e.updateTime),o=e.createTime?He(e.createTime):K.min(),s=new pt({mapValue:{fields:e.fields}}),a=Qe.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function tL(n,e){return"found"in e?function(r,i){G(!!i.found),i.found.name,i.found.updateTime;let o=Tn(r,i.found.name),s=He(i.found.updateTime),a=i.found.createTime?He(i.found.createTime):K.min(),c=new pt({mapValue:{fields:i.found.fields}});return Qe.newFoundDocument(o,s,a,c)}(n,e):"missing"in e?function(r,i){G(!!i.missing),G(!!i.readTime);let o=Tn(r,i.missing),s=He(i.readTime);return Qe.newNoDocument(o,s)}(n,e):q()}function nL(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(l,h){return l.useProto3Json?(G(h===void 0||typeof h=="string"),qe.fromBase64String(h||"")):(G(h===void 0||h instanceof Buffer||h instanceof Uint8Array),qe.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){let h=l.code===void 0?x.UNKNOWN:wb(l.code);return new P(h,l.message||"")}(s);t=new vd(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Tn(n,r.document.name),o=He(r.document.updateTime),s=r.document.createTime?He(r.document.createTime):K.min(),a=new pt({mapValue:{fields:r.document.fields}}),c=Qe.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new Jo(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Tn(n,r.document),o=r.readTime?He(r.readTime):K.min(),s=Qe.newNoDocument(i,o),a=r.removedTargetIds||[];t=new Jo([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Tn(n,r.document),o=r.removedTargetIds||[];t=new Jo([],o,i,null)}else{if(!("filter"in e))return q();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new Km(i,o),a=r.targetId;t=new yd(a,s)}}return t}function mu(n,e){let t;if(e instanceof Ur)t={update:r0(n,e.key,e.value)};else if(e instanceof $r)t={delete:gu(n,e.key)};else if(e instanceof cn)t={update:r0(n,e.key,e.data),updateMask:uL(e.fieldMask)};else{if(!(e instanceof lu))return q();t={verify:gu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof jr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Jn)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Xn)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Br)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw q()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:eL(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:q()}(n,e.precondition)),t}function ty(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?je.updateTime(He(o.updateTime)):o.exists!==void 0?je.exists(o.exists):je.none()}(e.currentDocument):je.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let c=null;if("setToServerValue"in a)G(a.setToServerValue==="REQUEST_TIME"),c=new jr;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];c=new Jn(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];c=new Xn(h)}else"increment"in a?c=new Br(s,a.increment):q();let l=$e.fromServerFormat(a.fieldPath);return new Ri(l,c)}(n,i)):[];if(e.update){e.update.name;let i=Tn(n,e.update.name),o=new pt({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(c){let l=c.fieldPaths||[];return new jt(l.map(h=>$e.fromServerFormat(h)))}(e.updateMask);return new cn(i,o,s,t,r)}return new Ur(i,o,t,r)}if(e.delete){let i=Tn(n,e.delete);return new $r(i,t)}if(e.verify){let i=Tn(n,e.verify);return new lu(i,t)}return q()}function rL(n,e){return n&&n.length>0?(G(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?He(i.updateTime):He(o);return s.isEqual(K.min())&&(s=He(o)),new Gm(s,i.transformResults||[])}(t,e))):[]}function Sb(n,e){return{documents:[Db(n,e.path)]}}function Ab(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Db(n,i);let o=function(l){if(l.length!==0)return Mb(_e.create(l,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(l){if(l.length!==0)return l.map(h=>function(m){return{field:Go(m.field),direction:oL(m.dir)}}(h))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Jm(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function xb(n){let e=Cb(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){G(r===1);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(p){let m=Rb(p);return m instanceof _e&&Cv(m)?m.getFilters():[m]}(t.where));let s=[];t.orderBy&&(s=function(p){return p.map(m=>function(b){return new Ai(Wo(b.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,Tu(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,v=p.values||[];return new An(v,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,v=p.values||[];return new An(v,m)}(t.endAt)),rb(e,i,s,o,a,"F",c,l)}function iL(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Rb(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Wo(t.unaryFilter.field);return ce.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Wo(t.unaryFilter.field);return ce.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Wo(t.unaryFilter.field);return ce.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Wo(t.unaryFilter.field);return ce.create(s,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(n):n.fieldFilter!==void 0?function(t){return ce.create(Wo(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return _e.create(t.compositeFilter.filters.map(r=>Rb(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return q()}}(t.compositeFilter.op))}(n):q()}function oL(n){return ZF[n]}function sL(n){return JF[n]}function aL(n){return XF[n]}function Go(n){return{fieldPath:n.canonicalString()}}function Wo(n){return $e.fromServerFormat(n.fieldPath)}function Mb(n){return n instanceof ce?function(t){if(t.op==="=="){if(BT(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NAN"}};if(jT(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(BT(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NOT_NAN"}};if(jT(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Go(t.field),op:sL(t.op),value:t.value}}}(n):n instanceof _e?function(t){let r=t.getFilters().map(i=>Mb(i));return r.length===1?r[0]:{compositeFilter:{op:aL(t.op),filters:r}}}(n):q()}function uL(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Nb(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ss=class n{constructor(e,t,r,i,o=K.min(),s=K.min(),a=qe.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var _d=class{constructor(e){this.ct=e}};function cL(n,e){let t;if(e.document)t=bb(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=U.fromSegments(e.noDocument.path),i=Ni(e.noDocument.readTime);t=Qe.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return q();{let r=U.fromSegments(e.unknownDocument.path),i=Ni(e.unknownDocument.version);t=Qe.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new ke(i[0],i[1]);return K.fromTimestamp(o)}(e.readTime)),t}function i0(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Id(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:gu(o,s.key),fields:s.data.value.mapValue.fields,updateTime:os(o,s.version.toTimestamp()),createTime:os(o,s.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Mi(e.version)};else{if(!e.isUnknownDocument())return q();r.unknownDocument={path:t.path.toArray(),version:Mi(e.version)}}return r}function Id(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Mi(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ni(n){let e=new ke(n.seconds,n.nanoseconds);return K.fromTimestamp(e)}function Ii(n,e){let t=(e.baseMutations||[]).map(o=>ty(n.ct,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>ty(n.ct,o)),i=ke.fromMillis(e.localWriteTimeMs);return new du(e.batchId,i,t,r)}function Ja(n){let e=Ni(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ni(n.lastLimboFreeSnapshotVersion):K.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return G(o.documents.length===1),Tt(ys(Cb(o.documents[0])))}(n.query):function(o){return Tt(xb(o))}(n.query),new ss(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,qe.fromBase64String(n.resumeToken))}function Pb(n,e){let t=Mi(e.snapshotVersion),r=Mi(e.lastLimboFreeSnapshotVersion),i;i=pd(e.target)?Sb(n.ct,e.target):Ab(n.ct,e.target)._t;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:xi(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function xv(n){let e=xb({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?md(e,e.limit,"L"):e}function gm(n,e){return new hu(e.largestBatchId,ty(n.ct,e.overlayMutation))}function o0(n,e){let t=e.path.lastSegment();return[n,Ct(e.path.popLast()),t]}function s0(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Mi(r.readTime),documentKey:Ct(r.documentKey.path),largestBatchId:r.largestBatchId}}var ny=class{getBundleMetadata(e,t){return a0(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:Ni(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return a0(e).put(function(i){return{bundleId:i.id,createTime:Mi(He(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return u0(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:xv(o.bundledQuery),readTime:Ni(o.readTime)}}(r)})}saveNamedQuery(e,t){return u0(e).put(function(i){return{name:i.name,readTime:Mi(He(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function a0(n){return et(n,"bundles")}function u0(n){return et(n,"namedQueries")}var Ed=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Wa(e).get(o0(this.userId,t)).next(r=>r?gm(this.serializer,r):null)}getOverlays(e,t){let r=Dn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new hu(t,s);i.push(this.ht(e,a))}),S.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(Ct(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Wa(e).j("collectionPathOverlayIndex",a))}),S.waitFor(o)}getOverlaysForCollection(e,t,r){let i=Dn(),o=Ct(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Wa(e).U("collectionPathOverlayIndex",s).next(a=>{for(let c of a){let l=gm(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=Dn(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Wa(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,h)=>{let p=gm(this.serializer,l);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}ht(e,t){return Wa(e).put(function(i,o,s){let[a,c,l]=o0(o,s.mutation.key);return{userId:o,collectionPath:c,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:mu(i.ct,s.mutation)}}(this.serializer,this.userId,t))}};function Wa(n){return et(n,"documentOverlays")}var ry=class{Pt(e){return et(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?qe.fromUint8Array(r):qe.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Qn=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Me(e.integerValue));else if("doubleValue"in e){let r=Me(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),ou(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Zn(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Fr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Q0(e)?this.dt(t,Number.MAX_SAFE_INTEGER):rh(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):q()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Me(a)),this.Vt(s,t),this.Tt(o[s],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),U.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Qn.vt=new Qn;function lL(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function c0(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=lL(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var iy=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=c0(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=c0(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},oy=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},sy=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},Ei=class{constructor(){this.jt=new iy,this.Ht=new oy(this.jt),this.Jt=new sy(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var Di=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Ar(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=l0(n.arrayValue,e.arrayValue),t!==0?t:(t=l0(n.directionalValue,e.directionalValue),t!==0?t:U.comparator(n.documentKey,e.documentKey)))}function l0(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Dd=class{constructor(e){this.Xt=new Ce((t,r)=>$e.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(G(e.collectionGroup===this.collectionId),this.nn)return!1;let t=Sm(e);if(t!==void 0&&!this.sn(t))return!1;let r=wi(e),i=new Set,o=0,s=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[o];if(!this.on(a,c)||!this._n(this.en[s++],c))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.en.length||!this._n(this.en[s++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Ce($e.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Yo(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Yo(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Yo(r.field,r.dir==="asc"?0:1)));return new es(es.UNKNOWN_ID,this.collectionId,t,iu.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function kb(n){var e,t;if(G(n instanceof ce||n instanceof _e),n instanceof ce){if(n instanceof fd){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>ce.create(n.field,"==",o)))||[];return _e.create(i,"or")}return n}let r=n.filters.map(i=>kb(i));return _e.create(r,n.op)}function dL(n){if(n.getFilters().length===0)return[];let e=cy(kb(n));return G(Ob(e)),ay(e)||uy(e)?[e]:e.getFilters()}function ay(n){return n instanceof ce}function uy(n){return n instanceof _e&&Cv(n)}function Ob(n){return ay(n)||uy(n)||function(t){if(t instanceof _e&&Om(t)){for(let r of t.getFilters())if(!ay(r)&&!uy(r))return!1;return!0}return!1}(n)}function cy(n){if(G(n instanceof ce||n instanceof _e),n instanceof ce)return n;if(n.filters.length===1)return cy(n.filters[0]);let e=n.filters.map(r=>cy(r)),t=_e.create(e,n.op);return t=Cd(t),Ob(t)?t:(G(t instanceof _e),G(ns(t)),G(t.filters.length>1),t.filters.reduce((r,i)=>Rv(r,i)))}function Rv(n,e){let t;return G(n instanceof ce||n instanceof _e),G(e instanceof ce||e instanceof _e),t=n instanceof ce?e instanceof ce?function(i,o){return _e.create([i,o],"and")}(n,e):d0(n,e):e instanceof ce?d0(e,n):function(i,o){if(G(i.filters.length>0&&o.filters.length>0),ns(i)&&ns(o))return eb(i,o.getFilters());let s=Om(i)?i:o,a=Om(i)?o:i,c=s.filters.map(l=>Rv(l,a));return _e.create(c,"or")}(n,e),Cd(t)}function d0(n,e){if(ns(e))return eb(e,n.getFilters());{let t=e.filters.map(r=>Rv(n,r));return _e.create(t,"or")}}function Cd(n){if(G(n instanceof ce||n instanceof _e),n instanceof ce)return n;let e=n.getFilters();if(e.length===1)return Cd(e[0]);if(J0(n))return n;let t=e.map(i=>Cd(i)),r=[];return t.forEach(i=>{i instanceof ce?r.push(i):i instanceof _e&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:_e.create(r,n.op)}var ly=class{constructor(){this.un=new yu}addToCollectionParentIndex(e,t){return this.un.add(t),S.resolve()}getCollectionParents(e,t){return S.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return S.resolve()}deleteFieldIndex(e,t){return S.resolve()}deleteAllFieldIndexes(e){return S.resolve()}createTargetIndexes(e,t){return S.resolve()}getDocumentsMatchingTarget(e,t){return S.resolve(null)}getIndexType(e,t){return S.resolve(0)}getFieldIndexes(e,t){return S.resolve([])}getNextCollectionGroupToUpdate(e){return S.resolve(null)}getMinOffset(e,t){return S.resolve(Yt.min())}getMinOffsetFromCollectionGroup(e,t){return S.resolve(Yt.min())}updateCollectionGroup(e,t,r){return S.resolve()}updateIndexEntries(e,t){return S.resolve()}},yu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ce(pe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ce(pe.comparator)).toArray()}};var Yl=new Uint8Array(0),dy=class{constructor(e,t){this.databaseId=t,this.cn=new yu,this.ln=new xn(r=>xi(r),(r,i)=>bu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let o={collectionId:r,parent:Ct(i)};return h0(e).put(o)}return S.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[L0(t),""],!1,!0);return h0(e).U(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(En(s.parent))}return r})}addFieldIndex(e,t){let r=Ka(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=$o(e);return o.next(a=>{s.put(s0(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=Ka(e),i=$o(e),o=Uo(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Ka(e),r=Uo(e),i=$o(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return S.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new Dd(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=Uo(e),i=!0,o=new Map;return S.forEach(this.hn(t),s=>this.Pn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=ie(),a=[];return S.forEach(o,(c,l)=>{k("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(Q=>`${Q.fieldPath}:${Q.kind}`).join(",")}`}(c)} to execute ${xi(t)}`);let h=function(F,Q){let ee=Sm(Q);if(ee===void 0)return null;for(let Y of gd(F,ee.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(l,c),p=function(F,Q){let ee=new Map;for(let Y of wi(Q))for(let I of gd(F,Y.fieldPath))switch(I.op){case"==":case"in":ee.set(Y.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return ee.set(Y.fieldPath.canonicalString(),I.value),Array.from(ee.values())}return null}(l,c),m=function(F,Q){let ee=[],Y=!0;for(let I of wi(Q)){let y=I.kind===0?zT(F,I.fieldPath,F.startAt):GT(F,I.fieldPath,F.startAt);ee.push(y.value),Y&&(Y=y.inclusive)}return new An(ee,Y)}(l,c),v=function(F,Q){let ee=[],Y=!0;for(let I of wi(Q)){let y=I.kind===0?GT(F,I.fieldPath,F.endAt):zT(F,I.fieldPath,F.endAt);ee.push(y.value),Y&&(Y=y.inclusive)}return new An(ee,Y)}(l,c),b=this.In(c,l,m),M=this.In(c,l,v),N=this.Tn(c,l,p),j=this.En(c.indexId,h,b,m.inclusive,M,v.inclusive,N);return S.forEach(j,H=>r.G(H,t.limit).next(F=>{F.forEach(Q=>{let ee=U.fromSegments(Q.documentKey);s.has(ee)||(s=s.add(ee),a.push(ee))})}))}).next(()=>a)}return S.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=dL(_e.create(e.filters,"and")).map(r=>qm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,o,s,a){let c=(t!=null?t.length:1)*Math.max(r.length,o.length),l=c/(t!=null?t.length:1),h=[];for(let p=0;p<c;++p){let m=t?this.dn(t[p/l]):Yl,v=this.An(e,m,r[p%l],i),b=this.Rn(e,m,o[p%l],s),M=a.map(N=>this.An(e,m,N,!0));h.push(...this.createRange(v,b,M))}return h}An(e,t,r,i){let o=new Di(e,U.empty(),t,r);return i?o:o.Zt()}Rn(e,t,r,i){let o=new Di(e,U.empty(),t,r);return i?o.Zt():o}Pn(e,t){let r=new Dd(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.rn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.hn(t);return S.forEach(i,o=>this.Pn(e,o).next(s=>{s?r!==0&&s.fields.length<function(c){let l=new Ce($e.comparator),h=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:l=l.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new Ei;for(let i of wi(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Yt(i.kind);Qn.vt.It(o,s)}return r.zt()}dn(e){let t=new Ei;return Qn.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new Ei;return Qn.vt.It(Si(this.databaseId,t),r.Yt(function(o){let s=wi(o);return s.length===0?0:s[s.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new Ei);let o=0;for(let s of wi(e)){let a=r[o++];for(let c of i)if(this.fn(t,s.fieldPath)&&cu(a))i=this.gn(i,s,a);else{let l=c.Yt(s.kind);Qn.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let c=new Ei;c.seed(a.zt()),Qn.vt.It(s,c.Yt(t.kind)),o.push(c)}return o}fn(e,t){return!!e.filters.find(r=>r instanceof ce&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Ka(e),i=$o(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{let s=[];return S.forEach(o,a=>i.get([a.indexId,this.uid]).next(c=>{s.push(function(h,p){let m=p?new iu(p.sequenceNumber,new Yt(Ni(p.readTime),new U(En(p.documentKey)),p.largestBatchId)):iu.empty(),v=h.fields.map(([b,M])=>new Yo($e.fromServerFormat(b),M));return new es(h.indexId,h.collectionGroup,v,m)}(a,c))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:re(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Ka(e),o=$o(e);return this.yn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>S.forEach(a,c=>o.put(s0(c.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return S.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?S.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),S.forEach(a,c=>this.wn(e,i,c).next(l=>{let h=this.Sn(o,c);return l.isEqual(h)?S.resolve():this.bn(e,o,c,l,h)}))))})}Dn(e,t,r,i){return Uo(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return Uo(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=Uo(e),o=new Ce(Ar);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(s,a)=>{o=o.add(new Di(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Sn(e,t){let r=new Ce(Ar),i=this.Vn(t,e);if(i==null)return r;let o=Sm(t);if(o!=null){let s=e.data.field(o.fieldPath);if(cu(s))for(let a of s.arrayValue.values||[])r=r.add(new Di(t.indexId,e.key,this.dn(a),i))}else r=r.add(new Di(t.indexId,e.key,Yl,i));return r}bn(e,t,r,i,o){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(c,l,h,p,m){let v=c.getIterator(),b=l.getIterator(),M=Bo(v),N=Bo(b);for(;M||N;){let j=!1,H=!1;if(M&&N){let F=h(M,N);F<0?H=!0:F>0&&(j=!0)}else M!=null?H=!0:j=!0;j?(p(N),N=Bo(b)):H?(m(M),M=Bo(v)):(M=Bo(v),N=Bo(b))}}(i,o,Ar,a=>{s.push(this.Dn(e,t,r,a))},a=>{s.push(this.vn(e,t,r,a))}),S.waitFor(s)}yn(e){let t=1;return $o(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>Ar(s,a)).filter((s,a,c)=>!a||Ar(s,c[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=Ar(s,e),c=Ar(s,t);if(a===0)i[0]=e.Zt();else if(a>0&&c<0)i.push(s),i.push(s.Zt());else if(c>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,Yl,[]],c=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,Yl,[]];o.push(IDBKeyRange.bound(a,c))}return o}Cn(e,t){return Ar(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(f0)}getMinOffset(e,t){return S.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||q())).next(f0)}};function h0(n){return et(n,"collectionParents")}function Uo(n){return et(n,"indexEntries")}function Ka(n){return et(n,"indexConfiguration")}function $o(n){return et(n,"indexState")}function f0(n){G(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;_v(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Yt(e.readTime,e.documentKey,t)}var p0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Qt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function Fb(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:s},(h,p,m)=>(a++,m.delete()));o.push(c.next(()=>{G(a===1)}));let l=[];for(let h of t.mutations){let p=H0(e,h.key.path,t.batchId);o.push(i.delete(p)),l.push(h.key)}return S.waitFor(o).next(()=>l)}function Td(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw q();e=n.noDocument}return JSON.stringify(e).length}Qt.DEFAULT_COLLECTION_PERCENTILE=10,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qt.DEFAULT=new Qt(41943040,Qt.DEFAULT_COLLECTION_PERCENTILE,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qt.DISABLED=new Qt(-1,0,0);var bd=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){G(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xr(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=Ko(e),s=xr(e);return s.add({}).next(a=>{G(typeof a=="number");let c=new du(a,t,r,i),l=function(v,b,M){let N=M.baseMutations.map(H=>mu(v.ct,H)),j=M.mutations.map(H=>mu(v.ct,H));return{userId:b,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:N,mutations:j}}(this.serializer,this.userId,c),h=[],p=new Ce((m,v)=>re(m.canonicalString(),v.canonicalString()));for(let m of i){let v=H0(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),h.push(s.put(l)),h.push(o.put(v,yF))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),S.waitFor(h).next(()=>c)})}lookupMutationBatch(e,t){return xr(e).get(t).next(r=>r?(G(r.userId===this.userId),Ii(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?S.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return xr(e).J({index:"userMutationsIndex",range:i},(s,a,c)=>{a.userId===this.userId&&(G(a.batchId>=r),o=Ii(this.serializer,a)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return xr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return xr(e).U("userMutationsIndex",t).next(r=>r.map(i=>Ii(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=ed(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Ko(e).J({range:i},(s,a,c)=>{let[l,h,p]=s,m=En(h);if(l===this.userId&&t.path.isEqual(m))return xr(e).get(p).next(v=>{if(!v)throw q();G(v.userId===this.userId),o.push(Ii(this.serializer,v))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ce(re),i=[];return t.forEach(o=>{let s=ed(this.userId,o.path),a=IDBKeyRange.lowerBound(s),c=Ko(e).J({range:a},(l,h,p)=>{let[m,v,b]=l,M=En(v);m===this.userId&&o.path.isEqual(M)?r=r.add(b):p.done()});i.push(c)}),S.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=ed(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Ce(re);return Ko(e).J({range:s},(c,l,h)=>{let[p,m,v]=c,b=En(m);p===this.userId&&r.isPrefixOf(b)?b.length===i&&(a=a.add(v)):h.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(xr(e).get(o).next(s=>{if(s===null)throw q();G(s.userId===this.userId),r.push(Ii(this.serializer,s))}))}),S.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Fb(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),S.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return S.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return Ko(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){let c=En(o[1]);i.push(c)}else a.done()}).next(()=>{G(i.length===0)})})}containsKey(e,t){return Lb(e,this.userId,t)}Nn(e){return Vb(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function Lb(n,e,t){let r=ed(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ko(n).J({range:o,H:!0},(a,c,l)=>{let[h,p,m]=a;h===e&&p===i&&(s=!0),l.done()}).next(()=>s)}function xr(n){return et(n,"mutations")}function Ko(n){return et(n,"documentMutations")}function Vb(n){return et(n,"mutationQueues")}var as=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var hy=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new as(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>K.fromTimestamp(new ke(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ho(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(G(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,o=[];return Ho(e).J((s,a)=>{let c=Ja(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,o.push(this.removeTargetData(e,c)))}).next(()=>S.waitFor(o)).next(()=>i)}forEachTarget(e,t){return Ho(e).J((r,i)=>{let o=Ja(i);t(o)})}qn(e){return g0(e).get("targetGlobalKey").next(t=>(G(t!==null),t))}Qn(e,t){return g0(e).put("targetGlobalKey",t)}Kn(e,t){return Ho(e).put(Pb(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=xi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Ho(e).J({range:i,index:"queryTargetsIndex"},(s,a,c)=>{let l=Ja(a);bu(t,l.target)&&(o=l,c.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=Rr(e);return t.forEach(s=>{let a=Ct(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),S.waitFor(i)}removeMatchingKeys(e,t,r){let i=Rr(e);return S.forEach(t,o=>{let s=Ct(o.path);return S.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=Rr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Rr(e),o=ie();return i.J({range:r,H:!0},(s,a,c)=>{let l=En(s[1]),h=new U(l);o=o.add(h)}).next(()=>o)}containsKey(e,t){let r=Ct(t.path),i=IDBKeyRange.bound([r],[L0(r)],!1,!0),o=0;return Rr(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],c,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}ot(e,t){return Ho(e).get(t).next(r=>r?Ja(r):null)}};function Ho(n){return et(n,"targets")}function g0(n){return et(n,"targetGlobal")}function Rr(n){return et(n,"targetDocuments")}function m0([n,e],[t,r]){let i=re(n,t);return i===0?re(e,r):i}var fy=class{constructor(e){this.Un=e,this.buffer=new Ce(m0),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();m0(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},py=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>R(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){zr(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield qr(t)}yield this.Hn(3e5)}))}},gy=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return S.resolve(Vt.oe);let r=new fy(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve(p0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),p0):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,o,s,a,c,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(o=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),qo()<=hn.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),S.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function hL(n,e){return new gy(n,e)}var my=class{constructor(e,t){this.db=e,this.garbageCollector=hL(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Zl(e,r)}removeReference(e,t,r){return Zl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Zl(e,t)}nr(e,t){return function(i,o){let s=!1;return Vb(i).Y(a=>Lb(i,a,o).next(c=>(c&&(s=!0),S.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.tr(e,(s,a)=>{if(a<=t){let c=this.nr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,K.min()),Rr(e).delete(function(p){return[0,Ct(p.path)]}(s))))});i.push(c)}}).next(()=>S.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Zl(e,t)}tr(e,t){let r=Rr(e),i,o=Vt.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:c,sequenceNumber:l})=>{s===0?(o!==Vt.oe&&t(new U(En(i)),o),o=l,i=c):o=Vt.oe}).next(()=>{o!==Vt.oe&&t(new U(En(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Zl(n,e){return Rr(n).put(function(r,i){return{targetId:0,path:Ct(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Sd=class{constructor(){this.changes=new xn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?S.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var yy=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return vi(e).put(r)}removeEntry(e,t,r){return vi(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Id(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Qe.newInvalidDocument(t);return vi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Qa(t))},(i,o)=>{r=this.ir(t,o)}).next(()=>r)}sr(e,t){let r={size:0,document:Qe.newInvalidDocument(t)};return vi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Qa(t))},(i,o)=>{r={document:this.ir(t,o),size:Td(o)}}).next(()=>r)}getEntries(e,t){let r=Mt();return this._r(e,t,(i,o)=>{let s=this.ir(i,o);r=r.insert(i,s)}).next(()=>r)}ar(e,t){let r=Mt(),i=new Re(U.comparator);return this._r(e,t,(o,s)=>{let a=this.ir(o,s);r=r.insert(o,a),i=i.insert(o,Td(s))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return S.resolve();let i=new Ce(w0);t.forEach(c=>i=i.add(c));let o=IDBKeyRange.bound(Qa(i.first()),Qa(i.last())),s=i.getIterator(),a=s.getNext();return vi(e).J({index:"documentKeyIndex",range:o},(c,l,h)=>{let p=U.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&w0(a,p)<0;)r(a,null),a=s.getNext();a&&a.isEqual(p)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?h.$(Qa(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),Id(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return vi(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let h=Mt();for(let p of l){let m=this.ir(U.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Au(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,r,i){let o=Mt(),s=v0(t,r),a=v0(t,Yt.max());return vi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(c,l,h)=>{let p=this.ir(U.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new vy(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return y0(e).get("remoteDocumentGlobalKey").next(t=>(G(!!t),t))}rr(e,t){return y0(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=cL(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(K.min())))return r}return Qe.newInvalidDocument(e)}};function jb(n){return new yy(n)}var vy=class extends Sd{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new xn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ce((o,s)=>re(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,a.readTime)),s.isValidDocument()){let c=i0(this.cr.serializer,s);i=i.add(o.path.popLast());let l=Td(c);r+=l-a.size,t.push(this.cr.addEntry(e,o,c))}else if(r-=a.size,this.trackRemovals){let c=i0(this.cr.serializer,s.convertToNoDocument(K.min()));t.push(this.cr.addEntry(e,o,c))}}),i.forEach(o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.cr.updateMetadata(e,r)),S.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((o,s)=>{this.lr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function y0(n){return et(n,"remoteDocumentGlobal")}function vi(n){return et(n,"remoteDocumentsV14")}function Qa(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function v0(n,e){let t=e.documentKey.path.toArray();return[n,Id(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function w0(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=re(t[o],r[o]),i)return i;return i=re(t.length,r.length),i||(i=re(t[t.length-2],r[r.length-2]),i||re(t[t.length-1],r[r.length-1]))}var wy=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ad=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&tu(r.mutation,i,jt.empty(),ke.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ie()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ie()){let i=Dn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Za();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=Dn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ie()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=Mt(),s=eu(),a=function(){return eu()}();return t.forEach((c,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof cn)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),tu(h.mutation,l,h.mutation.getFieldMask(),ke.now())):s.set(l.key,jt.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((l,h)=>s.set(l,h)),t.forEach((l,h)=>{var p;return a.set(l,new wy(h,(p=s.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=eu(),i=new Re((s,a)=>s-a),o=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let h=r.get(c)||jt.empty();h=a.applyToLocalView(l,h),r.set(c,h);let p=(i.get(a.batchId)||ie()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,h=c.value,p=cb();h.forEach(m=>{if(!o.has(m)){let v=mb(t.get(m),r.get(m));v!==null&&p.set(m,v),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,p))}return S.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return U.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Tv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):S.resolve(Dn()),a=-1,c=o;return s.next(l=>S.forEach(l,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),o.get(h)?S.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,c,l,ie())).next(h=>({batchId:a,changes:ub(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new U(t)).next(r=>{let i=Za();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Za();return this.indexManager.getCollectionParents(e,o).next(a=>S.forEach(a,c=>{let l=function(p,m){return new un(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,l)=>{let h=l.getKey();s.get(h)===null&&(s=s.insert(h,Qe.newInvalidDocument(h)))});let a=Za();return s.forEach((c,l)=>{let h=o.get(c);h!==void 0&&tu(h.mutation,l,jt.empty(),ke.now()),Au(t,l)&&(a=a.insert(c,l))}),a})}};var _y=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return S.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:He(i.createTime)}}(t)),S.resolve()}getNamedQuery(e,t){return S.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:xv(i.bundledQuery),readTime:He(i.readTime)}}(t)),S.resolve()}};var Iy=class{constructor(){this.overlays=new Re(U.comparator),this.Ir=new Map}getOverlay(e,t){return S.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Dn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),S.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),S.resolve()}getOverlaysForCollection(e,t,r){let i=Dn(),o=t.length+1,s=new U(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return S.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Re((l,h)=>l-h),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=Dn(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=Dn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return S.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new hu(t,r));let o=this.Ir.get(t);o===void 0&&(o=ie(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var Ey=class{constructor(){this.sessionToken=qe.EMPTY_BYTE_STRING}getSessionToken(e){return S.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,S.resolve()}};var vu=class{constructor(){this.Tr=new Ce(We.Er),this.dr=new Ce(We.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new We(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new We(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new U(new pe([])),r=new We(t,e),i=new We(t,e+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new U(new pe([])),r=new We(t,e),i=new We(t,e+1),o=ie();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new We(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},We=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return U.comparator(e.key,t.key)||re(e.wr,t.wr)}static Ar(e,t){return re(e.wr,t.wr)||U.comparator(e.key,t.key)}};var Dy=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ce(We.Er)}checkEmpty(e){return S.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new du(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.br=this.br.add(new We(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return S.resolve(s)}lookupMutationBatch(e,t){return S.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return S.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new We(t,0),i=new We(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{let a=this.Dr(s.wr);o.push(a)}),S.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ce(re);return t.forEach(i=>{let o=new We(i,0),s=new We(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],a=>{r=r.add(a.wr)})}),S.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;U.isDocumentKey(o)||(o=o.child(""));let s=new We(new U(o),0),a=new Ce(re);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},s),S.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){G(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return S.forEach(t.mutations,i=>{let o=new We(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new We(t,0),i=this.br.firstAfterOrEqual(r);return S.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,S.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Cy=class{constructor(e){this.Mr=e,this.docs=function(){return new Re(U.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return S.resolve(r?r.document.mutableCopy():Qe.newInvalidDocument(t))}getEntries(e,t){let r=Mt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Qe.newInvalidDocument(i))}),S.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Mt(),s=t.path,a=new U(s.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:h}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||_v(j0(h),r)<=0||(i.has(h.key)||Au(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return S.resolve(o)}getAllFromCollectionGroup(e,t,r,i){q()}Or(e,t){return S.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Ty(this)}getSize(e){return S.resolve(this.size)}},Ty=class extends Sd{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),S.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var by=class{constructor(e){this.persistence=e,this.Nr=new xn(t=>xi(t),bu),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Lr=0,this.Br=new vu,this.targetCount=0,this.kr=as.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),S.resolve()}getLastRemoteSnapshotVersion(e){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return S.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),S.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new as(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,S.resolve()}updateTargetData(e,t){return this.Kn(t),S.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,S.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),S.waitFor(o).next(()=>i)}getTargetCount(e){return S.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return S.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),S.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),S.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),S.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return S.resolve(r)}containsKey(e,t){return S.resolve(this.Br.containsKey(t))}};var xd=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Vt(0),this.Kr=!1,this.Kr=!0,this.$r=new Ey,this.referenceDelegate=e(this),this.Ur=new by(this),this.indexManager=new ly,this.remoteDocumentCache=function(i){return new Cy(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new _d(t),this.Gr=new _y(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Iy,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Dy(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new Sy(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return S.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Sy=class extends ud{constructor(e){super(),this.currentSequenceNumber=e}},Rd=class n{constructor(e){this.persistence=e,this.Jr=new vu,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw q()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),S.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),S.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),S.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.Xr,r=>{let i=U.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,K.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return S.or([()=>S.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Ay=class{constructor(e){this.serializer=e}O(e,t,r,i){let o=new cd("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",OT,{unique:!0}),c.createObjectStore("documentMutations")}(e),_0(e),function(c){c.createObjectStore("remoteDocuments")}(e));let s=S.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),_0(e)),s=s.next(()=>function(c){let l=c.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(c,l){return l.store("mutations").U().next(h=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",OT,{unique:!0});let p=l.store("mutations"),m=h.map(v=>p.put(v));return S.waitFor(m)})}(e,o))),s=s.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ni(o))),r<6&&i>=6&&(s=s.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(s=s.next(()=>this.ii(o))),r<8&&i>=8&&(s=s.next(()=>this.si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.oi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:xF});l.createIndex("collectionPathOverlayIndex",RF,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",MF,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:vF});l.createIndex("documentKeyIndex",wF),l.createIndex("collectionGroupIndex",_F)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ai(e,o))),r<15&&i>=15&&(s=s.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:TF}).createIndex("sequenceNumberIndex",bF,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:SF}).createIndex("documentKeyIndex",AF,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Td(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>S.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>S.forEach(a,c=>{G(c.userId===o.userId);let l=Ii(this.serializer,c);return Fb(e,o.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let o=[];return r.J((s,a)=>{let c=new pe(s),l=function(p){return[0,Ct(p)]}(c);o.push(t.get(l).next(h=>h?S.resolve():(p=>t.put({targetId:0,path:Ct(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>S.waitFor(o))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:CF});let r=t.store("collectionParents"),i=new yu,o=s=>{if(i.add(s)){let a=s.lastSegment(),c=s.popLast();return r.put({collectionId:a,parent:Ct(c)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{let c=new pe(s);return o(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,c],l)=>{let h=En(a);return o(h.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let o=Ja(i),s=Pb(this.serializer,o);return t.put(s)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{let a=t.store("remoteDocumentsV14"),c=function(p){return p.document?new U(pe.fromString(p.document.name).popFirst(5)):p.noDocument?U.fromSegments(p.noDocument.path):p.unknownDocument?U.fromSegments(p.unknownDocument.path):q()}(s).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>S.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=jb(this.serializer),o=new xd(Rd.Zr,this.serializer.ct);return r.U().next(s=>{let a=new Map;return s.forEach(c=>{var l;let h=(l=a.get(c.userId))!==null&&l!==void 0?l:ie();Ii(this.serializer,c).keys().forEach(p=>h=h.add(p)),a.set(c.userId,h)}),S.forEach(a,(c,l)=>{let h=new Ke(l),p=Ed.lt(this.serializer,h),m=o.getIndexManager(h),v=bd.lt(h,this.serializer,m,o.referenceDelegate);return new Ad(i,v,p,m).recalculateAndSaveOverlaysForDocumentKeys(new su(t,Vt.oe),c).next()})})}};function _0(n){n.createObjectStore("targetDocuments",{keyPath:EF}).createIndex("documentTargetsIndex",DF,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",IF,{unique:!0}),n.createObjectStore("targetGlobal")}var mm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",xy=class n{constructor(e,t,r,i,o,s,a,c,l,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=o,this.window=s,this.document=a,this.ci=l,this.li=h,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!n.D())throw new P(x.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new my(this,i),this.Ai=t+"main",this.serializer=new _d(c),this.Ri=new Or(this.Ai,this.hi,new Ay(this.serializer)),this.$r=new ry,this.Ur=new hy(this.referenceDelegate,this.serializer),this.remoteDocumentCache=jb(this.serializer),this.Gr=new ny,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&Ue("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,mm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Vt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>R(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>R(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>R(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Jl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(zr(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ya(e).get("owner").next(t=>S.resolve(this.vi(t)))}Ci(e){return Jl(e).delete(this.clientId)}Fi(){return R(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=et(t,"clientMetadata");return r.U().next(i=>{let o=this.xi(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return S.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?S.resolve(!0):Ya(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,mm);return!1}}return!(!this.networkEnabled||!this.inForeground)||Jl(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return R(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new su(e,Vt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Jl(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return bd.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new dy(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ed.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(c){return c===17?kF:c===16?PF:c===15?Ev:c===14?G0:c===13?z0:c===12?NF:c===11?q0:void q()}(this.hi),s;return this.Ri.runTransaction(e,i,o,a=>(s=new su(a,this.Qr?this.Qr.next():Vt.oe),t==="readwrite-primary"?this.wi(s).next(c=>!!c||this.Si(s)).next(c=>{if(!c)throw Ue(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new P(x.FAILED_PRECONDITION,B0);return r(s)}).next(c=>this.Di(s).next(()=>c)):this.Ki(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ki(e){return Ya(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new P(x.FAILED_PRECONDITION,mm)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ya(e).put("owner",t)}static D(){return Or.D()}bi(e){let t=Ya(e);return t.get("owner").next(r=>this.vi(r)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):S.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(Ue(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;Wh()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ue("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Ue("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Ya(n){return et(n,"owner")}function Jl(n){return et(n,"clientMetadata")}function Mv(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Ry=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=ie(),i=ie();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var My=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Md=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Wh()?8:U0(zs())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new My;return this.Xi(e,t,s).next(a=>{if(o.result=a,this.zi)return this.es(e,t,s,a.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(qo()<=hn.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",zo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),S.resolve()):(qo()<=hn.DEBUG&&k("QueryEngine","Query:",zo(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(qo()<=hn.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",zo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Tt(t))):S.resolve())}Yi(e,t){if(WT(t))return S.resolve(null);let r=Tt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=md(t,null,"F"),r=Tt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=ie(...o);return this.Ji.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(t,a);return this.ns(t,l,s,c.readTime)?this.Yi(e,md(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,r,i){return WT(t)||i.isEqual(K.min())?S.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let s=this.ts(t,o);return this.ns(t,s,r,i)?S.resolve(null):(qo()<=hn.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),zo(t)),this.rs(e,s,t,V0(i,-1)).next(a=>a))})}ts(e,t){let r=new Ce(sb(e));return t.forEach((i,o)=>{Au(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return qo()<=hn.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",zo(t)),this.Ji.getDocumentsMatchingQuery(e,t,Yt.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var Ny=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Re(re),this._s=new xn(o=>xi(o),bu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ad(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function Bb(n,e,t,r){return new Ny(n,e,t,r)}function Ub(n,e){return R(this,null,function*(){let t=B(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=ie();for(let l of i){s.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}for(let l of o){a.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:s,addedBatchIds:a}))})})})}function fL(n,e){let t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,h){let p=l.batch,m=p.keys(),v=S.resolve();return m.forEach(b=>{v=v.next(()=>h.getEntry(c,b)).next(M=>{let N=l.docVersions.get(b);G(N!==null),M.version.compareTo(N)<0&&(p.applyToRemoteDocument(M,l),M.isValidDocument()&&(M.setReadTime(l.commitVersion),h.addEntry(M)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ie();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function $b(n){let e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function pL(n,e){let t=B(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((h,p)=>{let m=i.get(p);if(!m)return;a.push(t.Ur.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(o,h.addedDocuments,p)));let v=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(qe.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),i=i.insert(p,v),function(M,N,j){return M.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0}(m,v,h)&&a.push(t.Ur.updateTargetData(o,v))});let c=Mt(),l=ie();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(Hb(o,s,e.documentUpdates).next(h=>{c=h.Ps,l=h.Is})),!r.isEqual(K.min())){let h=t.Ur.getLastRemoteSnapshotVersion(o).next(p=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return S.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(t.os=i,o))}function Hb(n,e,t){let r=ie(),i=ie();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=Mt();return t.forEach((a,c)=>{let l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(K.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):k("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:s,Is:i}})}function gL(n,e){let t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function us(n,e){let t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,S.resolve(i)):t.Ur.allocateTargetId(r).next(s=>(i=new ss(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function cs(n,e,t){return R(this,null,function*(){let r=B(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!zr(s))throw s;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Nd(n,e,t){let r=B(n),i=K.min(),o=ie();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,h){let p=B(c),m=p._s.get(h);return m!==void 0?S.resolve(p.os.get(m)):p.Ur.getTargetData(l,h)}(r,s,Tt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r.ss.getDocumentsMatchingQuery(s,e,t?i:K.min(),t?o:ie())).next(a=>(Gb(r,ob(e),a),{documents:a,Ts:o})))}function qb(n,e){let t=B(n),r=B(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(s=>s?s.target:null))}function zb(n,e){let t=B(n),r=t.us.get(e)||K.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,V0(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Gb(t,e,i),i))}function Gb(n,e,t){let r=n.us.get(e)||K.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}function mL(n,e,t,r){return R(this,null,function*(){let i=B(n),o=ie(),s=Mt();for(let l of t){let h=e.Es(l.metadata.name);l.document&&(o=o.add(h));let p=e.ds(l);p.setReadTime(e.As(l.metadata.readTime)),s=s.insert(h,p)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),c=yield us(i,function(h){return Tt(ys(pe.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>Hb(l,a,s).next(h=>(a.apply(l),h)).next(h=>i.Ur.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Ur.addMatchingKeys(l,o,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.Ps,h.Is)).next(()=>h.Ps)))})}function yL(r,i){return R(this,arguments,function*(n,e,t=ie()){let o=yield us(n,Tt(xv(e.bundledQuery))),s=B(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let c=He(e.readTime);if(o.snapshotVersion.compareTo(c)>=0)return s.Gr.saveNamedQuery(a,e);let l=o.withResumeToken(qe.EMPTY_BYTE_STRING,c);return s.os=s.os.insert(l.targetId,l),s.Ur.updateTargetData(a,l).next(()=>s.Ur.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.Ur.addMatchingKeys(a,t,o.targetId)).next(()=>s.Gr.saveNamedQuery(a,e))})})}function I0(n,e){return`firestore_clients_${n}_${e}`}function E0(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function ym(n,e){return`firestore_targets_${n}_${e}`}var Pd=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new P(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(Ue("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},nu=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new P(r.error.code,r.error.message))),o?new n(e,r.state,i):(Ue("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},kd=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=bv();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=$0(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(Ue("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Py=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Ue("SharedClientState",`Failed to parse online state: ${e}`),null)}},wu=class{constructor(){this.activeTargetIds=bv()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},ru=class{constructor(e,t,r,i,o){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Re(re),this.started=!1,this.bs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=I0(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new wu),this.Cs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return R(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(I0(this.persistenceKey,r));if(i){let o=kd.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(ym(this.persistenceKey,e));if(i){let o=nu.Rs(e,i);o&&(r=o.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ym(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Ue("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>R(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(o){let s=Vt.oe;if(o!=null)try{let a=JSON.parse(o);G(typeof a=="number"),s=a}catch(a){Ue("SharedClientState","Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==Vt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new Pd(this.currentUser,e,t,r),o=E0(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){let t=E0(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=ym(this.persistenceKey,e),o=new nu(e,t,r);this.setItem(i,o.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return kd.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Pd.Rs(new Ke(o),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return nu.Rs(i,t)}Ls(e){return Py.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return R(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),s=[],a=[];return o.forEach(c=>{i.has(c)||s.push(c)}),i.forEach(c=>{o.has(c)||a.push(c)}),this.syncEngine.io(s,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=bv();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Od=class{constructor(){this.so=new wu,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new wu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var ky=class{_o(e){}shutdown(){}};var Fd=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Xl=null;function vm(){return Xl===null?Xl=function(){return 268435456+Math.round(2147483648*Math.random())}():Xl++,"0x"+Xl.toString(16)}var vL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Oy=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var ft="WebChannelConnection",Fy=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,s){let a=vm(),c=this.xo(t,r.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,o,s),this.No(t,c,l,i).then(h=>(k("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw an("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",c,"request:",i),h})}Lo(t,r,i,o,s,a){return this.Mo(t,r,i,o,s)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ms}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}xo(t,r){let i=vL[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=vm();return new Promise((s,a)=>{let c=new lm;c.setWithCredentials(!0),c.listenOnce(dm.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ga.NO_ERROR:let h=c.getResponseJson();k(ft,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case Ga.TIMEOUT:k(ft,`RPC '${e}' ${o} timed out`),a(new P(x.DEADLINE_EXCEEDED,"Request time out"));break;case Ga.HTTP_ERROR:let p=c.getStatus();if(k(ft,`RPC '${e}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let v=m?.error;if(v&&v.status&&v.message){let b=function(N){let j=N.toLowerCase().replace(/_/g,"-");return Object.values(x).indexOf(j)>=0?j:x.UNKNOWN}(v.status);a(new P(b,v.message))}else a(new P(x.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new P(x.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{k(ft,`RPC '${e}' ${o} completed.`)}});let l=JSON.stringify(i);k(ft,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=vm(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=pm(),a=fm(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let h=o.join("");k(ft,`Creating RPC '${e}' stream ${i}: ${h}`,c);let p=s.createWebChannel(h,c),m=!1,v=!1,b=new Oy({Io:N=>{v?k(ft,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(m||(k(ft,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),k(ft,`RPC '${e}' stream ${i} sending:`,N),p.send(N))},To:()=>p.close()}),M=(N,j,H)=>{N.listen(j,F=>{try{H(F)}catch(Q){setTimeout(()=>{throw Q},0)}})};return M(p,jo.EventType.OPEN,()=>{v||(k(ft,`RPC '${e}' stream ${i} transport opened.`),b.yo())}),M(p,jo.EventType.CLOSE,()=>{v||(v=!0,k(ft,`RPC '${e}' stream ${i} transport closed`),b.So())}),M(p,jo.EventType.ERROR,N=>{v||(v=!0,an(ft,`RPC '${e}' stream ${i} transport errored:`,N),b.So(new P(x.UNAVAILABLE,"The operation could not be completed")))}),M(p,jo.EventType.MESSAGE,N=>{var j;if(!v){let H=N.data[0];G(!!H);let F=H,Q=F.error||((j=F[0])===null||j===void 0?void 0:j.error);if(Q){k(ft,`RPC '${e}' stream ${i} received error:`,Q);let ee=Q.status,Y=function(_){let E=Ge[_];if(E!==void 0)return wb(E)}(ee),I=Q.message;Y===void 0&&(Y=x.INTERNAL,I="Unknown error status: "+ee+" with message "+Q.message),v=!0,b.So(new P(Y,I)),p.close()}else k(ft,`RPC '${e}' stream ${i} received:`,H),b.bo(H)}}),M(a,hm.STAT_EVENT,N=>{N.stat===Ql.PROXY?k(ft,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Ql.NOPROXY&&k(ft,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.wo()},0),b}};function Wb(){return typeof window<"u"?window:null}function id(){return typeof document<"u"?document:null}function xu(n){return new Zm(n,!0)}var _u=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Ld=class{constructor(e,t,r,i,o,s,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new _u(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return R(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return R(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return R(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===x.RESOURCE_EXHAUSTED?(Ue(t.toString()),Ue("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===x.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new P(x.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>R(this,null,function*(){this.state=0,this.start()}))}I_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Ly=class extends Ld{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=nL(this.serializer,e),r=function(o){if(!("targetChange"in o))return K.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?K.min():s.readTime?He(s.readTime):K.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=ey(this.serializer),t.addTarget=function(o,s){let a,c=s.target;if(a=pd(c)?{documents:Sb(o,c)}:{query:Ab(o,c)._t},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=Ib(o,s.resumeToken);let l=Jm(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(K.min())>0){a.readTime=os(o,s.snapshotVersion.toTimestamp());let l=Jm(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=iL(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=ey(this.serializer),t.removeTarget=e,this.a_(t)}},Vy=class extends Ld{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return G(!!e.streamToken),this.lastStreamToken=e.streamToken,G(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){G(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=rL(e.writeResults,e.commitTime),r=He(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=ey(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>mu(this.serializer,r))};this.a_(t)}};var jy=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(e,Xm(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(x.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Lo(e,Xm(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(x.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},By=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ue(t),this.D_=!1):k("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Uy=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(()=>R(this,null,function*(){Gr(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(c){return R(this,null,function*(){let l=B(c);l.L_.add(4),yield vs(l),l.q_.set("Unknown"),l.L_.delete(4),yield Ru(l)})}(this))}))}),this.q_=new By(r,i)}};function Ru(n){return R(this,null,function*(){if(Gr(n))for(let e of n.B_)yield e(!0)})}function vs(n){return R(this,null,function*(){for(let e of n.B_)yield e(!1)})}function ih(n,e){let t=B(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),kv(t)?Pv(t):_s(t).r_()&&Nv(t,e))}function ls(n,e){let t=B(n),r=_s(t);t.N_.delete(e),r.r_()&&Kb(t,e),t.N_.size===0&&(r.r_()?r.o_():Gr(t)&&t.q_.set("Unknown"))}function Nv(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}_s(n).A_(e)}function Kb(n,e){n.Q_.xe(e),_s(n).R_(e)}function Pv(n){n.Q_=new Ym({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),_s(n).start(),n.q_.v_()}function kv(n){return Gr(n)&&!_s(n).n_()&&n.N_.size>0}function Gr(n){return B(n).L_.size===0}function Qb(n){n.Q_=void 0}function wL(n){return R(this,null,function*(){n.q_.set("Online")})}function _L(n){return R(this,null,function*(){n.N_.forEach((e,t)=>{Nv(n,e)})})}function IL(n,e){return R(this,null,function*(){Qb(n),kv(n)?(n.q_.M_(e),Pv(n)):n.q_.set("Unknown")})}function EL(n,e,t){return R(this,null,function*(){if(n.q_.set("Online"),e instanceof vd&&e.state===2&&e.cause)try{yield function(i,o){return R(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Vd(n,r)}else if(e instanceof Jo?n.Q_.Ke(e):e instanceof yd?n.Q_.He(e):n.Q_.We(e),!t.isEqual(K.min()))try{let r=yield $b(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.Q_.rt(s);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let h=o.N_.get(l);h&&o.N_.set(l,h.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,l)=>{let h=o.N_.get(c);if(!h)return;o.N_.set(c,h.withResumeToken(qe.EMPTY_BYTE_STRING,h.snapshotVersion)),Kb(o,c);let p=new ss(h.target,c,l,h.sequenceNumber);Nv(o,p)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){k("RemoteStore","Failed to raise snapshot:",r),yield Vd(n,r)}})}function Vd(n,e,t){return R(this,null,function*(){if(!zr(e))throw e;n.L_.add(1),yield vs(n),n.q_.set("Offline"),t||(t=()=>$b(n.localStore)),n.asyncQueue.enqueueRetryable(()=>R(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Ru(n)}))})}function Yb(n,e){return e().catch(t=>Vd(n,t,e))}function ws(n){return R(this,null,function*(){let e=B(n),t=Hr(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;DL(e);)try{let i=yield gL(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,CL(e,i)}catch(i){yield Vd(e,i)}Zb(e)&&Jb(e)})}function DL(n){return Gr(n)&&n.O_.length<10}function CL(n,e){n.O_.push(e);let t=Hr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Zb(n){return Gr(n)&&!Hr(n).n_()&&n.O_.length>0}function Jb(n){Hr(n).start()}function TL(n){return R(this,null,function*(){Hr(n).p_()})}function bL(n){return R(this,null,function*(){let e=Hr(n);for(let t of n.O_)e.m_(t.mutations)})}function SL(n,e,t){return R(this,null,function*(){let r=n.O_.shift(),i=Wm.from(r,e,t);yield Yb(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ws(n)})}function AL(n,e){return R(this,null,function*(){e&&Hr(n).V_&&(yield function(r,i){return R(this,null,function*(){if(function(s){return vb(s)&&s!==x.ABORTED}(i.code)){let o=r.O_.shift();Hr(r).s_(),yield Yb(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield ws(r)}})}(n,e)),Zb(n)&&Jb(n)})}function D0(n,e){return R(this,null,function*(){let t=B(n);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let r=Gr(t);t.L_.add(3),yield vs(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Ru(t)})}function $y(n,e){return R(this,null,function*(){let t=B(n);e?(t.L_.delete(2),yield Ru(t)):e||(t.L_.add(2),yield vs(t),t.q_.set("Unknown"))})}function _s(n){return n.K_||(n.K_=function(t,r,i){let o=B(t);return o.w_(),new Ly(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:wL.bind(null,n),Ro:_L.bind(null,n),mo:IL.bind(null,n),d_:EL.bind(null,n)}),n.B_.push(e=>R(this,null,function*(){e?(n.K_.s_(),kv(n)?Pv(n):n.q_.set("Unknown")):(yield n.K_.stop(),Qb(n))}))),n.K_}function Hr(n){return n.U_||(n.U_=function(t,r,i){let o=B(t);return o.w_(),new Vy(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:TL.bind(null,n),mo:AL.bind(null,n),f_:bL.bind(null,n),g_:SL.bind(null,n)}),n.B_.push(e=>R(this,null,function*(){e?(n.U_.s_(),yield ws(n)):(yield n.U_.stop(),n.O_.length>0&&(k("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var Hy=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Xe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Is(n,e){if(Ue("AsyncQueue",`${e}: ${n}`),zr(n))return new P(x.UNAVAILABLE,`${e}: ${n}`);throw n}var jd=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||U.comparator(t.key,r.key):(t,r)=>U.comparator(t.key,r.key),this.keyedMap=Za(),this.sortedSet=new Re(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Bd=class{constructor(){this.W_=new Re(U.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):q():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},ds=class n{constructor(e,t,r,i,o,s,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,jd.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Su(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var qy=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},zy=class{constructor(){this.queries=C0(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=B(t),o=i.queries;i.queries=C0(),o.forEach((s,a)=>{for(let c of a.j_)c.onError(r)})})(this,new P(x.ABORTED,"Firestore shutting down"))}};function C0(){return new xn(n=>ib(n),Su)}function Ov(n,e){return R(this,null,function*(){let t=B(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new qy,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=Is(s,`Initialization of query '${zo(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&Lv(t)})}function Fv(n,e){return R(this,null,function*(){let t=B(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.j_.indexOf(e);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function xL(n,e){let t=B(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.j_)a.X_(i)&&(r=!0);s.z_=i}}r&&Lv(t)}function RL(n,e,t){let r=B(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function Lv(n){n.Y_.forEach(e=>{e.next()})}var Gy,T0;(T0=Gy||(Gy={})).ea="default",T0.Cache="cache";var Iu=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ds(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ds.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Gy.Cache}};var Wy=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var Ud=class{constructor(e){this.serializer=e}Es(e){return Tn(this.serializer,e)}ds(e){return e.metadata.exists?bb(this.serializer,e.document,!1):Qe.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return He(e)}},Ky=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Xb(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=pe.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new Ud(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Es(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||ie()).add(o);t.set(s,a)}}return t}complete(){return R(this,null,function*(){let e=yield mL(this.localStore,new Ud(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield yL(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function Xb(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var $d=class{constructor(e){this.key=e}},Hd=class{constructor(e){this.key=e}},qd=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ie(),this.mutatedKeys=ie(),this.Aa=sb(e),this.Ra=new jd(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Bd,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let m=i.get(h),v=Au(this.query,p)?p:null,b=!!m&&this.mutatedKeys.has(m.key),M=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations),N=!1;m&&v?m.data.isEqual(v.data)?b!==M&&(r.track({type:3,doc:v}),N=!0):this.ga(m,v)||(r.track({type:2,doc:v}),N=!0,(c&&this.Aa(v,c)>0||l&&this.Aa(v,l)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),N=!0):m&&!v&&(r.track({type:1,doc:m}),N=!0,(c||l)&&(a=!0)),N&&(v?(s=s.add(v),o=M?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:a,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let s=e.fa.G_();s.sort((h,p)=>function(v,b){let M=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return M(v)-M(b)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,s.length!==0||l?{snapshot:new ds(this.query,e.Ra,o,s,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Bd,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=ie(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Hd(r))}),this.da.forEach(r=>{e.has(r)||t.push(new $d(r))}),t}ba(e){this.Ta=e.Ts,this.da=ie();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ds.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Qy=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Yy=class{constructor(e){this.key=e,this.va=!1}},Zy=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new xn(a=>ib(a),Su),this.Ma=new Map,this.xa=new Set,this.Oa=new Re(U.comparator),this.Na=new Map,this.La=new vu,this.Ba={},this.ka=new Map,this.qa=as.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function ML(n,e,t=!0){return R(this,null,function*(){let r=oh(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield eS(r,e,t,!0),i})}function NL(n,e){return R(this,null,function*(){let t=oh(n);yield eS(t,e,!0,!1)})}function eS(n,e,t,r){return R(this,null,function*(){let i=yield us(n.localStore,Tt(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield Vv(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&ih(n.remoteStore,i),a})}function Vv(n,e,t,r,i){return R(this,null,function*(){n.Ka=(p,m,v)=>function(M,N,j,H){return R(this,null,function*(){let F=N.view.ma(j);F.ns&&(F=yield Nd(M.localStore,N.query,!1).then(({documents:I})=>N.view.ma(I,F)));let Q=H&&H.targetChanges.get(N.targetId),ee=H&&H.targetMismatches.get(N.targetId)!=null,Y=N.view.applyChanges(F,M.isPrimaryClient,Q,ee);return Jy(M,N.targetId,Y.wa),Y.snapshot})}(n,p,m,v);let o=yield Nd(n.localStore,e,!0),s=new qd(e,o.Ts),a=s.ma(o.documents),c=pu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,c);Jy(n,t,l.wa);let h=new Qy(e,t,s);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function PL(n,e,t){return R(this,null,function*(){let r=B(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!Su(s,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield cs(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&ls(r.remoteStore,i.targetId),hs(r,i.targetId)}).catch(qr))):(hs(r,i.targetId),yield cs(r.localStore,i.targetId,!0))})}function kL(n,e){return R(this,null,function*(){let t=B(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ls(t.remoteStore,r.targetId))})}function OL(n,e,t){return R(this,null,function*(){let r=$v(n);try{let i=yield function(s,a){let c=B(s),l=ke.now(),h=a.reduce((v,b)=>v.add(b.key),ie()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let b=Mt(),M=ie();return c.cs.getEntries(v,h).next(N=>{b=N,b.forEach((j,H)=>{H.isValidDocument()||(M=M.add(j))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,b)).next(N=>{p=N;let j=[];for(let H of a){let F=QF(H,p.get(H.key).overlayedDocument);F!=null&&j.push(new cn(H.key,F,Z0(F.value.mapValue),je.exists(!0)))}return c.mutationQueue.addMutationBatch(v,l,j,a)}).next(N=>{m=N;let j=N.applyToLocalDocumentSet(p,M);return c.documentOverlayCache.saveOverlays(v,N.batchId,j)})}).then(()=>({batchId:m.batchId,changes:ub(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let l=s.Ba[s.currentUser.toKey()];l||(l=new Re(re)),l=l.insert(a,c),s.Ba[s.currentUser.toKey()]=l}(r,i.batchId,t),yield nr(r,i.changes),yield ws(r.remoteStore)}catch(i){let o=Is(i,"Failed to persist write");t.reject(o)}})}function tS(n,e){return R(this,null,function*(){let t=B(n);try{let r=yield pL(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Na.get(o);s&&(G(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?G(s.va):i.removedDocuments.size>0&&(G(s.va),s.va=!1))}),yield nr(t,r,e)}catch(r){yield qr(r)}})}function b0(n,e,t){let r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,s)=>{let a=s.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let c=B(s);c.onlineState=a;let l=!1;c.queries.forEach((h,p)=>{for(let m of p.j_)m.Z_(a)&&(l=!0)}),l&&Lv(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function FL(n,e,t){return R(this,null,function*(){let r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let s=new Re(U.comparator);s=s.insert(o,Qe.newNoDocument(o,K.min()));let a=ie().add(o),c=new fu(K.min(),new Map,new Re(re),s,a);yield tS(r,c),r.Oa=r.Oa.remove(o),r.Na.delete(e),Uv(r)}else yield cs(r.localStore,e,!1).then(()=>hs(r,e,t)).catch(qr)})}function LL(n,e){return R(this,null,function*(){let t=B(n),r=e.batch.batchId;try{let i=yield fL(t.localStore,e);Bv(t,r,null),jv(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield nr(t,i)}catch(i){yield qr(i)}})}function VL(n,e,t){return R(this,null,function*(){let r=B(n);try{let i=yield function(s,a){let c=B(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,a).next(p=>(G(p!==null),h=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(r.localStore,e);Bv(r,e,t),jv(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield nr(r,i)}catch(i){yield qr(i)}})}function jL(n,e){return R(this,null,function*(){let t=B(n);Gr(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=B(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=Is(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function jv(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Bv(n,e,t){let r=B(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function hs(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||nS(n,r)})}function nS(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(ls(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Uv(n))}function Jy(n,e,t){for(let r of t)r instanceof $d?(n.La.addReference(r.key,e),BL(n,r)):r instanceof Hd?(k("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||nS(n,r.key)):q()}function BL(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(k("SyncEngine","New document in limbo: "+t),n.xa.add(r),Uv(n))}function Uv(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new U(pe.fromString(e)),r=n.qa.next();n.Na.set(r,new Yy(t)),n.Oa=n.Oa.insert(t,r),ih(n.remoteStore,new ss(Tt(ys(t.path)),r,"TargetPurposeLimboResolution",Vt.oe))}}function nr(n,e,t){return R(this,null,function*(){let r=B(n),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{s.push(r.Ka(c,e,t).then(l=>{var h;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(h=t?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=Ry.Wi(c.targetId,l);o.push(p)}}))}),yield Promise.all(s),r.Ca.d_(i),yield function(c,l){return R(this,null,function*(){let h=B(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>S.forEach(l,m=>S.forEach(m.$i,v=>h.persistence.referenceDelegate.addReference(p,m.targetId,v)).next(()=>S.forEach(m.Ui,v=>h.persistence.referenceDelegate.removeReference(p,m.targetId,v)))))}catch(p){if(!zr(p))throw p;k("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let v=h.os.get(m),b=v.snapshotVersion,M=v.withLastLimboFreeSnapshotVersion(b);h.os=h.os.insert(m,M)}}})}(r.localStore,o))})}function UL(n,e){return R(this,null,function*(){let t=B(n);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let r=yield Ub(t.localStore,e);t.currentUser=e,function(o,s){o.ka.forEach(a=>{a.forEach(c=>{c.reject(new P(x.CANCELLED,s))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield nr(t,r.hs)}})}function $L(n,e){let t=B(n),r=t.Na.get(e);if(r&&r.va)return ie().add(r.key);{let i=ie(),o=t.Ma.get(e);if(!o)return i;for(let s of o){let a=t.Fa.get(s);i=i.unionWith(a.view.Va)}return i}}function HL(n,e){return R(this,null,function*(){let t=B(n),r=yield Nd(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&Jy(t,e.targetId,i.wa),i})}function qL(n,e){return R(this,null,function*(){let t=B(n);return zb(t.localStore,e).then(r=>nr(t,r))})}function zL(n,e,t,r){return R(this,null,function*(){let i=B(n),o=yield function(a,c){let l=B(a),h=B(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Mn(p,c).next(m=>m?l.localDocuments.getDocuments(p,m):S.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield ws(i.remoteStore):t==="acknowledged"||t==="rejected"?(Bv(i,e,r||null),jv(i,e),function(a,c){B(B(a).mutationQueue).On(c)}(i.localStore,e)):q(),yield nr(i,o)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function GL(n,e){return R(this,null,function*(){let t=B(n);if(oh(t),$v(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield S0(t,r.toArray());t.Qa=!0,yield $y(t.remoteStore,!0);for(let o of i)ih(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(hs(t,s),cs(t.localStore,s,!0))),ls(t.remoteStore,s)}),yield i,yield S0(t,r),function(s){let a=B(s);a.Na.forEach((c,l)=>{ls(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new Re(U.comparator)}(t),t.Qa=!1,yield $y(t.remoteStore,!1)}})}function S0(n,e,t){return R(this,null,function*(){let r=B(n),i=[],o=[];for(let s of e){let a,c=r.Ma.get(s);if(c&&c.length!==0){a=yield us(r.localStore,Tt(c[0]));for(let l of c){let h=r.Fa.get(l),p=yield HL(r,h);p.snapshot&&o.push(p.snapshot)}}else{let l=yield qb(r.localStore,s);a=yield us(r.localStore,l),yield Vv(r,rS(l),s,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(o),i})}function rS(n){return rb(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function WL(n){return function(t){return B(B(t).persistence).Qi()}(B(n).localStore)}function KL(n,e,t,r){return R(this,null,function*(){let i=B(n);if(i.Qa)return void k("SyncEngine","Ignoring unexpected query state notification.");let o=i.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield zb(i.localStore,ob(o[0])),a=fu.createSynthesizedRemoteEventForCurrentChange(e,t==="current",qe.EMPTY_BYTE_STRING);yield nr(i,s,a);break}case"rejected":yield cs(i.localStore,e,!0),hs(i,e,r);break;default:q()}})}function QL(n,e,t){return R(this,null,function*(){let r=oh(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k("SyncEngine","Adding an already active target "+i);continue}let o=yield qb(r.localStore,i),s=yield us(r.localStore,o);yield Vv(r,rS(o),s.targetId,!1,s.resumeToken),ih(r.remoteStore,s)}for(let i of t)r.Ma.has(i)&&(yield cs(r.localStore,i,!1).then(()=>{ls(r.remoteStore,i),hs(r,i)}).catch(qr))}})}function oh(n){let e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=tS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$L.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FL.bind(null,e),e.Ca.d_=xL.bind(null,e.eventManager),e.Ca.$a=RL.bind(null,e.eventManager),e}function $v(n){let e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=VL.bind(null,e),e}function YL(n,e,t){let r=B(n);(function(o,s,a){return R(this,null,function*(){try{let c=yield s.getMetadata();if(yield function(v,b){let M=B(v),N=He(b.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",j=>M.Gr.getBundleMetadata(j,b.id)).then(j=>!!j&&j.createTime.compareTo(N)>=0)}(o.localStore,c))return yield s.close(),a._completeWith(function(v){return{taskState:"Success",documentsLoaded:v.totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(Xb(c));let l=new Ky(c,o.localStore,s.serializer),h=yield s.Ua();for(;h;){let m=yield l.la(h);m&&a._updateProgress(m),h=yield s.Ua()}let p=yield l.complete();return yield nr(o,p.Ia,void 0),yield function(v,b){let M=B(v);return M.persistence.runTransaction("Save bundle","readwrite",N=>M.Gr.saveBundleMetadata(N,b))}(o.localStore,c),a._completeWith(p.progress),Promise.resolve(p.Pa)}catch(c){return an("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Xy=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return R(this,null,function*(){this.serializer=xu(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return Bb(this.persistence,new Md,t.initialUser,this.serializer)}Ga(t){return new xd(Rd.Zr,this.serializer)}Wa(t){return new Od}terminate(){return R(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var zd=class n extends Xy{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return R(this,null,function*(){yield zh(n.prototype,this,"initialize").call(this,e),yield this.Ja.initialize(this,e),yield $v(this.Ja.syncEngine),yield ws(this.Ja.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}za(e){return Bb(this.persistence,new Md,e.initialUser,this.serializer)}ja(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new py(r,e.asyncQueue,t)}Ha(e,t){let r=new Mm(t,this.persistence);return new Rm(e.asyncQueue,r)}Ga(e){let t=Mv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Qt.withCacheSize(this.cacheSizeBytes):Qt.DEFAULT;return new xy(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Wb(),id(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Od}},ev=class n extends zd{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return R(this,null,function*(){yield zh(n.prototype,this,"initialize").call(this,e);let t=this.Ja.syncEngine;this.sharedClientState instanceof ru&&(this.sharedClientState.syncEngine={no:zL.bind(null,t),ro:KL.bind(null,t),io:QL.bind(null,t),Qi:WL.bind(null,t),eo:qL.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>R(this,null,function*(){yield GL(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Wa(e){let t=Wb();if(!ru.D(t))throw new P(x.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=Mv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ru(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Hv=(()=>{class n{initialize(t,r){return R(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>b0(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=UL.bind(null,this.syncEngine),yield $y(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new zy}()}createDatastore(t){let r=xu(t.databaseInfo.databaseId),i=function(s){return new Fy(s)}(t.databaseInfo);return function(s,a,c,l){return new jy(s,a,c,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,c){return new Uy(i,o,s,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>b0(this.syncEngine,r,0),function(){return Fd.D()?new Fd:new ky}())}createSyncEngine(t,r){return function(o,s,a,c,l,h,p){let m=new Zy(o,s,a,c,l,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return R(this,null,function*(){var t,r;yield function(o){return R(this,null,function*(){let s=B(o);k("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield vs(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function A0(n,e=10240){let t=0;return{read(){return R(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return R(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var fs=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ue("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var tv=class{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new Xe,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}getMetadata(){return R(this,null,function*(){return this.metadata.promise})}Ua(){return R(this,null,function*(){return yield this.getMetadata(),this.tu()})}tu(){return R(this,null,function*(){let e=yield this.nu();if(e===null)return null;let t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);let i=yield this.iu(r);return new Wy(JSON.parse(i),e.length+r)})}su(){return this.buffer.findIndex(e=>e===123)}nu(){return R(this,null,function*(){for(;this.su()<0&&!(yield this.ou()););if(this.buffer.length===0)return null;let e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}iu(e){return R(this,null,function*(){for(;this.buffer.length<e;)(yield this.ou())&&this.ru("Reached the end of bundle when more is expected.");let t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){return R(this,null,function*(){let e=yield this.Xa.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var nv=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return R(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(x.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return R(this,null,function*(){let s=B(i),a={documents:o.map(p=>gu(s.serializer,p))},c=yield s.Lo("BatchGetDocuments",s.serializer.databaseId,pe.emptyPath(),a,o.length),l=new Map;c.forEach(p=>{let m=tL(s.serializer,p);l.set(m.key.toString(),m)});let h=[];return o.forEach(p=>{let m=l.get(p.toString());G(!!m),h.push(m)}),h})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new $r(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return R(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=U.fromPath(r);this.mutations.push(new lu(i,this.precondition(i)))}),yield function(r,i){return R(this,null,function*(){let o=B(r),s={writes:i.map(a=>mu(o.serializer,a))};yield o.Mo("Commit",o.serializer.databaseId,pe.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw q();t=K.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new P(x.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(K.min())?je.exists(!1):je.updateTime(t):je.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new P(x.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return je.updateTime(t)}return je.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var rv=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this._u=r.maxAttempts,this.t_=new _u(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(()=>R(this,null,function*(){let e=new nv(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})}))}cu(e){try{let t=this.updateFunction(e);return!Tu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!vb(t)}return!1}};var iv=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ke.UNAUTHENTICATED,this.clientId=sd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>R(this,null,function*(){k("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(k("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Xe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Is(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function wm(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>R(this,null,function*(){r.isEqual(i)||(yield Ub(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function x0(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield qv(n);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>D0(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>D0(e.remoteStore,i)),n._onlineComponents=e})}function qv(n){return R(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield wm(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===x.FAILED_PRECONDITION||i.code===x.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;an("Error using user provided cache. Falling back to memory cache: "+t),yield wm(n,new Xy)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield wm(n,new Xy);return n._offlineComponents})}function sh(n){return R(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield x0(n,n._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield x0(n,new Hv))),n._onlineComponents})}function iS(n){return qv(n).then(e=>e.persistence)}function zv(n){return qv(n).then(e=>e.localStore)}function oS(n){return sh(n).then(e=>e.remoteStore)}function Gv(n){return sh(n).then(e=>e.syncEngine)}function ZL(n){return sh(n).then(e=>e.datastore)}function ps(n){return R(this,null,function*(){let e=yield sh(n),t=e.eventManager;return t.onListen=ML.bind(null,e.syncEngine),t.onUnlisten=PL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=NL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=kL.bind(null,e.syncEngine),t})}function JL(n){return n.asyncQueue.enqueue(()=>R(this,null,function*(){let e=yield iS(n),t=yield oS(n);return e.setNetworkEnabled(!0),function(i){let o=B(i);return o.L_.delete(0),Ru(o)}(t)}))}function XL(n){return n.asyncQueue.enqueue(()=>R(this,null,function*(){let e=yield iS(n),t=yield oS(n);return e.setNetworkEnabled(!1),function(i){return R(this,null,function*(){let o=B(i);o.L_.add(0),yield vs(o),o.q_.set("Offline")})}(t)}))}function eV(n,e){let t=new Xe;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,o,s){return R(this,null,function*(){try{let a=yield function(l,h){let p=B(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,h))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new P(x.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Is(a,`Failed to get document '${o} from cache`);s.reject(c)}})}(yield zv(n),e,t)})),t.promise}function sS(n,e,t={}){let r=new Xe;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(o,s,a,c,l){let h=new fs({next:m=>{h.Za(),s.enqueueAndForget(()=>Fv(o,p));let v=m.docs.has(a);!v&&m.fromCache?l.reject(new P(x.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&c&&c.source==="server"?l.reject(new P(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Iu(ys(a.path),h,{includeMetadataChanges:!0,_a:!0});return Ov(o,p)}(yield ps(n),n.asyncQueue,e,t,r)})),r.promise}function tV(n,e){let t=new Xe;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,o,s){return R(this,null,function*(){try{let a=yield Nd(i,o,!0),c=new qd(o,a.Ts),l=c.ma(a.documents),h=c.applyChanges(l,!1);s.resolve(h.snapshot)}catch(a){let c=Is(a,`Failed to execute query '${o} against cache`);s.reject(c)}})}(yield zv(n),e,t)})),t.promise}function aS(n,e,t={}){let r=new Xe;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(o,s,a,c,l){let h=new fs({next:m=>{h.Za(),s.enqueueAndForget(()=>Fv(o,p)),m.fromCache&&c.source==="server"?l.reject(new P(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Iu(a,h,{includeMetadataChanges:!0,_a:!0});return Ov(o,p)}(yield ps(n),n.asyncQueue,e,t,r)})),r.promise}function nV(n,e){let t=new fs(e);return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,o){B(i).Y_.add(o),o.next()}(yield ps(n),t)})),()=>{t.Za(),n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,o){B(i).Y_.delete(o)}(yield ps(n),t)}))}}function rV(n,e,t,r){let i=function(s,a){let c;return c=typeof s=="string"?_b().encode(s):s,function(h,p){return new tv(h,p)}(function(h,p){if(h instanceof Uint8Array)return A0(h,p);if(h instanceof ArrayBuffer)return A0(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,xu(e));n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){YL(yield Gv(n),i,r)}))}function iV(n,e){return n.asyncQueue.enqueue(()=>R(this,null,function*(){return function(r,i){let o=B(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.Gr.getNamedQuery(s,i))}(yield zv(n),e)}))}function uS(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var R0=new Map;function Wv(n,e,t){if(!t)throw new P(x.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Kv(n,e,t,r){if(e===!0&&r===!0)throw new P(x.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function M0(n){if(!U.isDocumentKey(n))throw new P(x.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function N0(n){if(U.isDocumentKey(n))throw new P(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ah(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":q()}function ge(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ah(n);throw new P(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function cS(n,e){if(e<=0)throw new P(x.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Gd=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Kv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uS((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Pi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gd({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new P(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gd(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new _m;switch(r.type){case"firstParty":return new Cm(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return R(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=R0.get(t);r&&(k("ComponentProvider","Removing Datastore"),R0.delete(t),r.terminate())}(this),Promise.resolve()}};function lS(n,e,t,r={}){var i;let o=(n=ge(n,Pi))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&an("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Ke.MOCK_USER;else{a=I_(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new P(x.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ke(l)}n._authCredentials=new Im(new od(a,c))}}var at=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ae=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},bn=class n extends at{constructor(e,t,r){super(e,t,ys(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ae(this.firestore,null,new U(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Qv(n,e,...t){if(n=Ne(n),Wv("collection","path",e),n instanceof Pi){let r=pe.fromString(e,...t);return N0(r),new bn(n,null,r)}{if(!(n instanceof Ae||n instanceof bn))throw new P(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return N0(r),new bn(n.firestore,null,r)}}function dS(n,e){if(n=ge(n,Pi),Wv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(x.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new at(n,null,function(r){return new un(pe.emptyPath(),r)}(e))}function Mu(n,e,...t){if(n=Ne(n),arguments.length===1&&(e=sd.newId()),Wv("doc","path",e),n instanceof Pi){let r=pe.fromString(e,...t);return M0(r),new Ae(n,null,new U(r))}{if(!(n instanceof Ae||n instanceof bn))throw new P(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return M0(r),new Ae(n.firestore,n instanceof bn?n.converter:null,new U(r))}}function Yv(n,e){return n=Ne(n),e=Ne(e),(n instanceof Ae||n instanceof bn)&&(e instanceof Ae||e instanceof bn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Zv(n,e){return n=Ne(n),e=Ne(e),n instanceof at&&e instanceof at&&n.firestore===e.firestore&&Su(n._query,e._query)&&n.converter===e.converter}var Wd=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new _u(this,"async_queue_retry"),this.Vu=()=>{let r=id();r&&k("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=id();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=id();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Xe;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return R(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!zr(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw Ue("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=Hy.createAndSchedule(this,e,t,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&q()}verifyOperationInProgress(){}wu(){return R(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function ov(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var sv=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Xe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var hS=-1,Oe=class extends Pi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Wd,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return R(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Wd(e),this._firestoreClient=void 0,yield e}})}};function ut(n){if(n._terminated)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||fS(n),n._firestoreClient}function fS(n){var e,t,r;let i=n._freezeSettings(),o=function(a,c,l,h){return new Nm(a,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,uS(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new iv(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}function pS(n,e){an("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return mS(n,Hv.provider,{build:r=>new zd(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function gS(n){return R(this,null,function*(){an("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();mS(n,Hv.provider,{build:t=>new ev(t,e.cacheSizeBytes)})})}function mS(n,e,t){if((n=ge(n,Oe))._firestoreClient||n._terminated)throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new P(x.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},fS(n)}function yS(n){if(n._initialized&&!n._terminated)throw new P(x.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Xe;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{yield function(r){return R(this,null,function*(){if(!Or.D())return Promise.resolve();let i=r+"main";yield Or.delete(i)})}(Mv(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function vS(n){return function(t){let r=new Xe;return t.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return jL(yield Gv(t),r)})),r.promise}(ut(n=ge(n,Oe)))}function wS(n){return JL(ut(n=ge(n,Oe)))}function _S(n){return XL(ut(n=ge(n,Oe)))}function IS(n,e){let t=ut(n=ge(n,Oe)),r=new sv;return rV(t,n._databaseId,e,r),r}function ES(n,e){return iV(ut(n=ge(n,Oe)),e).then(t=>t?new at(n,null,t.query):null)}var Rn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(qe.fromBase64String(e))}catch(t){throw new P(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(qe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var ln=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $e(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var er=class{constructor(e){this._methodName=e}};var ki=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return re(this._lat,e._lat)||re(this._long,e._long)}};var Eu=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var oV=/^__.*__$/,av=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new cn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ur(e,this.data,t,this.fieldTransforms)}},Kd=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new cn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function DS(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}var Qd=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Yd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(DS(this.Cu)&&oV.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},uv=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||xu(e)}Qu(e,t,r,i=!1){return new Qd({Cu:e,methodName:t,qu:r,path:$e.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Vi(n){let e=n._freezeSettings(),t=xu(n._databaseId);return new uv(n._databaseId,!!e.ignoreUndefinedProperties,t)}function uh(n,e,t,r,i,o={}){let s=n.Qu(o.merge||o.mergeFields?2:0,e,t,i);ew("Data must be an object, but it was:",s,r);let a=bS(r,s),c,l;if(o.merge)c=new jt(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let h=[];for(let p of o.mergeFields){let m=fv(e,p,t);if(!s.contains(m))throw new P(x.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);AS(h,m)||h.push(m)}c=new jt(h),l=s.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=s.fieldTransforms;return new av(new pt(a),c,l)}var Du=class n extends er{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function CS(n,e,t){return new Qd({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var cv=class n extends er{_toFieldTransform(e){return new Ri(e.path,new jr)}isEqual(e){return e instanceof n}},lv=class n extends er{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=CS(this,e,!0),r=this.Ku.map(o=>ji(o,t)),i=new Jn(r);return new Ri(e.path,i)}isEqual(e){return e instanceof n&&Kh(this.Ku,e.Ku)}},dv=class n extends er{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=CS(this,e,!0),r=this.Ku.map(o=>ji(o,t)),i=new Xn(r);return new Ri(e.path,i)}isEqual(e){return e instanceof n&&Kh(this.Ku,e.Ku)}},hv=class n extends er{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new Br(e.serializer,db(e.serializer,this.$u));return new Ri(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function Jv(n,e,t,r){let i=n.Qu(1,e,t);ew("Data must be an object, but it was:",i,r);let o=[],s=pt.empty();Li(r,(c,l)=>{let h=tw(e,c,t);l=Ne(l);let p=i.Nu(h);if(l instanceof Du)o.push(h);else{let m=ji(l,p);m!=null&&(o.push(h),s.set(h,m))}});let a=new jt(o);return new Kd(s,a,i.fieldTransforms)}function Xv(n,e,t,r,i,o){let s=n.Qu(1,e,t),a=[fv(e,r,t)],c=[i];if(o.length%2!=0)throw new P(x.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)a.push(fv(e,o[m])),c.push(o[m+1]);let l=[],h=pt.empty();for(let m=a.length-1;m>=0;--m)if(!AS(l,a[m])){let v=a[m],b=c[m];b=Ne(b);let M=s.Nu(v);if(b instanceof Du)l.push(v);else{let N=ji(b,M);N!=null&&(l.push(v),h.set(v,N))}}let p=new jt(l);return new Kd(h,p,s.fieldTransforms)}function TS(n,e,t,r=!1){return ji(t,n.Qu(r?4:3,e))}function ji(n,e){if(SS(n=Ne(n)))return ew("Unsupported field value:",e,n),bS(n,e);if(n instanceof er)return function(r,i){if(!DS(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let c=ji(a,i.Lu(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Ne(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return db(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ke.fromDate(r);return{timestampValue:os(i.serializer,o)}}if(r instanceof ke){let o=new ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:os(i.serializer,o)}}if(r instanceof ki)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Rn)return{bytesValue:Ib(i.serializer,r._byteString)};if(r instanceof Ae){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Bu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Av(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Eu)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw a.Bu("VectorValues must only contain numeric values.");return Sv(a.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${ah(r)}`)}(n,e)}function bS(n,e){let t={};return W0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Li(n,(r,i)=>{let o=ji(i,e.Mu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function SS(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ke||n instanceof ki||n instanceof Rn||n instanceof Ae||n instanceof er||n instanceof Eu)}function ew(n,e,t){if(!SS(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=ah(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function fv(n,e,t){if((e=Ne(e))instanceof ln)return e._internalPath;if(typeof e=="string")return tw(n,e);throw Yd("Field path arguments must be of type string or ",n,!1,void 0,t)}var sV=new RegExp("[~\\*/\\[\\]]");function tw(n,e,t){if(e.search(sV)>=0)throw Yd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ln(...e.split("."))._internalPath}catch{throw Yd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Yd(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new P(x.INVALID_ARGUMENT,a+n+c)}function AS(n,e){return n.some(t=>t.isEqual(e))}var Oi=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ae(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new pv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(ch("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},pv=class extends Oi{data(){return super.data()}};function ch(n,e){return typeof e=="string"?tw(n,e):e instanceof ln?e._internalPath:e._delegate._internalPath}function xS(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Cu=class{},Fi=class extends Cu{};function rr(n,e,...t){let r=[];e instanceof Cu&&r.push(e),r=r.concat(t),function(o){let s=o.filter(c=>c instanceof gv).length,a=o.filter(c=>c instanceof Zd).length;if(s>1||s>0&&a>0)throw new P(x.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Zd=class n extends Fi{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return jS(e._query,t),new at(e.firestore,e.converter,zm(e._query,t))}_parse(e){let t=Vi(e.firestore);return function(o,s,a,c,l,h,p){let m;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new P(x.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){k0(p,h);let v=[];for(let b of p)v.push(P0(c,o,b));m={arrayValue:{values:v}}}else m=P0(c,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||k0(p,h),m=TS(a,s,p,h==="in"||h==="not-in");return ce.create(l,h,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function RS(n,e,t){let r=e,i=ch("where",n);return Zd._create(i,r,t)}var gv=class n extends Cu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:_e.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)jS(s,c),s=zm(s,c)}(e._query,t),new at(e.firestore,e.converter,zm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var mv=class n extends Fi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ai(o,s)}(e._query,this._field,this._direction);return new at(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new un(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function MS(n,e="asc"){let t=e,r=ch("orderBy",n);return mv._create(r,t)}var Jd=class n extends Fi{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new at(e.firestore,e.converter,md(e._query,this._limit,this._limitType))}};function NS(n){return cS("limit",n),Jd._create("limit",n,"F")}function PS(n){return cS("limitToLast",n),Jd._create("limitToLast",n,"L")}var Xd=class n extends Fi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=VS(e,this.type,this._docOrFields,this._inclusive);return new at(e.firestore,e.converter,function(i,o){return new un(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function kS(...n){return Xd._create("startAt",n,!0)}function OS(...n){return Xd._create("startAfter",n,!1)}var eh=class n extends Fi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=VS(e,this.type,this._docOrFields,this._inclusive);return new at(e.firestore,e.converter,function(i,o){return new un(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function FS(...n){return eh._create("endBefore",n,!1)}function LS(...n){return eh._create("endAt",n,!0)}function VS(n,e,t,r){if(t[0]=Ne(t[0]),t[0]instanceof Oi)return function(o,s,a,c,l){if(!c)throw new P(x.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let p of Zo(o))if(p.field.isKeyField())h.push(Si(s,c.key));else{let m=c.data.field(p.field);if(nh(m))throw new P(x.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let v=p.field.canonicalString();throw new P(x.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(m)}return new An(h,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Vi(n.firestore);return function(s,a,c,l,h,p){let m=s.explicitOrderBy;if(h.length>m.length)throw new P(x.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let v=[];for(let b=0;b<h.length;b++){let M=h[b];if(m[b].field.isKeyField()){if(typeof M!="string")throw new P(x.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof M}`);if(!Tv(s)&&M.indexOf("/")!==-1)throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${M}' contains a slash.`);let N=s.path.child(pe.fromString(M));if(!U.isDocumentKey(N))throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);let j=new U(N);v.push(Si(a,j))}else{let N=TS(c,l,M);v.push(N)}}return new An(v,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function P0(n,e,t){if(typeof(t=Ne(t))=="string"){if(t==="")throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Tv(e)&&t.indexOf("/")!==-1)throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(pe.fromString(t));if(!U.isDocumentKey(r))throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Si(n,new U(r))}if(t instanceof Ae)return Si(n,t._key);throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ah(t)}.`)}function k0(n,e){if(!Array.isArray(n)||n.length===0)throw new P(x.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jS(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new P(x.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(x.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var gs=class{convertValue(e,t="none"){switch(bi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Li(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Me(s.doubleValue));return new Eu(o)}convertGeoPoint(e){return new ki(Me(e.latitude),Me(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Dv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(au(e));default:return null}}convertTimestamp(e){let t=Zn(e);return new ke(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=pe.fromString(e);G(Nb(r));let i=new Lr(r.get(1),r.get(3)),o=new U(r.popFirst(5));return i.isEqual(t)||Ue(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function lh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var yv=class extends gs{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ae(this.firestore,null,t)}};var Yn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Zt=class extends Oi{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Pr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(ch("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Pr=class extends Zt{data(e={}){return super.data(e)}},dn=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Yn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Pr(this._firestore,this._userDataWriter,r.key,r,new Yn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new Pr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Yn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new Pr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Yn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:aV(a.type),doc:c,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function aV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}function nw(n,e){return n instanceof Zt&&e instanceof Zt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof dn&&e instanceof dn&&n._firestore===e._firestore&&Zv(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function BS(n){n=ge(n,Ae);let e=ge(n.firestore,Oe);return sS(ut(e),n._key).then(t=>sw(e,n,t))}var tr=class extends gs{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ae(this.firestore,null,t)}};function US(n){n=ge(n,Ae);let e=ge(n.firestore,Oe),t=ut(e),r=new tr(e);return eV(t,n._key).then(i=>new Zt(e,r,n._key,i,new Yn(i!==null&&i.hasLocalMutations,!0),n.converter))}function $S(n){n=ge(n,Ae);let e=ge(n.firestore,Oe);return sS(ut(e),n._key,{source:"server"}).then(t=>sw(e,n,t))}function HS(n){n=ge(n,at);let e=ge(n.firestore,Oe),t=ut(e),r=new tr(e);return xS(n._query),aS(t,n._query).then(i=>new dn(e,r,n,i))}function qS(n){n=ge(n,at);let e=ge(n.firestore,Oe),t=ut(e),r=new tr(e);return tV(t,n._query).then(i=>new dn(e,r,n,i))}function zS(n){n=ge(n,at);let e=ge(n.firestore,Oe),t=ut(e),r=new tr(e);return aS(t,n._query,{source:"server"}).then(i=>new dn(e,r,n,i))}function rw(n,e,t){n=ge(n,Ae);let r=ge(n.firestore,Oe),i=lh(n.converter,e,t);return Es(r,[uh(Vi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,je.none())])}function iw(n,e,t,...r){n=ge(n,Ae);let i=ge(n.firestore,Oe),o=Vi(i),s;return s=typeof(e=Ne(e))=="string"||e instanceof ln?Xv(o,"updateDoc",n._key,e,t,r):Jv(o,"updateDoc",n._key,e),Es(i,[s.toMutation(n._key,je.exists(!0))])}function GS(n){return Es(ge(n.firestore,Oe),[new $r(n._key,je.none())])}function WS(n,e){let t=ge(n.firestore,Oe),r=Mu(n),i=lh(n.converter,e);return Es(t,[uh(Vi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,je.exists(!1))]).then(()=>r)}function ow(n,...e){var t,r,i;n=Ne(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||ov(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(ov(e[s])){let p=e[s];e[s]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[s+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[s+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,h;if(n instanceof Ae)l=ge(n.firestore,Oe),h=ys(n._key.path),c={next:p=>{e[s]&&e[s](sw(l,n,p))},error:e[s+1],complete:e[s+2]};else{let p=ge(n,at);l=ge(p.firestore,Oe),h=p._query;let m=new tr(l);c={next:v=>{e[s]&&e[s](new dn(l,m,p,v))},error:e[s+1],complete:e[s+2]},xS(n._query)}return function(m,v,b,M){let N=new fs(M),j=new Iu(v,N,b);return m.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return Ov(yield ps(m),j)})),()=>{N.Za(),m.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return Fv(yield ps(m),j)}))}}(ut(l),h,a,c)}function KS(n,e){return nV(ut(n=ge(n,Oe)),ov(e)?e:{next:e})}function Es(n,e){return function(r,i){let o=new Xe;return r.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return OL(yield Gv(r),i,o)})),o.promise}(ut(n),e)}function sw(n,e,t){let r=t.docs.get(e._key),i=new tr(n);return new Zt(n,i,e._key,r,new Yn(t.hasPendingWrites,t.fromCache),e.converter)}var uV={maxAttempts:5};var th=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Vi(e)}set(e,t,r){this._verifyNotCommitted();let i=Mr(e,this._firestore),o=lh(i.converter,t,r),s=uh(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,je.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=Mr(e,this._firestore),s;return s=typeof(t=Ne(t))=="string"||t instanceof ln?Xv(this._dataReader,"WriteBatch.update",o._key,t,r,i):Jv(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,je.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Mr(e,this._firestore);return this._mutations=this._mutations.concat(new $r(t._key,je.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(x.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Mr(n,e){if((n=Ne(n)).firestore!==e)throw new P(x.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var vv=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Vi(t)}get(t){let r=Mr(t,this._firestore),i=new yv(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return q();let s=o[0];if(s.isFoundDocument())return new Oi(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new Oi(this._firestore,i,r._key,null,r.converter);throw q()})}set(t,r,i){let o=Mr(t,this._firestore),s=lh(o.converter,r,i),a=uh(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){let s=Mr(t,this._firestore),a;return a=typeof(r=Ne(r))=="string"||r instanceof ln?Xv(this._dataReader,"Transaction.update",s._key,r,i,o):Jv(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){let r=Mr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Mr(e,this._firestore),r=new tr(this._firestore);return super.get(e).then(i=>new Zt(this._firestore,r,t._key,i._document,new Yn(!1,!1),t.converter))}};function QS(n,e,t){n=ge(n,Oe);let r=Object.assign(Object.assign({},uV),t);return function(o){if(o.maxAttempts<1)throw new P(x.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let c=new Xe;return o.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){let l=yield ZL(o);new rv(o.asyncQueue,l,a,s,c).au()})),c.promise}(ut(n),i=>e(new vv(n,i)),r)}function YS(){return new Du("deleteField")}function ZS(){return new cv("serverTimestamp")}function JS(...n){return new lv("arrayUnion",n)}function XS(...n){return new dv("arrayRemove",n)}function eA(n){return new hv("increment",n)}(function(e,t=!0){(function(i){ms=i})(C_),Gs(new Zr("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new Oe(new Em(r.getProvider("auth-internal")),new bm(r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new P(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lr(l.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),ur(NT,"4.7.3",e),ur(NT,"4.7.3","esm2017")})();var cV="@firebase/firestore-compat",lV="0.3.38";function hw(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function tA(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function nA(){if(!K0())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var dh=class n{constructor(e){this._delegate=e}static fromBase64String(e){return nA(),new n(Rn.fromBase64String(e))}static fromUint8Array(e){return tA(),new n(Rn.fromUint8Array(e))}toBase64(){return nA(),this._delegate.toBase64()}toUint8Array(){return tA(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function aw(n){return dV(n,["next","error","complete"])}function dV(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var uw=class{enableIndexedDbPersistence(e,t){return pS(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return gS(e._delegate)}clearIndexedDbPersistence(e){return yS(e._delegate)}},hh=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Lr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&an("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){lS(this._delegate,e,t,r)}enableNetwork(){return wS(this._delegate)}disableNetwork(){return _S(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Kv("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return vS(this._delegate)}onSnapshotsInSync(e){return KS(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ts(this,Qv(this._delegate,e))}catch(t){throw bt(t,"collection()","Firestore.collection()")}}doc(e){try{return new Mn(this,Mu(this._delegate,e))}catch(t){throw bt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Hi(this,dS(this._delegate,e))}catch(t){throw bt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return QS(this._delegate,t=>e(new fh(this,t)))}batch(){return ut(this._delegate),new ph(new th(this._delegate,e=>Es(this._delegate,e)))}loadBundle(e){return IS(this._delegate,e)}namedQuery(e){return ES(this._delegate,e).then(t=>t?new Hi(this,t):null)}},Ds=class extends gs{constructor(e){super(),this.firestore=e}convertBytes(e){return new dh(new Rn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Mn.forKey(t,this.firestore,null)}};function hV(n){O0(n)}var fh=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ds(e)}get(e){let t=Bi(e);return this._delegate.get(t).then(r=>new Ui(this._firestore,new Zt(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Bi(e);return r?(hw("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=Bi(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=Bi(e);return this._delegate.delete(t),this}},ph=class{constructor(e){this._delegate=e}set(e,t,r){let i=Bi(e);return r?(hw("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=Bi(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=Bi(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Cs=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Pr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new $i(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new n(e,new Ds(e),t),i.set(t,o)),o}};Cs.INSTANCES=new WeakMap;var Mn=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ds(e)}static forPath(e,t,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Ae(t._delegate,r,new U(e)))}static forKey(e,t,r){return new n(t,new Ae(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ts(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ts(this.firestore,Qv(this._delegate,e))}catch(t){throw bt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ne(e),e instanceof Ae?Yv(this._delegate,e):!1}set(e,t){t=hw("DocumentReference.set",t);try{return t?rw(this._delegate,e,t):rw(this._delegate,e)}catch(r){throw bt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?iw(this._delegate,e):iw(this._delegate,e,t,...r)}catch(i){throw bt(i,"updateDoc()","DocumentReference.update()")}}delete(){return GS(this._delegate)}onSnapshot(...e){let t=rA(e),r=iA(e,i=>new Ui(this.firestore,new Zt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return ow(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=US(this._delegate):e?.source==="server"?t=$S(this._delegate):t=BS(this._delegate),t.then(r=>new Ui(this.firestore,new Zt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Cs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function bt(n,e,t){return n.message=n.message.replace(e,t),n}function rA(n){for(let e of n)if(typeof e=="object"&&!aw(e))return e;return{}}function iA(n,e){var t,r;let i;return aw(n[0])?i=n[0]:aw(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Ui=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Mn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return nw(this._delegate,e._delegate)}},$i=class extends Ui{data(e){let t=this._delegate.data(e);return this._delegate._converter||F0(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Hi=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ds(e)}where(e,t,r){try{return new n(this.firestore,rr(this._delegate,RS(e,t,r)))}catch(i){throw bt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,rr(this._delegate,MS(e,t)))}catch(r){throw bt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,rr(this._delegate,NS(e)))}catch(t){throw bt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,rr(this._delegate,PS(e)))}catch(t){throw bt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,rr(this._delegate,kS(...e)))}catch(t){throw bt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,rr(this._delegate,OS(...e)))}catch(t){throw bt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,rr(this._delegate,FS(...e)))}catch(t){throw bt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,rr(this._delegate,LS(...e)))}catch(t){throw bt(t,"endAt()","Query.endAt()")}}isEqual(e){return Zv(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=qS(this._delegate):e?.source==="server"?t=zS(this._delegate):t=HS(this._delegate),t.then(r=>new Nu(this.firestore,new dn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=rA(e),r=iA(e,i=>new Nu(this.firestore,new dn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return ow(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Cs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},cw=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new $i(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Nu=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Hi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new $i(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new cw(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new $i(this._firestore,r))})}isEqual(e){return nw(this._delegate,e._delegate)}},Ts=class n extends Hi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Mn(this.firestore,e):null}doc(e){try{return e===void 0?new Mn(this.firestore,Mu(this._delegate)):new Mn(this.firestore,Mu(this._delegate,e))}catch(t){throw bt(t,"doc()","CollectionReference.doc()")}}add(e){return WS(this._delegate,e).then(t=>new Mn(this.firestore,t))}isEqual(e){return Yv(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Cs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Bi(n){return ge(n,Ae)}var lw=class n{constructor(...e){this._delegate=new ln(...e)}static documentId(){return new n($e.keyField().canonicalString())}isEqual(e){return e=Ne(e),e instanceof ln?this._delegate._internalPath.isEqual(e._internalPath):!1}};var dw=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=ZS();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=YS();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=JS(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=XS(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=eA(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var fV={Firestore:hh,GeoPoint:ki,Timestamp:ke,Blob:dh,Transaction:fh,WriteBatch:ph,DocumentReference:Mn,DocumentSnapshot:Ui,Query:Hi,QueryDocumentSnapshot:$i,QuerySnapshot:Nu,CollectionReference:Ts,FieldPath:lw,FieldValue:dw,setLogLevel:hV,CACHE_SIZE_UNLIMITED:hS};function pV(n,e){n.INTERNAL.registerComponent(new Zr("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},fV)))}function gV(n){pV(n,(e,t)=>new hh(e,t,new uw)),n.registerVersion(cV,lV)}gV(Pt);function mV(n,e=Ys){return new le(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function oA(n,e){return mV(n,e)}function yV(n,e){return oA(n,e).pipe(ri(void 0),Xs(),J(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function gw(n,e){return oA(n,e).pipe(J(t=>({payload:t,type:"query"})))}var gh=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:o}=uA(r,t);return new yh(i,o,this.afs)}snapshotChanges(){return yV(this.ref,this.afs.schedulers.outsideAngular).pipe(Rt)}valueChanges(e={}){return this.snapshotChanges().pipe(J(({payload:t})=>e.idField?Te($({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return ye(this.ref.get(e)).pipe(Rt)}};function mh(n,e){return gw(n,e).pipe(ri(void 0),Xs(),J(t=>{let[r,i]=t,o=i.payload.docChanges(),s=o.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let l=o.find(p=>p.doc.ref.isEqual(a.ref)),h=r?.payload.docs.find(p=>p.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),s}))}function sA(n,e,t){return mh(n,t).pipe(ni((r,i)=>vV(r,i.map(o=>o.payload),e),[]),wf(),J(r=>r.map(i=>({type:i.type,payload:i}))))}function vV(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=wV(n,r))}),n}function fw(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function wV(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return fw(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return fw(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return fw(n,e.oldIndex,1);break}return n}function aA(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var yh=class{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=mh(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(J(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(ri(void 0),Xs(),ot(([r,i])=>i.length>0||!r),J(([,r])=>r),Rt)}auditTrail(e){return this.stateChanges(e).pipe(ni((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=aA(e);return sA(this.query,t,this.afs.schedulers.outsideAngular).pipe(Rt)}valueChanges(e={}){return gw(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.payload.docs.map(r=>e.idField?Te($({},r.data()),{[e.idField]:r.id}):r.data())),Rt)}get(e){return ye(this.query.get(e)).pipe(Rt)}add(e){return this.ref.add(e)}doc(e){return new gh(this.ref.doc(e),this.afs)}},pw=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?mh(this.query,this.afs.schedulers.outsideAngular).pipe(Rt):mh(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.filter(r=>e.indexOf(r.type)>-1)),ot(t=>t.length>0),Rt)}auditTrail(e){return this.stateChanges(e).pipe(ni((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=aA(e);return sA(this.query,t,this.afs.schedulers.outsideAngular).pipe(Rt)}valueChanges(e={}){return gw(this.query,this.afs.schedulers.outsideAngular).pipe(J(r=>r.payload.docs.map(i=>e.idField?$({[e.idField]:i.id},i.data()):i.data())),Rt)}get(e){return ye(this.query.get(e)).pipe(Rt)}},_V=new z("angularfire2.enableFirestorePersistence"),IV=new z("angularfire2.firestore.persistenceSettings"),EV=new z("angularfire2.firestore.settings"),DV=new z("angularfire2.firestore.use-emulator");function uA(n,e=t=>t){return{query:e(n),ref:n}}var vh=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,o,s,a,c,l,h,p,m,v,b,M,N,j,H){this.schedulers=c;let F=za(t,a,r),Q=h;p&&um(F,a,m,b,M,N,v,j),[this.firestore,this.persistenceEnabled$]=Wl(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let ee=a.runOutsideAngular(()=>F.firestore());if(o&&ee.settings(o),Q&&ee.useEmulator(...Q),i&&!fi(s)){let Y=()=>{try{return ye(ee.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),Z(!1)}};return[ee,a.runOutsideAngular(Y)]}else return[ee,Z(!1)]},[o,Q,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=uA(i,r),a=this.schedulers.ngZone.run(()=>o);return new yh(a,s,this)}collectionGroup(t,r){let i=r||(s=>s),o=this.firestore.collectionGroup(t);return new pw(i(o),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.schedulers.ngZone.run(()=>r);return new gh(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(O(Lo),O(Vo,8),O(_V,8),O(EV,8),O(At),O(he),O(ql),O(IV,8),O(DV,8),O(xT,8),O(nm,8),O(rm,8),O(im,8),O(om,8),O(sm,8),O(am,8),O(yi,8))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var lA=(()=>{class n{constructor(t){this.db=t,this.dbPath="/header",this.headerRef=t.collection(this.dbPath)}getHeader(){return this.headerRef}static{this.\u0275fac=function(r){return new(r||n)(O(vh))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var wh=(()=>{class n{constructor(t){this.db=t,this.accesoWorkExperience="work experience running...",this.dbPath="/work-experience",this.workExperienceRef=t.collection(this.dbPath)}getWorkExperience(){return this.workExperienceRef}static{this.\u0275fac=function(r){return new(r||n)(O(vh))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var hA=(()=>{class n{constructor(t,r){this.headerService=t,this.workExperienceService=r,this.workExperience=[]}ngOnInit(){this.headerService.getHeader().snapshotChanges().subscribe(t=>{let r=t.map(i=>{let o=i.payload.doc.data(),s=i.payload.doc.id;return $({id:s},o)});r.length>0&&(this.header=r[0],console.log(this.header))}),this.workExperienceService.getWorkExperience().snapshotChanges().subscribe(t=>{let r=t.map(i=>{let o=i.payload.doc.data(),s=i.payload.doc.id;return $({id:s},o)});r.length>0&&(this.workExperience=r,console.log(this.workExperience))})}static{this.\u0275fac=function(r){return new(r||n)(Ir(lA),Ir(wh))}}static{this.\u0275cmp=tt({type:n,selectors:[["app-header"]],decls:15,vars:7,consts:[["width","200","height","200",3,"src"]],template:function(r,i){r&1&&(be(0,"tr")(1,"td"),Ze(2),st(3,"br"),Ze(4),Se(),be(5,"td"),st(6,"img",0),Se(),be(7,"td"),Ze(8),st(9,"br"),Ze(10),st(11,"br"),Ze(12),st(13,"br"),Ze(14),Se()()),r&2&&(_r(2),Er(" ",i.header.name," "),_r(2),Er(" ",i.header.goalLife," "),_r(2),qp("src",i.header.photoUrl,sD),_r(2),Er(" ",i.header.email,""),_r(2),Er(" ",i.header.phoneNumber,""),_r(2),Er(" ",i.header.location,""),_r(2),Er(" ",i.header.socialNetwork," "))}})}}return n})();var fA=(()=>{class n{constructor(t){this.workExperienceService=t,this.workExperience=[],console.log(this.workExperienceService),this.workExperienceService.getWorkExperience().snapshotChanges().pipe(J(r=>r.map(i=>$({id:i.payload.doc.id},i.payload.doc.data())))).subscribe(r=>{this.workExperience=r,console.log(this.workExperience)})}static{this.\u0275fac=function(r){return new(r||n)(Ir(wh))}}static{this.\u0275cmp=tt({type:n,selectors:[["app-work-experience"]],decls:2,vars:0,template:function(r,i){r&1&&(be(0,"p"),Ze(1,"work-experience works!"),Se())}})}}return n})();var pA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=tt({type:n,selectors:[["app-education"]],decls:2,vars:0,template:function(r,i){r&1&&(be(0,"p"),Ze(1,"education works!"),Se())}})}}return n})();var gA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=tt({type:n,selectors:[["app-skills"]],decls:2,vars:0,template:function(r,i){r&1&&(be(0,"p"),Ze(1,"skills works!"),Se())}})}}return n})();var mA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=tt({type:n,selectors:[["app-certificates"]],decls:2,vars:0,template:function(r,i){r&1&&(be(0,"p"),Ze(1,"certificates works!"),Se())}})}}return n})();var yA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=tt({type:n,selectors:[["app-interests"]],decls:2,vars:0,template:function(r,i){r&1&&(be(0,"p"),Ze(1,"interests works!"),Se())}})}}return n})();var vA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=tt({type:n,selectors:[["app-admin-languages"]],decls:2,vars:0,template:function(r,i){r&1&&(be(0,"p"),Ze(1,"admin-languages works!"),Se())}})}}return n})();var wA=(()=>{class n{constructor(){this.title="mycv"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=tt({type:n,selectors:[["app-root"]],decls:19,vars:0,consts:[["border","1"],["colspan","2"]],template:function(r,i){r&1&&(be(0,"table",0)(1,"tr")(2,"td",1),st(3,"app-header"),Se()(),be(4,"tr")(5,"td"),st(6,"app-work-experience"),Se(),be(7,"td"),st(8,"app-skills"),Se()(),be(9,"tr")(10,"td"),st(11,"app-education"),Se(),be(12,"td"),st(13,"app-certificates"),Se()(),be(14,"tr")(15,"td"),st(16,"app-admin-languages"),Se(),be(17,"td"),st(18,"app-interests"),Se()()())},dependencies:[hA,fA,pA,gA,mA,yA,vA]})}}return n})();var _A={production:!1,firebase:{apiKey:"AIzaSyA8Ucnuw0B20gAltFs--D-wkm6AlHol82A",authDomain:"my-cv-679f4.firebaseapp.com",projectId:"my-cv-679f4",storageBucket:"my-cv-679f4.firebasestorage.app",messagingSenderId:"360854088502",appId:"1:360854088502:web:018550eb19bb558922e197"}};var IA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Dt({type:n,bootstrap:[wA]})}static{this.\u0275inj=Et({imports:[wC,hT,AT.initializeApp(_A.firebase)]})}}return n})();vC().bootstrapModule(IA,{ngZoneEventCoalescing:!0}).catch(n=>console.error(n));
